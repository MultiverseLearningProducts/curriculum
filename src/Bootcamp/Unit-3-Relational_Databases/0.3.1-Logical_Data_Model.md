# Logical Data Model

## Pre-requisites
* Try out [https://planttext.com](https://planttext.com) for drawing UML diagrams
* Install the `PlantUML` plugin for VSCode

## Learning Objectives
* Create a logical data model using a UML class diagram
* Use 'has many' and 'belongs to' to correctly label relationship between classes

## Lesson
Imagine we are going to build a Restaurant application like Deliveroo or Uber Eats. We firstly start by designing our logical data model. An application logical data model is like the foundations of a building. Everything is build on top of this foundation.

In a Restaurant system what are some of the objects you would expect to find?

1. Restaurant
1. Menu
1. Item (a dish with a price)

What are the relationships between these? 

A Restaurant can have many Menus, for example:

* a drinks menu
* a mains menu
* a dessert menu

A Menu belongs to a Restaurant. A Menu has many Items. An Item belongs to a Menu. Can you figure out all of that? It gets confusing and quite complicated to imagine if someone is just verbally explaining it to us. We need a way to visually represent it so we can clearly communicate our design.

### UML
The Unified Modeling Language (UML) is a standardised way to represent abstract structures in programming.

A logical data model can be represented using an [Entity Relationship Diagram (ERD)](https://plantuml.com/ie-diagram) which is an extension to the UML Class notation. Associations and 'has many' relationships can be modelled using the appropriate syntax.

Example of Airports in UML

![UML class diagram representing relationship between classes in an airport domain](https://user-images.githubusercontent.com/4499581/93352652-fa52b900-f832-11ea-81a8-ebd2b8e43f97.png)

Programmers, like you, can use diagrams like this to design a data model. The benefit of this diagram is that other programmers can also read this diagram and understand your model, in fact they can take this diagram and code it up!

### UML relationships

You'll recall from the session on UML diagrams that relationships between entities are represented by connecting lines. The way the lines terminate at a class can also carry meaning and tell us something about the relationship between classes. For example in the diagram above the fat white arrow indicates that the class inherits from the one it is pointing at. The "has many" relationship is indicated with forking lines, you can just make them out in the diagram above.

|**Type**|**Representation**|**PlantUML**|**Meaning**|
|--------|------------------|------------|-----------|
|Association| <img width="33" alt="association" src="https://user-images.githubusercontent.com/1316724/119099955-5cda0580-ba0f-11eb-8d9d-354566a3e500.PNG"> |`---`|A general relationship between 2 entities|
|Inheritance| <img width="43" alt="inheritance" src="https://user-images.githubusercontent.com/1316724/119100038-71b69900-ba0f-11eb-848c-42a95c3de104.PNG">|`<--`|Used to indicate the base class from which an entity inherits properties and functions|
|Has Many|<img width="37" alt="has many" style="transform:rotate(180deg);" src="https://user-images.githubusercontent.com/4499581/119807266-e770a800-beda-11eb-8b3c-021caf86e241.png"/>|`}--`|This entity will have many other entities associated with it|

## Assignment

  1. Create a [new Node.js project](/curriculum#createNewProject) for this assignment.
  1. Design a logical data model for the following classes. Include the relationships between them.
        - Restaurant - has many menus
        - Menu - has many items & belongs to a restaurant
        - Item - belongs to a menu

Once you have a Logical Data Model you can implement it. Begin by writing a failing test. Then write the code to make the test pass. Eventually you'll end up with a set of tests that will prove your model is sound. Once your tests and logic are complete you should run a Jest coverage report to analyse how much of your code is executed during your tests. To do this, add the following line to your package.json file:

```json
{
  "scripts": {
    "test": "jest",
    "test:report": "jest --coverage=true"
  },
  "dependencies": {
    "jest": "^26.4.2"
  }
}
```
Then run `npm run test:report`. You are aiming for 100% test coverage. You should see that Jest generates a 'coverage' report in your project folder under `/coverage/Icov-report/index.html`. Open this in your browser to view coverage by line, branch, function and statement.

![test coverage report showing statements, branches, functions and line coverage](https://user-images.githubusercontent.com/4499581/93334401-cc627a00-f81c-11ea-9c98-4825235c06a4.png)

The report is interactive hence you can click and drill down into a specific class.
  
  3. Create tests and class definitions for each of the classes in the Restaurant Logical Data Model.
      * Create a Restaurant (with a name, image URL, and a city)
      * Create a Menu and associate it with a Restaurant (the Menu should have a 'title' property and an 'icon' - you can use emojis for icons)
      * Create a Menu Item and associate it with a Menu (Menu Item should have a name and price)

  1. Generate a [test coverage report](/curriculum#generateCoverage)
  1. Commit your code and a screenshot of your coverage report into Github and share the link with your coach for review.
