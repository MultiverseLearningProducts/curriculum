<!DOCTYPE html>
<html lang="en-GB">
    <head>
        <meta charset="utf-8">
        <title> Build your own openAPI RESTful service</title>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <link rel="shortcut icon" type="image/x-icon" href="/curriculum/favicon.ico"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/an-old-hope.min.css">
        <link rel="stylesheet" href="/curriculum/style.css"/>
        <script src="/curriculum/js/highlight.min.js"></script>
        <script src="/curriculum/js/bash.min.js"></script>
        <script src="/curriculum/js/java.min.js"></script>
        <script src="/curriculum/js/javascript.min.js"></script>
        <script src="/curriculum/js/sql.min.js"></script>
    </head>
    <body>
        <button 
            id="navigation-toggle"
            aria-expanded="false"
            aria-haspopup="true"
            onclick="toggleNav()"
            onkeydown="event => {event.keyCode === 13 ? toggleNav() : null}"
            tabindex="1">Table of contents</button>
        <nav id="navigation"><ul><li><a href="/curriculum/Bootcamp/index.html">Bootcamp</a><ul><li><a href="/curriculum/Bootcamp/FAQ.html">FAQ</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/index.html">Unit 1 Object Oriented Programming</a><ul><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.1-JavaScript_Objects_And_Functions.html">0.1.1 JavaScript Objects And Functions</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.2-Test_Driven_Development.html">0.1.2 Test Driven Development</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.3-Objects_in_an_Airport_Domain.html">0.1.3 Objects in an Airport Domain</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.4-Static_functions_and_properties.html">0.1.4 Static functions and properties</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.5-Inheritance.html">0.1.5 Inheritance</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.6-UML_Modelling.html">0.1.6 UML Modelling</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.7-OOP_Challenge.html">0.1.7 OOP Challenge</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.8-End_of_Unit_Quiz_OOP.html">0.1.8 End of Unit Quiz OOP</a></li></ul></li><li><a href="/curriculum/Bootcamp/Unit-2-Asynchronous_JavaScript/index.html">Unit 2 Asynchronous JavaScript</a><ul><li><a href="/curriculum/Bootcamp/Unit-2-Asynchronous_JavaScript/0.2.1-Asynchronous_JavaScript.html">0.2.1 Asynchronous JavaScript</a></li><li><a href="/curriculum/Bootcamp/Unit-2-Asynchronous_JavaScript/0.2.2-Promises.html">0.2.2 Promises</a></li><li><a href="/curriculum/Bootcamp/Unit-2-Asynchronous_JavaScript/0.2.3-Asynchronous_Airport_Data_Load.html">0.2.3 Asynchronous Airport Data Load</a></li><li><a href="/curriculum/Bootcamp/Unit-2-Asynchronous_JavaScript/0.2.4-End_of_Unit_Quiz_Async.html">0.2.4 End of Unit Quiz Async</a></li></ul></li><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/index.html">Unit 3 Relational Databases</a><ul><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.1-Logical_Data_Model.html">0.3.1 Logical Data Model</a></li><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.10-Sequelize_part_2.html">0.3.10 Sequelize part 2</a></li><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.11-End_of_Unit_Quiz_Databases.html">0.3.11 End of Unit Quiz Databases</a></li><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.2-Introduction_to_Databases.html">0.3.2 Introduction to Databases</a></li><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.3-Basic_SQL_Commands.html">0.3.3 Basic SQL Commands</a></li><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.4-SQL_Joins.html">0.3.4 SQL Joins</a></li><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.5-Database_access_using_Node.html">0.3.5 Database access using Node</a></li><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.6-Populating_databases_from_JSON.html">0.3.6 Populating databases from JSON</a></li><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.7-Object_Relational_Mapping_part_1.html">0.3.7 Object Relational Mapping part 1</a></li><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.8-Object_Relational_Mapping_part_2.html">0.3.8 Object Relational Mapping part 2</a></li><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.9-Sequelize_part_1.html">0.3.9 Sequelize part 1</a></li></ul></li><li><a href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/index.html">Unit 4 RESTful Servers</a><ul><li><a href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/0.4.1-Web_Servers.html">0.4.1 Web Servers</a></li><li><a href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/0.4.2-Application_Servers.html">0.4.2 Application Servers</a></li><li><a href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/0.4.3-Postman.html">0.4.3 Postman</a></li><li><a href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/0.4.4-Route_Parameters.html">0.4.4 Route Parameters</a></li><li><a href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/0.4.5-CRUD_operations.html">0.4.5 CRUD operations</a></li><li><a href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/0.4.6-Server_side_Validation.html">0.4.6 Server side Validation</a></li><li><a href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/0.4.7-End_of_Unit_Quiz_RESTful.html">0.4.7 End of Unit Quiz RESTful</a></li></ul></li><li><a href="/curriculum/Bootcamp/Unit-5-Human_Computer_Interaction/index.html">Unit 5 Human Computer Interaction</a><ul><li><a href="/curriculum/Bootcamp/Unit-5-Human_Computer_Interaction/0.5.1-Human_Computer_Interaction.html">0.5.1 Human Computer Interaction</a></li><li><a href="/curriculum/Bootcamp/Unit-5-Human_Computer_Interaction/0.5.2-Server_Side_Rendering.html">0.5.2 Server Side Rendering</a></li><li><a href="/curriculum/Bootcamp/Unit-5-Human_Computer_Interaction/0.5.3-The_Document_Object_Model.html">0.5.3 The Document Object Model</a></li><li><a href="/curriculum/Bootcamp/Unit-5-Human_Computer_Interaction/0.5.4-HTML_forms_and_lists.html">0.5.4 HTML forms and lists</a></li><li><a href="/curriculum/Bootcamp/Unit-5-Human_Computer_Interaction/0.5.5-End_of_Unit_Quiz_HCI.html">0.5.5 End of Unit Quiz HCI</a></li></ul></li><li><a href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/index.html">Unit 6 End Of Bootcamp Group Project</a><ul><li><a href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/0.6.1-Introduction.html">0.6.1 Introduction</a></li><li><a href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/0.6.2-Requirements.html">0.6.2 Requirements</a></li><li><a href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/0.6.3-Agile_Development.html">0.6.3 Agile Development</a></li><li><a href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/0.6.4-Design.html">0.6.4 Design</a></li><li><a href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/0.6.5-GitHub_Projects.html">0.6.5 GitHub Projects</a></li><li><a href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/0.6.6-Branching_and_Pull_Requests.html">0.6.6 Branching and Pull Requests</a></li><li><a href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/0.6.7-Deployment_with_Heroku.html">0.6.7 Deployment with Heroku</a></li></ul></li></ul></li><li><a href="/curriculum/Module-1/index.html">Module 1</a><ul><li><a href="/curriculum/Module-1/Unit-1-Agile_user_requirements/index.html">Unit 1 Agile user requirements</a><ul><li><a href="/curriculum/Module-1/Unit-1-Agile_user_requirements/1.1.1-Introduction_to_Agile.html">1.1.1 Introduction to Agile</a></li><li><a href="/curriculum/Module-1/Unit-1-Agile_user_requirements/1.1.2-Personas.html">1.1.2 Personas</a></li><li><a href="/curriculum/Module-1/Unit-1-Agile_user_requirements/1.1.3-User_Stories.html">1.1.3 User Stories</a></li><li><a href="/curriculum/Module-1/Unit-1-Agile_user_requirements/1.1.4-Requirements.html">1.1.4 Requirements</a></li><li><a href="/curriculum/Module-1/Unit-1-Agile_user_requirements/1.1.5-Next_Steps.html">1.1.5 Next Steps</a></li></ul></li><li><a href="/curriculum/Module-1/Unit-2-Designing_UI/index.html">Unit 2 Designing UI</a><ul><li><a href="/curriculum/Module-1/Unit-2-Designing_UI/1.2.1-Usability_heuristics.html">1.2.1 Usability heuristics</a></li><li><a href="/curriculum/Module-1/Unit-2-Designing_UI/1.2.2-Composition_and_components_in_design.html">1.2.2 Composition and components in design</a></li><li><a href="/curriculum/Module-1/Unit-2-Designing_UI/1.2.3-Prototyping_UI.html">1.2.3 Prototyping UI</a></li><li><a href="/curriculum/Module-1/Unit-2-Designing_UI/1.2.4-From_low_fi_to_hi_fi.html">1.2.4 From low fi to hi fi</a></li></ul></li><li><a href="/curriculum/Module-1/Unit-3-Building_UI_with_a_framework/index.html">Unit 3 Building UI with a framework</a><ul><li><a href="/curriculum/Module-1/Unit-3-Building_UI_with_a_framework/1.3.1-Implementing_a_frontend_design.html">1.3.1 Implementing a frontend design</a></li><li><a href="/curriculum/Module-1/Unit-3-Building_UI_with_a_framework/1.3.2-Working_with_dynamic_data.html">1.3.2 Working with dynamic data</a></li><li><a href="/curriculum/Module-1/Unit-3-Building_UI_with_a_framework/1.3.3-Execute_your_designs.html">1.3.3 Execute your designs</a></li></ul></li><li><a href="/curriculum/Module-1/Unit-4-Accessibility/index.html">Unit 4 Accessibility</a><ul><li><a href="/curriculum/Module-1/Unit-4-Accessibility/1.4.1-Inclusive_design.html">1.4.1 Inclusive design</a></li><li><a href="/curriculum/Module-1/Unit-4-Accessibility/1.4.2-Accessibility.html">1.4.2 Accessibility</a></li><li><a href="/curriculum/Module-1/Unit-4-Accessibility/1.4.3-Offline_assignment.html">1.4.3 Offline assignment</a></li></ul></li><li><a href="/curriculum/Module-1/Unit-5-End_to_end_testing/index.html">Unit 5 End to end testing</a><ul><li><a href="/curriculum/Module-1/Unit-5-End_to_end_testing/1.5.1-End_to_end_testing.html">1.5.1 End to end testing</a></li><li><a href="/curriculum/Module-1/Unit-5-End_to_end_testing/1.5.2-Test_cases_and_equivalence_testing.html">1.5.2 Test cases and equivalence testing</a></li></ul></li></ul></li><li><a href="/curriculum/Module-2/index.html">Module 2</a><ul><li><a href="/curriculum/Module-2/Unit-1-The_Anatomy_of_the_HTTP_request/index.html">Unit 1 The Anatomy of the HTTP request</a><ul><li><a href="/curriculum/Module-2/Unit-1-The_Anatomy_of_the_HTTP_request/2.1.1-Identifying_the_different_parts_of_HTTP.html">2.1.1 Identifying the different parts of HTTP</a></li><li><a href="/curriculum/Module-2/Unit-1-The_Anatomy_of_the_HTTP_request/2.1.2-Programmatic_HTTP_requests.html">2.1.2 Programmatic HTTP requests</a></li></ul></li><li><a href="/curriculum/Module-2/Unit-2-What_is_REST/index.html">Unit 2 What is REST</a><ul><li><a href="/curriculum/Module-2/Unit-2-What_is_REST/2.2.1-REST_and_the_openAPI_spec.html">2.2.1 REST and the openAPI spec</a></li><li><a href="/curriculum/Module-2/Unit-2-What_is_REST/2.2.2-The_OpenAPI_spec.html">2.2.2 The OpenAPI spec</a></li><li><a href="/curriculum/Module-2/Unit-2-What_is_REST/2.2.3-Build_an_OpenAPI_RESTful_service.html">2.2.3 Build an OpenAPI RESTful service</a></li><li><a href="/curriculum/Module-2/Unit-2-What_is_REST/2.2.4-Integration_tests.html">2.2.4 Integration tests</a></li><li><a href="/curriculum/Module-2/Unit-2-What_is_REST/2.2.5-Unit_2_Knowledge_quiz.html">2.2.5 Unit 2 Knowledge quiz</a></li></ul></li><li><a href="/curriculum/Module-2/Unit-3-Cryptography/index.html">Unit 3 Cryptography</a><ul><li><a href="/curriculum/Module-2/Unit-3-Cryptography/2.3.1-Hashing_Functions.html">2.3.1 Hashing Functions</a></li><li><a href="/curriculum/Module-2/Unit-3-Cryptography/2.3.2-Symmetric_Key_Encryption.html">2.3.2 Symmetric Key Encryption</a></li><li><a href="/curriculum/Module-2/Unit-3-Cryptography/2.3.3-Asymmetric_Key_Encryption.html">2.3.3 Asymmetric Key Encryption</a></li><li><a href="/curriculum/Module-2/Unit-3-Cryptography/2.3.4-Unit_3_Knowledge_Quiz.html">2.3.4 Unit 3 Knowledge Quiz</a></li></ul></li><li><a href="/curriculum/Module-2/Unit-4-Authentication/index.html">Unit 4 Authentication</a><ul><li><a href="/curriculum/Module-2/Unit-4-Authentication/2.4.1-Authentication_and_Authorisation.html">2.4.1 Authentication and Authorisation</a></li><li><a href="/curriculum/Module-2/Unit-4-Authentication/2.4.2-What_is_middleware.html">2.4.2 What is middleware</a></li><li><a href="/curriculum/Module-2/Unit-4-Authentication/2.4.3-Session_based_auth.html">2.4.3 Session based auth</a></li><li><a href="/curriculum/Module-2/Unit-4-Authentication/2.4.4-Introduction_to_OAuth.html">2.4.4 Introduction to OAuth</a></li><li><a href="/curriculum/Module-2/Unit-4-Authentication/2.4.5-Token_based_auth.html">2.4.5 Token based auth</a></li><li><a href="/curriculum/Module-2/Unit-4-Authentication/2.4.6-OpenID_Connect.html">2.4.6 OpenID Connect</a></li><li><a href="/curriculum/Module-2/Unit-4-Authentication/2.4.7-Banking_App.html">2.4.7 Banking App</a></li><li><a href="/curriculum/Module-2/Unit-4-Authentication/2.4.8-Unit_4_Knowledge_Quiz.html">2.4.8 Unit 4 Knowledge Quiz</a></li></ul></li></ul></li><li><a href="/curriculum/Module-3/index.html">Module 3</a><ul><li><a href="/curriculum/Module-3/Unit-1-The-SDLC/index.html">Unit 1 The SDLC</a><ul><li><a href="/curriculum/Module-3/Unit-1-The-SDLC/3.1.1-The_Software_Development_Life_Cycle.html">3.1.1 The Software Development Life Cycle</a></li><li><a href="/curriculum/Module-3/Unit-1-The-SDLC/3.1.2-The_roles_and_responsibilities_in_the_SDLC_with_communication.html">3.1.2 The roles and responsibilities in the SDLC with communication</a></li><li><a href="/curriculum/Module-3/Unit-1-The-SDLC/3.1.3-Communication_in_your_teams.html">3.1.3 Communication in your teams</a></li></ul></li><li><a href="/curriculum/Module-3/Unit-2-The-7-Princibles-of-Testing/index.html">Unit 2 The 7 Princibles of Testing</a><ul><li><a href="/curriculum/Module-3/Unit-2-The-7-Princibles-of-Testing/3.2.1-The_7_Princibles_of_Testing.html">3.2.1 The 7 Princibles of Testing</a></li><li><a href="/curriculum/Module-3/Unit-2-The-7-Princibles-of-Testing/3.2.2-Continuous_Deployment.html">3.2.2 Continuous Deployment</a></li></ul></li><li><a href="/curriculum/Module-3/Unit-3-Deployment-and-Maintenance/index.html">Unit 3 Deployment and Maintenance</a><ul><li><a href="/curriculum/Module-3/Unit-3-Deployment-and-Maintenance/3.3.1-Containerisation_with_docker.html">3.3.1 Containerisation with docker</a></li><li><a href="/curriculum/Module-3/Unit-3-Deployment-and-Maintenance/3.3.2-Introduction_to_Cloud_Computing.html">3.3.2 Introduction to Cloud Computing</a></li><li><a href="/curriculum/Module-3/Unit-3-Deployment-and-Maintenance/3.3.3-Monitoring_and_Maintenance.html">3.3.3 Monitoring and Maintenance</a></li></ul></li></ul></li></ul></nav>
        <h1>Build your own openAPI RESTful service</h1>
<h2>Learning Objectives</h2>
<ul>
<li>Produce an API server with integrated documentation</li>
<li>Implement CRUD operations on a single resource using RESTful endpoints</li>
</ul>
<h2>Pre-requisites</h2>
<ul>
<li>You will need a valid <code>airports-config.yaml</code> openAPI definition file see <a href="https://multiverselearningproducts.github.io/curriculum/Module-2/Unit-2-What_is_REST/2.2.2-The_OpenAPI_spec.html">2.2.2</a>.</li>
</ul>
<h2>Lesson</h2>
<p>Auto generated code is all very well, but you also need to know how to build your own RESTful service. In this session we are going to build our service from the ground up and practice defining RESTful routes for ourselves. You will be integrating OpenAPI documentation using swagger. There are a few steps below to get you started. If you would like to build your server in another language like PHP or C# you are very welcome to do so. You might need to look online for instructions to perform the following steps for the framework you are using. i.e. for PHP you can use <a href="https://symfony.com/">Symfony</a>.</p>
<h3>Dependencies</h3>
<p>First of all find and install the dependencies your server is going to need to create auto generated documentation.</p>
<p>|Javascript|Java|</p>
<pre><code class="language-javascript">{
  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;airports&quot;</span>,
  <span class="hljs-string">&quot;version&quot;</span>: <span class="hljs-string">&quot;1.0.0&quot;</span>,
  <span class="hljs-string">&quot;description&quot;</span>: <span class="hljs-string">&quot;Use this package.json to start your assignment&quot;</span>,
  <span class="hljs-string">&quot;main&quot;</span>: <span class="hljs-string">&quot;index.js&quot;</span>,
  <span class="hljs-string">&quot;scripts&quot;</span>: {
    <span class="hljs-string">&quot;start&quot;</span>: <span class="hljs-string">&quot;node server.js&quot;</span>
  },
  <span class="hljs-string">&quot;author&quot;</span>: <span class="hljs-string">&quot;your Github username can go here&quot;</span>,
  <span class="hljs-string">&quot;license&quot;</span>: <span class="hljs-string">&quot;ISC&quot;</span>,
  <span class="hljs-string">&quot;dependencies&quot;</span>: {
    <span class="hljs-string">&quot;express&quot;</span>: <span class="hljs-string">&quot;^4.17.1&quot;</span>,
    <span class="hljs-string">&quot;swagger-jsdoc&quot;</span>: <span class="hljs-string">&quot;^6.0.1&quot;</span>,
    <span class="hljs-string">&quot;swagger-ui-express&quot;</span>: <span class="hljs-string">&quot;^4.1.6&quot;</span>,
    <span class="hljs-string">&quot;js-yaml&quot;</span>: <span class="hljs-string">&quot;^4.0.0&quot;</span>
  }
}
</code></pre>
<pre><code class="language-java">/*
  Goto https://start.spring.io and generate a project with the group &#x27;org.whitehat&#x27; and package name &#x27;org.whitehat.airports&#x27; that includes &#x27;Spring Boot Web&#x27; as a dependency. Once you have downloaded and unzipped your project, add the following dependencies to your `pom.xml` file (in the `&lt;dependencies&gt;` list).  
*/
        &lt;dependency&gt;
            &lt;groupId&gt;org.springdoc&lt;/groupId&gt;
            &lt;artifactId&gt;springdoc-openapi-ui&lt;/artifactId&gt;
            &lt;version&gt;1.5.2&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;com.googlecode.json-simple&lt;/groupId&gt;
            &lt;artifactId&gt;json-simple&lt;/artifactId&gt;
            &lt;version&gt;1.1.1&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;
            &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;
            &lt;version&gt;2.11.1&lt;/version&gt;
        &lt;/dependency&gt;
</code></pre>
<h3>Configuration</h3>
<p>The next step is to configure your server to create API documentation from your code. Previously we used the OpenAPI yaml file to describe our routes, but that method means we would have to keep updating the config yaml file if we made changes to the endpoint. Instead now we are going to use swagger to generate docs NOT from a yaml file - but from the actual code itself. You can remove the <code>paths</code> property from your yaml file.</p>
<p>|Javascript|Java|</p>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)
<span class="hljs-keyword">const</span> app = express()
<span class="hljs-keyword">const</span> swaggerUi = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;swagger-ui-express&#x27;</span>)
<span class="hljs-keyword">const</span> airports = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./airports.json&#x27;</span>)
<span class="hljs-keyword">const</span> YAML = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;js-yaml&#x27;</span>)
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>)
<span class="hljs-keyword">const</span> docs = YAML.load(fs.readFileSync(<span class="hljs-string">&#x27;./airports-config.yaml&#x27;</span>).toString())
<span class="hljs-keyword">const</span> swaggerDocs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;swagger-jsdoc&#x27;</span>)({
    <span class="hljs-attr">swaggerDefinition</span>: docs,
    <span class="hljs-attr">apis</span>: [<span class="hljs-string">&#x27;./server.js&#x27;</span>]
})

app.use(<span class="hljs-string">&#x27;/api-docs&#x27;</span>, swaggerUi.serve, swaggerUi.setup(swaggerDocs, {<span class="hljs-attr">explorer</span>: <span class="hljs-literal">true</span>}))

app.listen(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;Airport API ready. Documents at http://localhost:3000/api-docs&quot;</span>))
</code></pre>
<pre><code class="language-java"><span class="hljs-comment">// in a file named AirportsApplication.java</span>
<span class="hljs-keyword">package</span> org.whitehat.airports;

<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Value;
<span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;
<span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;

<span class="hljs-keyword">import</span> io.swagger.v3.oas.models.OpenAPI;
<span class="hljs-keyword">import</span> io.swagger.v3.oas.models.info.Info;
<span class="hljs-keyword">import</span> io.swagger.v3.oas.models.servers.Server;

<span class="hljs-meta">@SpringBootApplication</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AirportsApplication</span> </span>{

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>{
        SpringApplication.run(AirportsApplication.class, args);
    }

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> OpenAPI <span class="hljs-title">customOpenAPI</span><span class="hljs-params">(<span class="hljs-meta">@Value(&quot;${springdoc.version}&quot;)</span> String appVersion)</span> </span>{

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> OpenAPI()
            .info(<span class="hljs-keyword">new</span> Info()
                .title(<span class="hljs-string">&quot;Airports&quot;</span>)
                .version(appVersion)
                .description(<span class="hljs-string">&quot;28,000 airports&quot;</span>)
            )
            .addServersItem(<span class="hljs-keyword">new</span> Server().url(<span class="hljs-string">&quot;http://localhost:8080/&quot;</span>))
            .addServersItem(<span class="hljs-keyword">new</span> Server().url(<span class="hljs-string">&quot;https://api.whitehatcoaches.org.uk/&quot;</span>));
    }
}


<span class="hljs-comment">/****** ADDITIONAL CONFIG ******
in /src/main/resources/application.properties
  springdoc.swagger-ui.path=/api-docs
  springdoc.version=1.0.0
*/</span>

<span class="hljs-comment">// Access the API at `http://localhost:8080/api-docs`</span>
</code></pre>
<h3>Auto Document Paths</h3>
<p>Now we can start to annotate our routes to support Swagger auto documenting our paths. Note that Swagger will read the Spring annotations to determine paths.</p>
<p>|Javascript|Java|</p>
<pre><code class="language-javascript"><span class="hljs-comment">// server.js</span>
<span class="hljs-comment">/**
 * <span class="hljs-doctag">@swagger</span>
 * /airports:
 *   get:
 *     summary: returns an array of airports
 *     responses:
 *       200:
 *         description: all the airports
 *         content:
 *           application/json:
 *             schema:
 *               type: array
 *               items:
 *                 properties:
 *                   icao:
 *                     type: string
 *                   iata:
 *                     type: string
 *                   name:
 *                     type: string
 *                   city:
 *                     type: string
 *                   state:
 *                     type: string
 *                   country:
 *                     type: string
 *                   elevation:
 *                     type: integer
 *                   lat:
 *                     type: float
 *                   lon:
 *                     type: float
 *                   tz:
 *                     type: string
 *                 example:
 *                   icao: &quot;00AK&quot;
 *                   iata: &quot;&quot;
 *                   name: &quot;Lowell Field&quot;
 *                   city: &quot;Anchor Point&quot;
 *                   state: &quot;Alaska&quot;
 *                   country: &quot;US&quot;
 *                   elevation: 450
 *                   lat: 59.94919968
 *                   lon: -151.695999146
 *                   tz: &quot;America/Anchorage&quot;                 
 */</span>
app.get(<span class="hljs-string">&#x27;/airports&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    res.send(airports)
})
</code></pre>
<pre><code class="language-java"><span class="hljs-keyword">package</span> org.whitehat.airports;

<span class="hljs-keyword">import</span> java.io.IOException;
<span class="hljs-keyword">import</span> java.io.InputStream;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">import</span> com.fasterxml.jackson.core.type.TypeReference;
<span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;

<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;

<span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping(&quot;/airports&quot;)</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AirportsController</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> List&lt;Airport&gt; airports;

    <span class="hljs-keyword">static</span> {
        <span class="hljs-comment">// next line is using the Try-With-Resource syntax to ensure that the</span>
        <span class="hljs-comment">// input stream gets closed (very important else get memory leaks!)</span>
        <span class="hljs-keyword">try</span> (InputStream is = AirportsController.class.getResourceAsStream(<span class="hljs-string">&quot;/static/airports.json&quot;</span>);){
            ObjectMapper mapper = <span class="hljs-keyword">new</span> ObjectMapper();

            airports = mapper.readValue(is, <span class="hljs-keyword">new</span> TypeReference&lt;List&lt;Airport&gt;&gt;() {
            });
        } <span class="hljs-keyword">catch</span>(IOException e) {
            e.printStackTrace();
        }

    }
    
    <span class="hljs-meta">@GetMapping(&quot;/&quot;)</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Airport&gt; <span class="hljs-title">getAirports</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> AirportsController.airports;
    }

    <span class="hljs-comment">// You can build out the rest of the endpoints</span>
    <span class="hljs-comment">// just a heads-up http://localhost:8080/airports/ remember the trailing slash.</span>
    <span class="hljs-comment">// Because Java is strongly typed swagger will to most of the work to document your endpoint - you can add extra information (go see the docs https://springdoc.org/)</span>
}
</code></pre>
<p>in <em>javascript</em> You can use schemas to save yourself repeating the definition of an <code>Airport</code>. If you create a class definition for an Airport you can annotate it then reference it in your route annotations. i.e. in an <code>Airport.js</code> file you can define your airport:</p>
<pre><code class="language-javascript"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@swagger</span>
 *   components:
 *     schemas:
 *       Airport:
 *         type: object
 *         properties:
 *           icao:
 *             type: string
 *           iata:
 *             type: string
 *           name:
 *             type: string
 *           city:
 *             type: string
 *           state:
 *             type: string
 *           country:
 *             type: string
 *           elevation:
 *             type: integer
 *           lat:
 *             type: float
 *           lon:
 *             type: float
 *           tz:
 *             type: string
 *         example:
 *           icao: &quot;00AK&quot;
 *           iata: &quot;&quot;
 *           name: &quot;Lowell Field&quot;
 *           city: &quot;Anchor Point&quot;
 *           state: &quot;Alaska&quot;
 *           country: &quot;US&quot;
 *           elevation: 450
 *           lat: 59.94919968
 *           lon: -151.695999146
 *           tz: &quot;America/Anchorage&quot;
 */</span>

<span class="hljs-built_in">module</span>.exports = <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Airport</span> </span>{
    icao = <span class="hljs-string">&quot;&quot;</span>
    iata = <span class="hljs-string">&quot;&quot;</span>
    name = <span class="hljs-string">&quot;&quot;</span>
    city = <span class="hljs-string">&quot;&quot;</span>
    state = <span class="hljs-string">&quot;&quot;</span>
    country = <span class="hljs-string">&quot;&quot;</span>
    elevation = <span class="hljs-number">0</span>
    lat = <span class="hljs-number">0.0</span>
    lon = -<span class="hljs-number">0.0</span>
    tz = <span class="hljs-string">&quot;&quot;</span>

    <span class="hljs-title">constructor</span> (<span class="hljs-params">data</span>) {
        <span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">this</span>, data)
    }
}
</code></pre>
<p>Then this can be referenced in your route definitions like this (you also have to reference the file in the <code>swagger-jsdoc</code> config):</p>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> swaggerDocs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;swagger-jsdoc&#x27;</span>)({
    <span class="hljs-attr">swaggerDefinition</span>: docs,
    <span class="hljs-attr">apis</span>: [<span class="hljs-string">&#x27;./server.js&#x27;</span>, <span class="hljs-string">&#x27;./Airport.js&#x27;</span>] <span class="hljs-comment">// &lt;- reference the file your schema is in here</span>
})
<span class="hljs-comment">/**
 * <span class="hljs-doctag">@swagger</span>
 * /airports:
 *   get:
 *     summary: returns an array of airports
 *     responses:
 *       200:
 *         description: all the airports
 *         content:
 *           application/json:
 *             schema:
 *               $ref: &#x27;#/components/schemas/Airport&#x27;                 
 */</span>
app.get(<span class="hljs-string">&#x27;/airports&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    res.send(airports)
})
</code></pre>
<h3>Pagination</h3>
<p>We have 28,000 airport records. Thats a lot. This would be much easier to consume in smaller chunks. Often large resources will be managed like this in &quot;pages&quot; of results. So lets say we have a page size of 25 that would mean we have to return only the first 25 airports (0 - 24 array indexes) that response would represent page 1. Page 2 would consist of the next 25 airports (25 - 49 array indexes). You will often see this handled as query parameters.</p>
<p><code>http://localhost:3000/airports?page=2&amp;pageSize=25</code></p>
<p>❓ What pagination errors might you now need to handle?</p>
<p>❓ What different HTTP codes might an endpoint like this return?</p>
<h2>Assignment</h2>
<p>Based on your <code>airports-config.yaml</code> OpenAPI definition file, can you build out a RESTful server with the same spec, only now the documented endpoints will be generated from the code itself. Implement pagination for the GET <code>/airports</code> route enabling users to define a page number (required) and an optional <code>pageSize</code> query parameter (this should default to 25).</p>

        <script src="/curriculum/js/tabbed-code-blocks.js"></script>
        <script>
            function toggleNav() {
                const button = document.getElementById('navigation-toggle')
                const isAriaExp = button.getAttribute('aria-expanded')
                const newAriaExp = (isAriaExp == "false") ? "true" : "false"
                button.setAttribute('aria-expanded', newAriaExp)
                const nav = document.getElementById('navigation')
                nav.style.display = nav.offsetParent ? 'none' : 'block'
            }
        </script>
    </body>
</html>