<!DOCTYPE html>
<html lang="en-GB">
    <head>
        <meta charset="utf-8">
        <title> Application Servers</title>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <link rel="shortcut icon" type="image/x-icon" href="/curriculum/favicon.ico"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/an-old-hope.min.css">
        <link rel="stylesheet" href="/curriculum/style.css"/>
        <script src="/curriculum/js/highlight.min.js"></script>
        <script src="/curriculum/js/bash.min.js"></script>
        <script src="/curriculum/js/java.min.js"></script>
        <script src="/curriculum/js/javascript.min.js"></script>
        <script src="/curriculum/js/sql.min.js"></script>
    </head>
    <body>
        <button 
            id="navigation-toggle"
            aria-expanded="false"
            aria-haspopup="true"
            onclick="toggleNav()"
            onkeydown="event => {event.keyCode === 13 ? toggleNav() : null}"
            tabindex="1">Table of contents</button>
        <nav id="navigation"><ul><li><a href="/curriculum/Bootcamp/index.html">Bootcamp</a><ul><li><a href="/curriculum/Bootcamp/FAQ.html">FAQ</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/index.html">Unit 1 Object Oriented Programming</a><ul><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.1-JavaScript_Objects_And_Functions.html">0.1.1 JavaScript Objects And Functions</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.2-Test_Driven_Development.html">0.1.2 Test Driven Development</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.3-Objects_in_an_Airport_Domain.html">0.1.3 Objects in an Airport Domain</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.4-Static_functions_and_properties.html">0.1.4 Static functions and properties</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.5-Inheritance.html">0.1.5 Inheritance</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.6-UML_Modelling.html">0.1.6 UML Modelling</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.7-Unit_1_Challenge.html">0.1.7 Unit 1 Challenge</a></li></ul></li><li><a href="/curriculum/Bootcamp/Unit-2-Asynchronous_JavaScript/index.html">Unit 2 Asynchronous JavaScript</a><ul><li><a href="/curriculum/Bootcamp/Unit-2-Asynchronous_JavaScript/0.2.1-Asynchronous_JavaScript.html">0.2.1 Asynchronous JavaScript</a></li><li><a href="/curriculum/Bootcamp/Unit-2-Asynchronous_JavaScript/0.2.2-Asynchronous_Airport_Data_Load.html">0.2.2 Asynchronous Airport Data Load</a></li></ul></li><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/index.html">Unit 3 Relational Databases</a><ul><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.1-Logical_Data_Model.html">0.3.1 Logical Data Model</a></li><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.10-Sequelize_part_2.html">0.3.10 Sequelize part 2</a></li><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.2-Implementing_the_Logical_Data_Model.html">0.3.2 Implementing the Logical Data Model</a></li><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.3-Basic_SQL_Commands.html">0.3.3 Basic SQL Commands</a></li><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.4-SQL_Joins.html">0.3.4 SQL Joins</a></li><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.5-Database_access_using_Node.html">0.3.5 Database access using Node</a></li><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.6-Populating_databases_from_JSON.html">0.3.6 Populating databases from JSON</a></li><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.7-Object_Relational_Mapping_part_1.html">0.3.7 Object Relational Mapping part 1</a></li><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.8-Object_Relational_Mapping_part_2.html">0.3.8 Object Relational Mapping part 2</a></li><li><a href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.9-Sequelize_part_1.html">0.3.9 Sequelize part 1</a></li></ul></li><li><a href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/index.html">Unit 4 RESTful Servers</a><ul><li><a href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/0.4.1-Web_Servers.html">0.4.1 Web Servers</a></li><li><a href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/0.4.2-Application_Servers.html">0.4.2 Application Servers</a></li><li><a href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/0.4.3-Rendering_Dynamic_Content.html">0.4.3 Rendering Dynamic Content</a></li><li><a href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/0.4.4-Route_Parameters.html">0.4.4 Route Parameters</a></li><li><a href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/0.4.5-Server_side_Validation.html">0.4.5 Server side Validation</a></li><li><a href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/0.4.6-CRUD_operations.html">0.4.6 CRUD operations</a></li><li><a href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/0.4.7-Unit_5_Challenge.html">0.4.7 Unit 5 Challenge</a></li><li><a href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/0.4.8-Unit_5_Knowledge_Quiz.html">0.4.8 Unit 5 Knowledge Quiz</a></li></ul></li><li><a href="/curriculum/Bootcamp/Unit-5-Human_Computer_Interaction/index.html">Unit 5 Human Computer Interaction</a><ul><li><a href="/curriculum/Bootcamp/Unit-5-Human_Computer_Interaction/0.5.1-Human_Computer_Interaction.html">0.5.1 Human Computer Interaction</a></li><li><a href="/curriculum/Bootcamp/Unit-5-Human_Computer_Interaction/0.5.2-The_Document_Object_Model.html">0.5.2 The Document Object Model</a></li><li><a href="/curriculum/Bootcamp/Unit-5-Human_Computer_Interaction/0.5.3-HTML_forms_and_lists.html">0.5.3 HTML forms and lists</a></li><li><a href="/curriculum/Bootcamp/Unit-5-Human_Computer_Interaction/0.5.4-User_input_in_HTML.html">0.5.4 User input in HTML</a></li></ul></li><li><a href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/index.html">Unit 6 End Of Bootcamp Group Project</a><ul><li><a href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/0.6.1-Introduction.html">0.6.1 Introduction</a></li><li><a href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/0.6.2-Requirements.html">0.6.2 Requirements</a></li><li><a href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/0.6.3-Agile_Development.html">0.6.3 Agile Development</a></li><li><a href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/0.6.4-Design.html">0.6.4 Design</a></li><li><a href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/0.6.5-GitHub_Projects.html">0.6.5 GitHub Projects</a></li><li><a href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/0.6.6-Branching_and_Pull_Requests.html">0.6.6 Branching and Pull Requests</a></li><li><a href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/0.6.7-Deployment_with_Heroku.html">0.6.7 Deployment with Heroku</a></li></ul></li></ul></li><li><a href="/curriculum/Module-1/index.html">Module 1</a><ul><li><a href="/curriculum/Module-1/Unit-#-Advanced_HTML_CSS/index.html">Unit # Advanced HTML CSS</a><ul><li><a href="/curriculum/Module-1/Unit-#-Advanced_HTML_CSS/0.4.1-CSS_Fonts_and_Typography.html">0.4.1 CSS Fonts and Typography</a></li><li><a href="/curriculum/Module-1/Unit-#-Advanced_HTML_CSS/0.4.1-CSS_Fundamentals.html">0.4.1 CSS Fundamentals</a></li><li><a href="/curriculum/Module-1/Unit-#-Advanced_HTML_CSS/0.4.1-CSS_Positioning.html">0.4.1 CSS Positioning</a></li><li><a href="/curriculum/Module-1/Unit-#-Advanced_HTML_CSS/0.4.2-CSS_Flexbox_Layout.html">0.4.2 CSS Flexbox Layout</a></li><li><a href="/curriculum/Module-1/Unit-#-Advanced_HTML_CSS/0.4.4-Responsive_CSS_Media_Queries.html">0.4.4 Responsive CSS Media Queries</a></li><li><a href="/curriculum/Module-1/Unit-#-Advanced_HTML_CSS/0.4.5-Responsive_CSS_Background_Images.html">0.4.5 Responsive CSS Background Images</a></li><li><a href="/curriculum/Module-1/Unit-#-Advanced_HTML_CSS/0.4.6-Client_side_JavaScript.html">0.4.6 Client side JavaScript</a></li><li><a href="/curriculum/Module-1/Unit-#-Advanced_HTML_CSS/0.4.6-HTML_Forms.html">0.4.6 HTML Forms</a></li><li><a href="/curriculum/Module-1/Unit-#-Advanced_HTML_CSS/0.4.8-HTML_DOM_Events.html">0.4.8 HTML DOM Events</a></li><li><a href="/curriculum/Module-1/Unit-#-Advanced_HTML_CSS/0.4.8-HTML_Web_Storage_API.html">0.4.8 HTML Web Storage API</a></li></ul></li></ul></li><li><a href="/curriculum/Module-2/index.html">Module 2</a><ul><li><a href="/curriculum/Module-2/Unit-1-The_Anatomy_of_the_HTTP_request/index.html">Unit 1 The Anatomy of the HTTP request</a><ul><li><a href="/curriculum/Module-2/Unit-1-The_Anatomy_of_the_HTTP_request/2.1.1-Identifying_the_different_parts_of_HTTP.html">2.1.1 Identifying the different parts of HTTP</a></li><li><a href="/curriculum/Module-2/Unit-1-The_Anatomy_of_the_HTTP_request/2.1.2-Programmatic_HTTP_requests.html">2.1.2 Programmatic HTTP requests</a></li></ul></li><li><a href="/curriculum/Module-2/Unit-2-What_is_REST/index.html">Unit 2 What is REST</a><ul><li><a href="/curriculum/Module-2/Unit-2-What_is_REST/2.2.1-REST_and_the_openAPI_spec.html">2.2.1 REST and the openAPI spec</a></li><li><a href="/curriculum/Module-2/Unit-2-What_is_REST/2.2.2-The_OpenAPI_spec.html">2.2.2 The OpenAPI spec</a></li><li><a href="/curriculum/Module-2/Unit-2-What_is_REST/2.2.3-Build_an_OpenAPI_RESTful_service.html">2.2.3 Build an OpenAPI RESTful service</a></li><li><a href="/curriculum/Module-2/Unit-2-What_is_REST/2.2.4-Integration_tests.html">2.2.4 Integration tests</a></li><li><a href="/curriculum/Module-2/Unit-2-What_is_REST/2.2.5-Unit_2_Knowledge_quiz.html">2.2.5 Unit 2 Knowledge quiz</a></li></ul></li><li><a href="/curriculum/Module-2/Unit-3-Cryptography/index.html">Unit 3 Cryptography</a><ul><li><a href="/curriculum/Module-2/Unit-3-Cryptography/2.3.1-Hashing_Functions.html">2.3.1 Hashing Functions</a></li><li><a href="/curriculum/Module-2/Unit-3-Cryptography/2.3.2-Symmetric_Key_Encryption.html">2.3.2 Symmetric Key Encryption</a></li><li><a href="/curriculum/Module-2/Unit-3-Cryptography/2.3.3-Asymmetric_Key_Encryption.html">2.3.3 Asymmetric Key Encryption</a></li><li><a href="/curriculum/Module-2/Unit-3-Cryptography/2.3.4-Unit_3_Knowledge_Quiz.html">2.3.4 Unit 3 Knowledge Quiz</a></li></ul></li><li><a href="/curriculum/Module-2/Unit-4-Authentication/index.html">Unit 4 Authentication</a><ul><li><a href="/curriculum/Module-2/Unit-4-Authentication/2.4.1-Authentication_and_Authorisation.html">2.4.1 Authentication and Authorisation</a></li><li><a href="/curriculum/Module-2/Unit-4-Authentication/2.4.2-What_is_middleware.html">2.4.2 What is middleware</a></li><li><a href="/curriculum/Module-2/Unit-4-Authentication/2.4.3-Session_based_auth.html">2.4.3 Session based auth</a></li><li><a href="/curriculum/Module-2/Unit-4-Authentication/2.4.4-Introduction_to_OAuth.html">2.4.4 Introduction to OAuth</a></li><li><a href="/curriculum/Module-2/Unit-4-Authentication/2.4.5-Token_based_auth.html">2.4.5 Token based auth</a></li><li><a href="/curriculum/Module-2/Unit-4-Authentication/2.4.6-OpenID_Connect.html">2.4.6 OpenID Connect</a></li><li><a href="/curriculum/Module-2/Unit-4-Authentication/2.4.7-Unit_4_Knowledge_Quiz.html">2.4.7 Unit 4 Knowledge Quiz</a></li></ul></li></ul></li><li><a href="/curriculum/Module-3/index.html">Module 3</a><ul><li><a href="/curriculum/Module-3/Unit-1-The-SDLC/index.html">Unit 1 The SDLC</a><ul><li><a href="/curriculum/Module-3/Unit-1-The-SDLC/3.1.1-Business_Impact.html">3.1.1 Business Impact</a></li></ul></li><li><a href="/curriculum/Module-3/Unit-2-Website_Testing/index.html">Unit 2 Website Testing</a><ul><li><a href="/curriculum/Module-3/Unit-2-Website_Testing/0.6.1-Cypress_Testing.html">0.6.1 Cypress Testing</a></li><li><a href="/curriculum/Module-3/Unit-2-Website_Testing/0.6.2-Accessibility_Testing.html">0.6.2 Accessibility Testing</a></li></ul></li></ul></li></ul></nav>
        <h1>Application Servers</h1>
<h2>Learning Objectives</h2>
<ul>
<li>Build an application server serving dynamic content using <a href="https://expressjs.com/">Node.js Express</a></li>
<li>Understand the difference between static and dynamic content</li>
<li>Create dynamic content using the Handlebars templating framework</li>
</ul>
<h2>Pre-requisites</h2>
<p>TODO</p>
<h2>Lesson</h2>
<p>Static content is usually read from disc, it is the <em>same</em> on every request and for every user e.g. HTML, CSS and image files.</p>
<p>Dynamic content is content that can <em>change</em> from request to request, and might be different for different people. For example, everyone has the same basic Twitter page, but each person's page is filled with content that is particular to them. What is shared between users is the page's template. The content is changeable or dynamic.</p>
<p><figure><img src="https://user-images.githubusercontent.com/1316724/113910233-7fea8600-97d0-11eb-96fb-226c84b4ceef.jpg" alt="dynamic content on twitter page"><figcaption></figcaption></figure></p>
<p>So where does the dynamic content come from? Dynamic content is usually stored in a database or comes from another service. The server responds to a request by fetching user specific content, applying business logic and returning a response as either HTML or in a data format such as JSON. The content for the resulting web page is built per request, 'on-the-fly'.</p>
<p>If we are serving dynamic content, our server is now called an 'application server'.</p>
<h3>Creating a Route</h3>
<p>The way we intercept or 'handle' HTTP requests is by declaring an Express 'route' in our <code>server.js</code> file. Routes determine how an application’s endpoints (URLs) respond to client requests.</p>
<p>Here is an example route which returns the current date when the user navigates to the root endpoint e.g. http://localhost:3000.</p>
<pre><code class="language-javascript">app.get(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">request, response</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> date = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()
    response.send(date)})
</code></pre>
<p><strong>Important</strong> - Make sure you remove the <code>public/index.html</code> file to avoid it interfering with your <code>/</code> route.</p>
<h3>Creating a Template</h3>
<p>Imagine we are going to build a Restaurant application like Deliveroo or Uber Eats. Our dynamic content is going to be driven by a restaurant data model. We want to display a list of restaurants within a web page. To do this, we are going to use a templating framework called <a href="https://handlebarsjs.com/">Handlebars</a>. This is a well supported template library in which you write HTML and use placeholders for dynamic content.</p>
<p>A Handlebars expression is content surrounded by <code>{{</code> <code>}}</code>. When the template is executed, the expression is replaced with values from an input object.</p>
<blockquote>
<p>Can you guess why the framework might be called Handlebars?!</p>
</blockquote>
<p>Handlebars expects a specific folder structure:</p>
<pre><code class="language-sh">
views
├── restaurants.handlebars
└── layouts
    └── main.handlebars

</code></pre>
<p>The <code>views</code> folder contains Handlebars templates which get rendered into <code>layouts</code>.</p>
<p>A <code>layout</code> is an HTML page with a <code>{{{body}}}</code> placeholder into which views are rendered. The <code>layouts</code> folder typically holds a default <code>main.handlebars</code> layout.</p>
<p>For our restaurant website we will set the <code>main.handlebars</code> layout as follows:</p>
<pre><code class="language-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">&quot;stylesheet&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;/style.css&quot;</span>/&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
        {{{body}}}
    <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<p>The <code>restaurants.handlebars</code> file will be rendered in the <code>main.handlebars</code> layout and, for now, will simply print out the date.</p>
<pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Restaurants<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">small</span>&gt;</span>{{date}}<span class="hljs-tag">&lt;/<span class="hljs-name">small</span>&gt;</span>
</code></pre>
<p>We install Handlebars by running</p>
<blockquote>
<p><code>npm install handlebars express-handlebars @handlebars/allow-prototype-access</code></p>
</blockquote>
<p>Once installed, we can <code>require</code> it and set it as the templating engine to use in our Express code.</p>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> Handlebars = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;handlebars&#x27;</span>)
<span class="hljs-keyword">const</span> expressHandlebars = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express-handlebars&#x27;</span>)
<span class="hljs-keyword">const</span> {allowInsecurePrototypeAccess} = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;@handlebars/allow-prototype-access&#x27;</span>)

<span class="hljs-comment">// setup our templating engine</span>
<span class="hljs-keyword">const</span> handlebars = expressHandlebars({
    <span class="hljs-attr">handlebars</span>: allowInsecurePrototypeAccess(Handlebars)
})
app.engine(<span class="hljs-string">&#x27;handlebars&#x27;</span>, handlebars)
app.set(<span class="hljs-string">&#x27;view engine&#x27;</span>, <span class="hljs-string">&#x27;handlebars&#x27;</span>)
</code></pre>
<p>We can then modify our route to pass the dynamic date object into our Handlebars template and return the resulting HTML.</p>
<pre><code class="language-js"><span class="hljs-comment">// this route matches any GET request to the root URL</span>
app.get(<span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">request, response</span>) =&gt;</span> {
    response.render(<span class="hljs-string">&#x27;restaurants&#x27;</span>, {<span class="hljs-attr">date</span>: <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>()})
})
</code></pre>
<p>The first argument to <code>response.render</code> is the name of the view template we want to render. In this example, this refers to a file named <code>restaurants.handlebars</code>.<br>
The second argument to <code>response.render</code> is the dynamic data which will be passed to the view template.</p>
<h2>Assignment</h2>
<ol>
<li><p>Install Handlebars as a Node dependency in your existing project</p></li>
<li><p>Modify your <code>server.js</code> file to serve both static and dynamic content as per the code above. Start your server by navigating to <code>http://localhost:3000</code>. You should see the date displayed. Use 'Chrome Developer Tools' to see the HTTP requests as you refresh the page.</p></li>
<li><p>Create another template in the <code>views</code> folder for an <code>about.handlebars</code> page. Add some static text for the page and a placeholder for a string holding the name of the website author.</p></li>
<li><p>Create another route handler on your server, <code>/about</code>. When the user navigates to this URL, the Express route should render the <code>about.handlebars</code> page and pass in your name as the website author.</p></li>
<li><p>Add a link from the <code>restaurants</code> page to the <code>about</code> page</p></li>
<li><p>Commit your code into Github and share the link with your coach for review</p></li>
</ol>
<h3>Assignment extension tasks</h3>
<p>Read the <a href="https://handlebarsjs.com/guide/#what-is-handlebars">Handlebars documentation</a> to learn more about Handlebars expressions.</p>
<h2>Additional resources</h2>
<ul>
<li><a href="https://www.youtube.com/watch?v=erfN7fH7A6s">Get started with Express Handlebars</a></li>
<li><a href="https://www.youtube.com/watch?v=Yh5qW_L5YNQ">Create default Layout - Express Handlebars</a></li>
</ul>

        <script src="/curriculum/js/tabbed-code-blocks.js"></script>
        <script>
            function toggleNav() {
                const button = document.getElementById('navigation-toggle')
                const isAriaExp = button.getAttribute('aria-expanded')
                const newAriaExp = (isAriaExp == "false") ? "true" : "false"
                button.setAttribute('aria-expanded', newAriaExp)
                const nav = document.getElementById('navigation')
                nav.style.display = nav.offsetParent ? 'none' : 'block'
            }
        </script>
    </body>
</html>