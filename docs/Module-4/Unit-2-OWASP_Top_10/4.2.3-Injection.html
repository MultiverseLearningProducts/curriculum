<!DOCTYPE html>
<html lang="en-GB">

<head>
    <meta charset="utf-8">
    <title>
         Injection
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="shortcut icon" type="image/x-icon" href="/curriculum/favicon.ico" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/an-old-hope.min.css">
    <link rel="stylesheet" href="/curriculum/style.css" />
    <script src="/curriculum/js/highlight.min.js"></script>
    <script src="/curriculum/js/bash.min.js"></script>
    <script src="/curriculum/js/java.min.js"></script>
    <script src="/curriculum/js/javascript.min.js"></script>
    <script src="/curriculum/js/sql.min.js"></script>
</head>

<body>
    <button id="navigation-toggle" aria-expanded="false" aria-haspopup="true" onclick="toggleNav()"
        onkeydown="event => {event.keyCode === 13 ? toggleNav() : null}" tabindex="1">Table of contents</button>
    <nav id="navigation"><ul><details><summary>Bootcamp</summary><ul><details><summary>Unit 1 Object Oriented Programming</summary><ul><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.0-UML_Modelling.html">0.1.0 UML Modelling</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.1-JavaScript_Objects_And_Functions.html">0.1.1 JavaScript Objects And Functions</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.2-Test_Driven_Development.html">0.1.2 Test Driven Development</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.3-Objects_in_an_Airport_Domain.html">0.1.3 Objects in an Airport Domain</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.4-Static_functions_and_properties.html">0.1.4 Static functions and properties</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.5-Inheritance.html">0.1.5 Inheritance</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.7-OOP_Challenge.html">0.1.7 OOP Challenge</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.8-End_of_Unit_Quiz_OOP.html">0.1.8 End of Unit Quiz OOP</a></li></ul></details><details><summary>Unit 2 Asynchronous JavaScript</summary><ul><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-2-Asynchronous_JavaScript\0.2.1-Asynchronous_JavaScript.html">0.2.1 Asynchronous JavaScript</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-2-Asynchronous_JavaScript\0.2.2-Promises.html">0.2.2 Promises</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-2-Asynchronous_JavaScript\0.2.3-Asynchronous_Airport_Data_Load.html">0.2.3 Asynchronous Airport Data Load</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-2-Asynchronous_JavaScript\0.2.4-End_of_Unit_Quiz_Async.html">0.2.4 End of Unit Quiz Async</a></li></ul></details><details><summary>Unit 3 Relational Databases</summary><ul><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.2-Introduction_to_Databases.html">0.3.2 Introduction to Databases</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.3-Basic_SQL_Commands.html">0.3.3 Basic SQL Commands</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.4-SQL_Joins.html">0.3.4 SQL Joins</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.5-Database_access_using_Node.html">0.3.5 Database access using Node</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.6-Populating_databases_from_JSON.html">0.3.6 Populating databases from JSON</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.7-Object_Relational_Mapping_part_1.html">0.3.7 Object Relational Mapping part 1</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.8-Object_Relational_Mapping_part_2.html">0.3.8 Object Relational Mapping part 2</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.9a-Sequelize_part_1.html">0.3.9a Sequelize part 1</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.9b-Sequelize_part_2.html">0.3.9b Sequelize part 2</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.9c-End_of_Unit_Quiz_Databases.html">0.3.9c End of Unit Quiz Databases</a></li></ul></details><details><summary>Unit 4 RESTful Servers</summary><ul><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-4-RESTful_Servers\0.4.1-Web_Servers.html">0.4.1 Web Servers</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-4-RESTful_Servers\0.4.2-Application_Servers.html">0.4.2 Application Servers</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-4-RESTful_Servers\0.4.3-Postman.html">0.4.3 Postman</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-4-RESTful_Servers\0.4.4-Route_Parameters.html">0.4.4 Route Parameters</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-4-RESTful_Servers\0.4.5-CRUD_operations.html">0.4.5 CRUD operations</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-4-RESTful_Servers\0.4.6-Server_side_Validation.html">0.4.6 Server side Validation</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-4-RESTful_Servers\0.4.7-End_of_Unit_Quiz_RESTful.html">0.4.7 End of Unit Quiz RESTful</a></li></ul></details><details><summary>Unit 5 Human Computer Interaction</summary><ul><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-5-Human_Computer_Interaction\0.5.1-Human_Computer_Interaction.html">0.5.1 Human Computer Interaction</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-5-Human_Computer_Interaction\0.5.2-Server_Side_Rendering.html">0.5.2 Server Side Rendering</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-5-Human_Computer_Interaction\0.5.3-The_Document_Object_Model.html">0.5.3 The Document Object Model</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-5-Human_Computer_Interaction\0.5.4-HTML_forms_and_lists.html">0.5.4 HTML forms and lists</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-5-Human_Computer_Interaction\0.5.5-End_of_Unit_Quiz_HCI.html">0.5.5 End of Unit Quiz HCI</a></li></ul></details><details><summary>Unit 6 End Of Bootcamp Group Project</summary><ul><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-6-End_Of_Bootcamp_Group_Project\0.6.1-Introduction.html">0.6.1 Introduction</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-6-End_Of_Bootcamp_Group_Project\0.6.2-Requirements.html">0.6.2 Requirements</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-6-End_Of_Bootcamp_Group_Project\0.6.3-Agile_Development.html">0.6.3 Agile Development</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-6-End_Of_Bootcamp_Group_Project\0.6.4-Design.html">0.6.4 Design</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-6-End_Of_Bootcamp_Group_Project\0.6.5-GitHub_Projects.html">0.6.5 GitHub Projects</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-6-End_Of_Bootcamp_Group_Project\0.6.6-Branching_and_Pull_Requests.html">0.6.6 Branching and Pull Requests</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-6-End_Of_Bootcamp_Group_Project\0.6.7-Deployment_with_Heroku.html">0.6.7 Deployment with Heroku</a></li></ul></details></ul></details><details><summary>Module 1</summary><ul><details><summary>Unit 1 Agile user requirements</summary><ul><li><a class="nav-link" href="/curriculum\Module-1\Unit-1-Agile_user_requirements\1.1.1-Introduction_to_Agile.html">1.1.1 Introduction to Agile</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-1-Agile_user_requirements\1.1.2-Personas.html">1.1.2 Personas</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-1-Agile_user_requirements\1.1.3-Requirements.html">1.1.3 Requirements</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-1-Agile_user_requirements\1.1.4-User_Stories.html">1.1.4 User Stories</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-1-Agile_user_requirements\1.1.5-Next_Steps.html">1.1.5 Next Steps</a></li></ul></details><details><summary>Unit 2 Designing UI</summary><ul><li><a class="nav-link" href="/curriculum\Module-1\Unit-2-Designing_UI\1.2.1-Usability_heuristics.html">1.2.1 Usability heuristics</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-2-Designing_UI\1.2.2-Composition_and_components_in_design.html">1.2.2 Composition and components in design</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-2-Designing_UI\1.2.3-Prototyping_UI.html">1.2.3 Prototyping UI</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-2-Designing_UI\1.2.4-Next_Steps.html">1.2.4 Next Steps</a></li></ul></details><details><summary>Unit 3 Building UI with React</summary><ul><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_React\1.3.0-Welcome_to_Unit_3.html">1.3.0 Welcome to Unit 3</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_React\1.3.1-Getting_started_with_React.html">1.3.1 Getting started with React</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_React\1.3.2-React_methods_and_computed_properties.html">1.3.2 React methods and computed properties</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_React\1.3.3-Events_and_adding_to_cart.html">1.3.3 Events and adding to cart</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_React\1.3.4-Introducing_routing_to_our_app.html">1.3.4 Introducing routing to our app</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_React\1.3.5-Fixing_the_add_to_cart_event.html">1.3.5 Fixing the add to cart event</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_React\1.3.6-Adding_the_product_details_page.html">1.3.6 Adding the product details page</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_React\1.3.7-Integrating_Redux_for_global_state_management.html">1.3.7 Integrating Redux for global state management</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_React\1.3.8-Consolidating_the_final_components.html">1.3.8 Consolidating the final components</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_React\1.3.9-Closing_thoughts_and_next_steps.html">1.3.9 Closing thoughts and next steps</a></li></ul></details><details><summary>Unit 3 Building UI with Vue.js</summary><ul><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_Vue.js\1.3.0-Welcome_to_Unit_3.html">1.3.0 Welcome to Unit 3</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_Vue.js\1.3.1-Getting_started_with_the_Vue_CDN.html">1.3.1 Getting started with the Vue CDN</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_Vue.js\1.3.2-Vue_methods_and_computed_properties.html">1.3.2 Vue methods and computed properties</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_Vue.js\1.3.3-Events_and_adding_to_cart.html">1.3.3 Events and adding to cart</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_Vue.js\1.3.4-Introducing_routing_to_our_app.html">1.3.4 Introducing routing to our app</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_Vue.js\1.3.5-Fixing_the_add_to_cart_event.html">1.3.5 Fixing the add to cart event</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_Vue.js\1.3.6-Adding_the_product_details_page.html">1.3.6 Adding the product details page</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_Vue.js\1.3.7-Integrating_Vuex_for_global_state_management.html">1.3.7 Integrating Vuex for global state management</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_Vue.js\1.3.8-Consolidating_the_final_components.html">1.3.8 Consolidating the final components</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_Vue.js\1.3.9-Closing_thoughts_and_next_steps.html">1.3.9 Closing thoughts and next steps</a></li></ul></details><details><summary>Unit 4 Accessibility</summary><ul><li><a class="nav-link" href="/curriculum\Module-1\Unit-4-Accessibility\1.4.1-Inclusive_design.html">1.4.1 Inclusive design</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-4-Accessibility\1.4.2-Accessibility.html">1.4.2 Accessibility</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-4-Accessibility\1.4.3-Next_Steps.html">1.4.3 Next Steps</a></li></ul></details><details><summary>Unit 5 End to end testing</summary><ul><li><a class="nav-link" href="/curriculum\Module-1\Unit-5-End_to_end_testing\1.5.1-End_to_end_testing.html">1.5.1 End to end testing</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-5-End_to_end_testing\1.5.2-End_to_end_testing_with_Cypress.html">1.5.2 End to end testing with Cypress</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-5-End_to_end_testing\1.5.3-Adding_more_test_coverage.html">1.5.3 Adding more test coverage</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-5-End_to_end_testing\1.5.4-Test_cases_and_equivalence_testing.html">1.5.4 Test cases and equivalence testing</a></li></ul></details></ul></details><details><summary>Module 2</summary><ul><details><summary>Unit 1 Securing APIs with Basic Auth</summary><ul><li><a class="nav-link" href="/curriculum\Module-2\Unit-1-Securing_APIs_with_Basic_Auth\2.1.1-RESTful_APIs_and_Frameworks.html">2.1.1 RESTful APIs and Frameworks</a></li><li><a class="nav-link" href="/curriculum\Module-2\Unit-1-Securing_APIs_with_Basic_Auth\2.1.2-Password_Hashing.html">2.1.2 Password Hashing</a></li><li><a class="nav-link" href="/curriculum\Module-2\Unit-1-Securing_APIs_with_Basic_Auth\2.1.3-Implementing_Basic_Auth.html">2.1.3 Implementing Basic Auth</a></li><li><a class="nav-link" href="/curriculum\Module-2\Unit-1-Securing_APIs_with_Basic_Auth\2.1.4-Limitations_of_Basic_Auth.html">2.1.4 Limitations of Basic Auth</a></li></ul></details><details><summary>Unit 2 Securing APIs with OAuth and OpenID Connect</summary><ul><li><a class="nav-link" href="/curriculum\Module-2\Unit-2-Securing_APIs_with_OAuth_and_OpenID_Connect\2.2.1-Introduction_to_OAuth.html">2.2.1 Introduction to OAuth</a></li><li><a class="nav-link" href="/curriculum\Module-2\Unit-2-Securing_APIs_with_OAuth_and_OpenID_Connect\2.2.2-Securing_APIs_with_OAuth.html">2.2.2 Securing APIs with OAuth</a></li><li><a class="nav-link" href="/curriculum\Module-2\Unit-2-Securing_APIs_with_OAuth_and_OpenID_Connect\2.2.3-OpenID_Connect.html">2.2.3 OpenID Connect</a></li><li><a class="nav-link" href="/curriculum\Module-2\Unit-2-Securing_APIs_with_OAuth_and_OpenID_Connect\2.2.4-Module_2_assessment.html">2.2.4 Module 2 assessment</a></li></ul></details></ul></details><details><summary>Module 3</summary><ul><details><summary>Unit 1 The SDLC</summary><ul><li><a class="nav-link" href="/curriculum\Module-3\Unit-1-The-SDLC\3.1.0-Introduction_to_module_3.html">3.1.0 Introduction to module 3</a></li><li><a class="nav-link" href="/curriculum\Module-3\Unit-1-The-SDLC\3.1.1-The_Software_Development_Life_Cycle.html">3.1.1 The Software Development Life Cycle</a></li><li><a class="nav-link" href="/curriculum\Module-3\Unit-1-The-SDLC\3.1.2-The_roles_and_responsibilities_in_the_SDLC.html">3.1.2 The roles and responsibilities in the SDLC</a></li><li><a class="nav-link" href="/curriculum\Module-3\Unit-1-The-SDLC\3.1.3-Communication_in_your_teams.html">3.1.3 Communication in your teams</a></li></ul></details><details><summary>Unit 2 The 7 Princibles of Testing</summary><ul><li><a class="nav-link" href="/curriculum\Module-3\Unit-2-The-7-Princibles-of-Testing\3.2.1-The_7_Princibles_of_Testing.html">3.2.1 The 7 Princibles of Testing</a></li><li><a class="nav-link" href="/curriculum\Module-3\Unit-2-The-7-Princibles-of-Testing\3.2.2-Continuous_Deployment.html">3.2.2 Continuous Deployment</a></li></ul></details><details><summary>Unit 3 Deployment and Maintenance</summary><ul><li><a class="nav-link" href="/curriculum\Module-3\Unit-3-Deployment-and-Maintenance\3.3.1-Introduction_to_Unix.html">3.3.1 Introduction to Unix</a></li><li><a class="nav-link" href="/curriculum\Module-3\Unit-3-Deployment-and-Maintenance\3.3.2-Introduction_to_containerisation.html">3.3.2 Introduction to containerisation</a></li><li><a class="nav-link" href="/curriculum\Module-3\Unit-3-Deployment-and-Maintenance\3.3.3-Introduction_to_Cloud_Computing.html">3.3.3 Introduction to Cloud Computing</a></li><li><a class="nav-link" href="/curriculum\Module-3\Unit-3-Deployment-and-Maintenance\3.3.4-Monitoring_and_Maintenance.html">3.3.4 Monitoring and Maintenance</a></li></ul></details></ul></details><details><summary>Module 4</summary><ul><details><summary>Unit 1 Open Web Application Security Project</summary><ul><li><a class="nav-link" href="/curriculum\Module-4\Unit-1-Open_Web_Application_Security_Project\4.1.1-OWASP.html">4.1.1 OWASP</a></li><li><a class="nav-link" href="/curriculum\Module-4\Unit-1-Open_Web_Application_Security_Project\4.1.2-Juice_Shop.html">4.1.2 Juice Shop</a></li></ul></details><details><summary>Unit 2 OWASP Top 10</summary><ul><li><a class="nav-link" href="/curriculum\Module-4\Unit-2-OWASP_Top_10\4.2.1-Broken_Access_Control.html">4.2.1 Broken Access Control</a></li><li><a class="nav-link" href="/curriculum\Module-4\Unit-2-OWASP_Top_10\4.2.2-Cryptographic_Failure.html">4.2.2 Cryptographic Failure</a></li><li><a class="nav-link" href="/curriculum\Module-4\Unit-2-OWASP_Top_10\4.2.3-Injection.html">4.2.3 Injection</a></li><li><a class="nav-link" href="/curriculum\Module-4\Unit-2-OWASP_Top_10\4.2.4-Insecure_Design.html">4.2.4 Insecure Design</a></li><li><a class="nav-link" href="/curriculum\Module-4\Unit-2-OWASP_Top_10\4.2.5-Security_Misconfiguration.html">4.2.5 Security Misconfiguration</a></li><li><a class="nav-link" href="/curriculum\Module-4\Unit-2-OWASP_Top_10\4.2.6-Vulnerable_Components.html">4.2.6 Vulnerable Components</a></li><li><a class="nav-link" href="/curriculum\Module-4\Unit-2-OWASP_Top_10\4.2.7-Identification_and_Authentication_Failures.html">4.2.7 Identification and Authentication Failures</a></li><li><a class="nav-link" href="/curriculum\Module-4\Unit-2-OWASP_Top_10\4.2.8-Software_and_Data_Integrity_Failures.html">4.2.8 Software and Data Integrity Failures</a></li><li><a class="nav-link" href="/curriculum\Module-4\Unit-2-OWASP_Top_10\4.2.9-Security_Logging_and_Monitoring_Failures.html">4.2.9 Security Logging and Monitoring Failures</a></li><li><a class="nav-link" href="/curriculum\Module-4\Unit-2-OWASP_Top_10\4.2.I0-Server_Side_Request_Forgery.html">4.2.I0 Server Side Request Forgery</a></li></ul></details></ul></details></ul></nav>
    <h1>Injection</h1>
<h2>Learning Objectives</h2>
<ul>
<li>Understand what injection is</li>
<li>Understand how to prevent injection</li>
</ul>
<h2>Injection Attacks</h2>
<p>Injection vulnerabilities are present when user input can be interpreted as code without sanitization.</p>
<h3>SQL Injection</h3>
<p>A common case is SQL injection. Take the following (poorly-written) endpoint for an example:</p>
<pre><code class="language-javascript">app.post(<span class="hljs-string">&quot;/users&quot;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(req.body.username);
    db.exec(
        <span class="hljs-string">`INSERT INTO users(username) values(&quot;<span class="hljs-subst">${req.body.username}</span>&quot;);`</span>,
        <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
            <span class="hljs-built_in">console</span>.log(err);
            res.sendStatus(<span class="hljs-number">201</span>);
        }
    );
});
</code></pre>
<p>The code takes the user input from the request’s body and plugs it directly into the SQL statement that gets executed. However, a malicious user could exploit this by carefully constructing a string to enter into the username text input:</p>
<p><figure><img src="https://user-images.githubusercontent.com/44523714/148061755-513a4d0a-0d37-4056-ad3d-d3c66b2c1daa.png" alt="Input box with 'charlie&quot;); DROP TABLE users;' as input"><figcaption></figcaption></figure></p>
<pre><code class="language-javascript">app.post(<span class="hljs-string">&quot;/users&quot;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    <span class="hljs-built_in">console</span>.log(req.body.username); <span class="hljs-comment">// charlie&quot;); DROP TABLE users;</span>
    db.exec(
        <span class="hljs-string">`INSERT INTO users(username) values(&quot;<span class="hljs-subst">${req.body.username}</span>&quot;);`</span>,
        <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
            <span class="hljs-built_in">console</span>.log(err);
            res.sendStatus(<span class="hljs-number">201</span>);
        }
    );
});
</code></pre>
<p>The resultant SQL that gets executed would therefore be:</p>
<pre><code class="language-SQL"><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> users(username) <span class="hljs-keyword">values</span>(&quot;charlie&quot;); <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> users;&quot;);
</code></pre>
<p>This would insert the username but then drop the entire table!</p>
<h3>Cross-Site Scripting (XSS)</h3>
<p>Another common form of injection is Cross-Site Scripting (XSS). When a browser encounters a <code>&lt;script&gt;</code> tag, it executes the code inside automatically. Cross-site scripting relies on this behaviour. We’ll illustrate this with an example.</p>
<p>Let’s imagine we’re creating an app that allows users to enter their name to sign-up for an event. When they enter their name, it is sent to a server and stored in a database. When the admin visits the site, the following code is run to fetch the users from the database and render them to her browser.</p>
<pre><code class="language-javascript"><span class="hljs-comment">// app.js</span>
app.get(<span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-keyword">async</span> (req, res) =&gt; {
    <span class="hljs-keyword">let</span> guests = <span class="hljs-keyword">await</span> getGuests(); <span class="hljs-comment">// fetches guest names from database</span>
    res.render(<span class="hljs-string">&quot;guests&quot;</span>, { guests });
});
</code></pre>
<pre><code><span class="hljs-comment">{{!-- guests.handlebars --}}</span><span class="xml">
<span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Guest List<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
</span><span class="hljs-template-tag">{{#<span class="hljs-name"><span class="hljs-builtin-name">each</span></span> guests}}</span><span class="xml">
    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span></span><span class="hljs-template-variable">{{{<span class="hljs-name">this</span>}}}</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
</span><span class="hljs-template-tag">{{/<span class="hljs-name"><span class="hljs-builtin-name">each</span></span>}}</span><span class="xml">
</span></code></pre>
<p>This handlebars code simply loops through each string in the guests array and sets it as the inner-html of an <code>&lt;li&gt;</code> tag.</p>
<p>Given normal user input, this app works fine:</p>
<p><figure><img src="https://user-images.githubusercontent.com/44523714/148062257-7876d895-24f3-4be0-8f61-2c429692b137.png" alt="normal HTML displayed"><figcaption></figcaption></figure></p>
<p>However, if a user was to enter their name as <code>“&lt;mark&gt;Gav&lt;/mark&gt;”</code>, the following would be rendered:</p>
<p><figure><img src="https://user-images.githubusercontent.com/44523714/148062419-41e6712f-476a-4b25-bb21-b97f3b6fda89.png" alt="Gav list item displayed with yellow highlighting"><figcaption></figcaption></figure></p>
<p>A user could also input their name as: <code>&quot;&lt;script&gt;alert('You have an XSS vulnerability')&lt;/script&gt;&quot;</code> which would create a popup alert when the admin opened the page. However, much more sinister actions can be performed once the hacker can inject scripts into another user’s browser. For example, the script could redirect the user to a malicious website; manipulate information shown on the screen; or make requests on the user’s behalf (exploiting any session tokens stored in the user’s browser).</p>
<h2>Preventing Injection</h2>
<p>Modern libraries - like sqlite3 and handlebars - are designed to protect against injection. They do this by providing a parameterized interface.</p>
<p>A parameterized interface means that, when constructing some code like an SQL query or an HTML page, user input is explicitly marked out in little slots. The text in these slots is then escaped such that the interpreter knows to treat it simply as text rather than code.</p>
<p>To fix the above handlebars example, we need to use the double curly-bracket syntax <code>{{ }}</code>, rather than the triple <code>{{{ }}}</code>. The double-bracket version is safer to use with user input because it escapes any special characters.</p>
<p>If we change our template to:</p>
<pre><code><span class="hljs-comment">{{!-- guests.handlebars --}}</span><span class="xml">
<span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Guest List<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
</span><span class="hljs-template-tag">{{#<span class="hljs-name"><span class="hljs-builtin-name">each</span></span> guests}}</span><span class="xml">
    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span></span><span class="hljs-template-variable">{{<span class="hljs-name">this</span>}}</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
</span><span class="hljs-template-tag">{{/<span class="hljs-name"><span class="hljs-builtin-name">each</span></span>}}</span><span class="xml">
</span></code></pre>
<p>It will now output the following</p>
<pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>Guest List<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Charlie<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Bernard<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Mandy<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Dan<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-symbol">&amp;lt;</span>mark<span class="hljs-symbol">&amp;gt;</span>Gav<span class="hljs-symbol">&amp;lt;</span>/mark<span class="hljs-symbol">&amp;gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span><span class="hljs-symbol">&amp;lt;</span>script<span class="hljs-symbol">&amp;gt;</span>alert(<span class="hljs-symbol">&amp;#x27;</span>You have an XSS vulnerability<span class="hljs-symbol">&amp;#x27;</span>)<span class="hljs-symbol">&amp;lt;</span>/script<span class="hljs-symbol">&amp;gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
</code></pre>
<p>Notice how the characters which have special meaning in HTML have been replaced. For example, the &lt; symbol has been replaced with &amp;lt;.</p>
<p>When the browser renders this HTML, it converts the escaped characters back to their normal form:</p>
<p><figure><img src="https://user-images.githubusercontent.com/44523714/148062525-894273dd-cc4e-47db-8aab-317def41f0ca.png" alt="html tags appear in the rendered text"><figcaption></figcaption></figure></p>
<p>So the name appears exactly as the user typed and is treated as text rather than code.</p>
<p>When writing SQL queries, we mark the slots where our data goes in our query and pass our parameters in separately:</p>
<pre><code class="language-javascript">db.run(
    <span class="hljs-string">`INSERT INTO users(username) values(?);`</span>,
    [req.body.username],
    <span class="hljs-function">(<span class="hljs-params">err</span>) =&gt;</span> {
        <span class="hljs-built_in">console</span>.log(err);
        res.sendStatus(<span class="hljs-number">201</span>);
    }
);
</code></pre>
<p>The library will escape the parameters (<code>req.body.username</code> in this case) so that it is treated as data rather than code.</p>
<p>It’s always a good idea to use a library's parameterized interface rather than try and do the escaping yourself. The library will be aware of the context in which the user input is being used, and so the escaping will be bespoke to the particular code being executed.</p>
<h2>Assignment</h2>
<p>Solve the &quot;DOM XSS&quot; challenge on Juice Shop</p>
<h2>Additional Resources</h2>
<p><a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Injection</a></p>
<p><iframe src="https://www.youtube.com/embed/zv0kZKC6GAM" width="100%" height="444px" allowfullscreen frameborder=0></iframe></p>
<p><iframe src="https://www.youtube.com/embed/aKShnpOXqn0" width="100%" height="444px" allowfullscreen frameborder=0></iframe></p>
<p><iframe src="https://www.youtube.com/embed/_jKylhJtPmI" width="100%" height="444px" allowfullscreen frameborder=0></iframe></p>

    <nav id="footer-nav"></nav>
    <script src="/curriculum/js/tabbed-code-blocks.js"></script>
    <script>
        function toggleNav() {
            const button = document.getElementById('navigation-toggle')
            const isAriaExp = button.getAttribute('aria-expanded')
            const newAriaExp = (isAriaExp == "false") ? "true" : "false"
            button.setAttribute('aria-expanded', newAriaExp)
            const nav = document.getElementById('navigation')
            nav.style.display = nav.offsetParent ? 'none' : 'block'
        }
        function footerNav() {
            const links = document.getElementsByClassName('nav-link')
            const hrefs = Array.from(links).map(a => a.getAttribute('href'))
            const [current] = window.location.href.match(/[0-9\.]+[a-zA-Z0-9_\\-]+\.html/) || [0]
            const index = hrefs.findIndex(href => {
                const page = href.split(/\\|\//).pop()
                return page === current
            })
            const prevIndex = index - 1
            const nextIndex = index + 1
            if (prevIndex > -1) {
                const prev = document.createElement('a') 
                prev.appendChild(document.createTextNode("◀︎ Prev"))
                prev.title = "Previous session notes"
                prev.href = hrefs[prevIndex]
                document.getElementById('footer-nav').prepend(prev)
            }
            if (nextIndex < hrefs.length) {
                const next = document.createElement('a') 
                next.appendChild(document.createTextNode("Next ►"))
                next.title = "Next session notes"
                next.href = hrefs[nextIndex]
                document.getElementById('footer-nav').append(next)
            }
            window.removeEventListener('DOMContentLoaded', footerNav)
        }
        window.addEventListener('DOMContentLoaded', footerNav)
    </script>
</body>

</html>