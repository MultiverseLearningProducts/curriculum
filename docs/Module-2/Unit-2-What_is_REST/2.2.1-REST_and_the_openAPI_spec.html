<!DOCTYPE html>
<html lang="en-GB">
    <head>
        <meta charset="utf-8">
        <title> REST and the openAPI spec</title>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <link rel="shortcut icon" type="image/x-icon" href="/curriculum/favicon.ico"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/an-old-hope.min.css">
        <link rel="stylesheet" href="/curriculum/style.css"/>
        <script src="/curriculum/js/highlight.min.js"></script>
        <script src="/curriculum/js/bash.min.js"></script>
        <script src="/curriculum/js/java.min.js"></script>
        <script src="/curriculum/js/javascript.min.js"></script>
        <script src="/curriculum/js/sql.min.js"></script>
    </head>
    <body>
        <button 
            id="navigation-toggle"
            aria-expanded="false"
            aria-haspopup="true"
            onclick="toggleNav()"
            onkeydown="event => {event.keyCode === 13 ? toggleNav() : null}"
            tabindex="1">Table of contents</button>
        <nav id="navigation"><ul><li><a href="/curriculum/Bootcamp/index.html">Bootcamp</a><ul><li><a href="/curriculum/Bootcamp/FAQ.html">FAQ</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/index.html">Unit 1 Object Oriented Programming</a><ul><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.1-JavaScript_Objects_And_Functions.html">0.1.1 JavaScript Objects And Functions</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.2-Test_Driven_Development.html">0.1.2 Test Driven Development</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.3-Objects_in_an_Airport_Domain.html">0.1.3 Objects in an Airport Domain</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.4-Static_functions_and_properties.html">0.1.4 Static functions and properties</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.5-Inheritance.html">0.1.5 Inheritance</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.6-Asynchronous_JavaScript.html">0.1.6 Asynchronous JavaScript</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.7-Asynchronous_Airport_Data_Load.html">0.1.7 Asynchronous Airport Data Load</a></li><li><a href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.8-Scooter_Hire_System.html">0.1.8 Scooter Hire System</a></li></ul></li><li><a href="/curriculum/Bootcamp/Unit-2-Databases/index.html">Unit 2 Databases</a><ul><li><a href="/curriculum/Bootcamp/Unit-2-Databases/0.2.1-Logical_Data_Model.html">0.2.1 Logical Data Model</a></li><li><a href="/curriculum/Bootcamp/Unit-2-Databases/0.2.10-Sequelize_part_2.html">0.2.10 Sequelize part 2</a></li><li><a href="/curriculum/Bootcamp/Unit-2-Databases/0.2.2-Implementing_the_Logical_Data_Model.html">0.2.2 Implementing the Logical Data Model</a></li><li><a href="/curriculum/Bootcamp/Unit-2-Databases/0.2.3-Basic_SQL_Commands.html">0.2.3 Basic SQL Commands</a></li><li><a href="/curriculum/Bootcamp/Unit-2-Databases/0.2.4-SQL_Joins.html">0.2.4 SQL Joins</a></li><li><a href="/curriculum/Bootcamp/Unit-2-Databases/0.2.5-Database_access_using_Node.html">0.2.5 Database access using Node</a></li><li><a href="/curriculum/Bootcamp/Unit-2-Databases/0.2.6-Populating_databases_from_JSON.html">0.2.6 Populating databases from JSON</a></li><li><a href="/curriculum/Bootcamp/Unit-2-Databases/0.2.7-Object_Relational_Mapping_part_1.html">0.2.7 Object Relational Mapping part 1</a></li><li><a href="/curriculum/Bootcamp/Unit-2-Databases/0.2.8-Object_Relational_Mapping_part_2.html">0.2.8 Object Relational Mapping part 2</a></li><li><a href="/curriculum/Bootcamp/Unit-2-Databases/0.2.9-Sequelize_part_1.html">0.2.9 Sequelize part 1</a></li></ul></li><li><a href="/curriculum/Bootcamp/Unit-3-API_development/index.html">Unit 3 API development</a><ul><li><a href="/curriculum/Bootcamp/Unit-3-API_development/0.3.1-Web_Servers.html">0.3.1 Web Servers</a></li><li><a href="/curriculum/Bootcamp/Unit-3-API_development/0.3.2-Application_Servers.html">0.3.2 Application Servers</a></li></ul></li></ul></li><li><a href="/curriculum/Module-2/index.html">Module 2</a><ul><li><a href="/curriculum/Module-2/Unit-1-The_Anatomy_of_the_HTTP_request/index.html">Unit 1 The Anatomy of the HTTP request</a><ul><li><a href="/curriculum/Module-2/Unit-1-The_Anatomy_of_the_HTTP_request/2.1.1-Identifying_the_different_parts_of_HTTP.html">2.1.1 Identifying the different parts of HTTP</a></li><li><a href="/curriculum/Module-2/Unit-1-The_Anatomy_of_the_HTTP_request/2.1.2-Programmatic_HTTP_requests.html">2.1.2 Programmatic HTTP requests</a></li></ul></li><li><a href="/curriculum/Module-2/Unit-2-What_is_REST/index.html">Unit 2 What is REST</a><ul><li><a href="/curriculum/Module-2/Unit-2-What_is_REST/2.2.1-REST_and_the_openAPI_spec.html">2.2.1 REST and the openAPI spec</a></li></ul></li></ul></li><li><a href="/curriculum/Module-3/index.html">Module 3</a><ul><li><a href="/curriculum/Module-3/Unit-1-The-SDLC/index.html">Unit 1 The SDLC</a><ul><li><a href="/curriculum/Module-3/Unit-1-The-SDLC/3.1.1-Business_Impact.html">3.1.1 Business Impact</a></li></ul></li></ul></li></ul></nav>
        <h1>REST and the openAPI spec</h1>
<h2>Overview</h2>
<p>Today we are going to focus on creating and using RESTful APIs. Yesterday we looked at the anatomy of an HTTP request and response. Today we will build on that knowledge and look at the most popular way to organise accessing resources using HTTP.</p>
<hr>
<h2>What is RESTful</h2>
<p>REST is a shortened form of &quot;<u>RE</u>presentative <u>S</u>tate <u>T</u>ransfer&quot;.</p>
<blockquote>
<p>REST is an architectural style for providing standards between computer systems on the web, making it easier for systems to communicate with each other.</p>
</blockquote>
<p>Before REST was first proposed in a <a href="https://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm">dissertation by Roy Thomas Fielding</a> servers implemented their own endpoints named in ways that different development teams saw fit. For example one application might have an endpoint called <code>/getUsers</code> another might call it <code>/allUsers</code> there was no agreed path name for fetching all users from an endpoint.</p>
<p>REST introduced a standard way to address resources on a server which made it much easier for other services to discover and use those resources.</p>
<blockquote>
<p>This is achieved by placing constraints on connector semantics where other styles have focused on component semantics. <small><i>Roy Thomas Fielding</i></small></p>
</blockquote>
<p>Today REST is widely implemented across the internet and we are going to learn about how to read and create our own RESTful web services.</p>
<h2>Learning Objectives</h2>
<ul>
<li>Connect the correct HTTP verbs to RESTful operations</li>
<li>Implement the OpenAPI specification</li>
</ul>
<h2>Pre-requisites</h2>
<ul>
<li>Knowledge of HTTP requests see <a href="">2.1.1</a> and <a href="">2.1.2</a></li>
<li>Create a free Spotify account so you can use their API (optional)</li>
</ul>
<h2>Materials needed</h2>
<ul>
<li><a href="https://raw.githubusercontent.com/WhiteHatLearningProducts/airports/master/airportsData.json">airports.json</a> (airport data)</li>
</ul>
<h2>Lesson</h2>
<p>There are 2 aspects to RESTful architectures.</p>
<ol>
<li>Using the right VERBS in your request</li>
<li>Using the right path for your resources</li>
</ol>
<h3>VERBS/METHODS</h3>
<p>Built into the HTTP spec are the http 'methods' or 'verbs'. <code>GET</code> <code>POST</code> <code>PATCH</code> <code>PUT</code> <code>DELETE</code> <em>(there are more these are the main ones)</em> one fundamental concept in REST is that these verbs should be used for particular operations. For example we might have a resource <code>/albums</code>; to read all the albums we would make an http request and use the <code>GET</code> method. If we wanted to add a new album we would make an http request to the <u>same</u> address <code>/albums</code> but use the <code>POST</code> method and include data in the body of the request. The method indicates the kind of operation that will be performed for that resource; reading with <code>GET</code> or creating with <code>POST</code>. We CAN make a <code>GET</code> request with a body and create a new <code>/albums</code> resource BUT that would not be RESTful.</p>
<h3>Resources</h3>
<p>A 'resource' some thing we want to access or interact with is also a fundamental concept in REST. Usually this is our service or data. For example on Spotify albums are a resource; so are artists and playlists. There is a standard set of paths used to interact with any resource:</p>
<table>
<thead>
<tr><th>HTTP Method</th><th>URL</th><th>Status code</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>GET</td><td><code>/albums</code></td><td>200</td><td>return all the albums (resources are always plural)</td></tr>
<tr><td>POST</td><td><code>/albums</code></td><td>201</td><td>create a new album</td></tr>
<tr><td>GET</td><td><code>/albums/{id}</code></td><td>200</td><td>return the album with the id specified in the URL</td></tr>
<tr><td>PUT</td><td><code>/albums/{id}</code></td><td>[200,204]</td><td>Replace the album with a new one, but keep the id</td></tr>
<tr><td>PATCH</td><td><code>/albums/{id}</code></td><td>[200,202,204]</td><td>Update 1 or more of the album's properties</td></tr>
<tr><td>DELETE</td><td><code>/albums/{id}</code></td><td>[200,202,204]</td><td>delete the album with the id specified in the URL</td></tr>
</tbody>
</table>
<p>Nested resources simple extend the same pattern.</p>
<table>
<thead>
<tr><th>HTTP Method</th><th>URL</th><th>Status code</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>GET</td><td><code>/albums/{id}/tracks</code></td><td>200</td><td>return the tracks for the album with the id specified in the URL</td></tr>
<tr><td>POST</td><td><code>/albums/{id}/tracks</code></td><td>201</td><td>create a new track for the album with the id specified in the URL</td></tr>
<tr><td>GET</td><td><code>/albums/{album_id}/tracks/{track_id}</code></td><td>200</td><td>return the track with the id specified in the URL from the album with the id specified in the URL</td></tr>
</tbody>
</table>
<p>Can you see the pattern?</p>
<p>❓ How might you update a track for a given album?</p>
<p>❓ Can you match the CRUD operations to http methods?</p>
<p>You might wonder why can't I just reference a track with the URL below?</p>
<table>
<thead>
<tr><th style="text-align:left">URL</th><th style="text-align:center">VERB</th><th style="text-align:left">Resource</th></tr>
</thead>
<tbody>
<tr><td style="text-align:left"><code>/tracks/{track_id}</code></td><td style="text-align:center">GET</td><td style="text-align:left">return the track with the id specified in the URL</td></tr>
</tbody>
</table>
<p>You can address a single track resource. However we are not capturing the relationship between this resource and the album resource that it belongs to. Often you will need to redirect back to a route that requires you to identify which album the track belongs to. The nested RESTful pattern helps you to do this cleanly in your controllers. REST is just a convention or as Roy Thomas Fielding put it 'connector semantics'.</p>
<h3>Documentation</h3>
<p>You will often find yourself consuming 3rd party APIs. Consider these 2 RESTful fundamentals; verbs and paths. We can expect to see these 2 things in most RESTful APIs. How quickly and easily it is to integrate with 3rd party APIs is largely down to the quality of their documentation. Often documentation is generated from the API code itself. This is a popular way to document APIs. Have a look at the examples of online generated API documentation below:</p>
<ul>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/repos">Github</a></li>
<li><a href="https://www.dropbox.com/developers/documentation/http/documentation#sharing-list_folders">Dropbox</a></li>
<li><a href="https://www.twilio.com/docs/usage/bulkexport/job#fetch-a-job-resource">Twilio</a></li>
<li><a href="https://developer.twitter.com/en/docs/twitter-api/tweets/lookup/api-reference/get-tweets">Twitter</a></li>
<li><a href="https://developer.spotify.com/documentation/web-api/reference-beta/#endpoint-get-multiple-albums">Spotify</a></li>
<li><a href="https://app.swaggerhub.com/apis-docs/tg4solutions/the-sneaker-database/1.0.0">The Sneaker Database</a></li>
</ul>
<p>❓ What are the common elements you can identify in each of the API documentation sites above?</p>
<p>❓ There are quite a few albums on Spotify and we can't actually <code>GET</code> all of them. What is the mechanism Spotify have used to limit the albums you can request?</p>
<p>❓ Why do you think auto generated documentation is a popular choice for dev teams who create and maintain public facing APIs?</p>
<h3>OpenAPI</h3>
<p>OpenAPI was originally part of the Swagger framework. Swagger became very popular and the developer community embraced the specification, it has  become a recognised standard used across the industry. OpenAPI became a separate project in 2016, overseen by the OpenAPI Initiative, an open-source collaboration project of the Linux Foundation.</p>
<p>Lets use <a href="https://www.openapis.org/">OpenAPI</a>/<a href="https://swagger.io/">Swagger</a> to define our API in a standard structure. There are lots of benefits from becoming familiar with this standard.<br>
You will become confident and familiar will all the things you need to consider when you design your own API endpoints. Other developers will be able to integrate with your API easily. Other tools can read the information about your API from the OpenAPI standard structure and generate web based documentation for you! Below is a starter example of an OpenAPI <code>airports-config.yaml</code> file.</p>
<pre><code class="language-yaml"><span class="hljs-attr">openapi:</span> <span class="hljs-number">3.0</span><span class="hljs-number">.0</span>
<span class="hljs-attr">info:</span>
  <span class="hljs-attr">title:</span> <span class="hljs-string">Airports</span> <span class="hljs-string">API</span>
  <span class="hljs-attr">description:</span> <span class="hljs-string">Get</span> <span class="hljs-string">all</span> <span class="hljs-string">your</span> <span class="hljs-string">airport</span> <span class="hljs-string">data</span> <span class="hljs-string">here</span> <span class="hljs-string">https://raw.githubusercontent.com/WhiteHatLearningProducts/airports/master/airportsData.json</span> 
  <span class="hljs-attr">version:</span> <span class="hljs-number">1.0</span><span class="hljs-number">.0</span>
<span class="hljs-attr">servers:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">url:</span> <span class="hljs-string">http://localhost:3000</span>
    <span class="hljs-attr">description:</span> <span class="hljs-string">if</span> <span class="hljs-string">you</span> <span class="hljs-string">are</span> <span class="hljs-string">using</span> <span class="hljs-string">NodeJS</span> <span class="hljs-string">your</span> <span class="hljs-string">dev</span> <span class="hljs-string">port</span> <span class="hljs-string">might</span> <span class="hljs-string">be</span> <span class="hljs-number">3000</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">url:</span> <span class="hljs-string">http://localhost:8080</span>
    <span class="hljs-attr">description:</span> <span class="hljs-string">if</span> <span class="hljs-string">you</span> <span class="hljs-string">are</span> <span class="hljs-string">using</span> <span class="hljs-string">Spring</span> <span class="hljs-string">your</span> <span class="hljs-string">dev</span> <span class="hljs-string">port</span> <span class="hljs-string">will</span> <span class="hljs-string">be</span> <span class="hljs-number">8080</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">url:</span> <span class="hljs-string">https://airports-api.whitehatcoaches.org.uk</span>
    <span class="hljs-attr">description:</span> <span class="hljs-string">this</span> <span class="hljs-string">is</span> <span class="hljs-string">the</span> <span class="hljs-string">production</span> <span class="hljs-string">baseURL</span>
<span class="hljs-attr">paths:</span>
  <span class="hljs-string">/airports:</span>
    <span class="hljs-attr">get:</span>
      <span class="hljs-attr">summary:</span> <span class="hljs-string">Returns</span> <span class="hljs-string">a</span> <span class="hljs-string">list</span> <span class="hljs-string">of</span> <span class="hljs-string">all</span> <span class="hljs-string">the</span> <span class="hljs-string">airports</span>
      <span class="hljs-attr">description:</span> <span class="hljs-string">|
        blar blar 28,000 airports etc
</span>
        <span class="hljs-string">*</span> <span class="hljs-string">you</span> <span class="hljs-string">can</span> <span class="hljs-string">also</span> <span class="hljs-string">use</span>
        <span class="hljs-string">*</span> <span class="hljs-string">markdown</span> <span class="hljs-string">in</span> <span class="hljs-string">this</span> <span class="hljs-string">section</span>

        <span class="hljs-type">![airport](https://twistedsifter.com/wp</span><span class="hljs-string">-content/uploads/2014/11/mexico-city-international-airport-drone-video.jpg)</span>

        <span class="hljs-string">Including</span> <span class="hljs-string">images!</span>
      <span class="hljs-attr">responses:</span>
        <span class="hljs-attr">200:</span>
          <span class="hljs-attr">description:</span> <span class="hljs-string">an</span> <span class="hljs-string">array</span> <span class="hljs-string">of</span> <span class="hljs-string">JSON</span> <span class="hljs-string">objects</span> <span class="hljs-string">that</span> <span class="hljs-string">represent</span> <span class="hljs-string">each</span> <span class="hljs-string">airport</span>
          <span class="hljs-attr">content:</span>
            <span class="hljs-attr">application/json:</span>
              <span class="hljs-attr">schema:</span>
                <span class="hljs-attr">type:</span> <span class="hljs-string">array</span>
                <span class="hljs-attr">items:</span>
                  <span class="hljs-attr">type:</span> <span class="hljs-string">object</span>
                  <span class="hljs-attr">properties:</span>
                    <span class="hljs-attr">icao:</span>
                      <span class="hljs-attr">type:</span> <span class="hljs-string">string</span>
                    <span class="hljs-attr">iata:</span>
                      <span class="hljs-attr">type:</span> <span class="hljs-string">string</span>
                    <span class="hljs-attr">name:</span>
                      <span class="hljs-attr">type:</span> <span class="hljs-string">string</span>
                    <span class="hljs-attr">city:</span>
                      <span class="hljs-attr">type:</span> <span class="hljs-string">string</span>
                    <span class="hljs-attr">state:</span>
                      <span class="hljs-attr">type:</span> <span class="hljs-string">string</span>
                    <span class="hljs-attr">country:</span>
                      <span class="hljs-attr">type:</span> <span class="hljs-string">string</span>
                    <span class="hljs-attr">elevation:</span>
                      <span class="hljs-attr">type:</span> <span class="hljs-string">integer</span>
                    <span class="hljs-attr">lat:</span>
                      <span class="hljs-attr">type:</span> <span class="hljs-string">number</span>
                      <span class="hljs-attr">format:</span> <span class="hljs-string">double</span>
                    <span class="hljs-attr">lon:</span>
                      <span class="hljs-attr">type:</span> <span class="hljs-string">number</span>
                      <span class="hljs-attr">format:</span> <span class="hljs-string">double</span>
                    <span class="hljs-attr">tz:</span>
                      <span class="hljs-attr">type:</span> <span class="hljs-string">string</span>
                  <span class="hljs-attr">example:</span>
                    <span class="hljs-attr">icao:</span> <span class="hljs-string">&quot;00AK&quot;</span>
                    <span class="hljs-attr">iata:</span> <span class="hljs-string">&quot;&quot;</span>
                    <span class="hljs-attr">name:</span> <span class="hljs-string">&quot;Lowell Field&quot;</span>
                    <span class="hljs-attr">city:</span> <span class="hljs-string">&quot;Anchor Point&quot;</span>
                    <span class="hljs-attr">state:</span> <span class="hljs-string">&quot;Alaska&quot;</span>
                    <span class="hljs-attr">country:</span> <span class="hljs-string">&quot;US&quot;</span>
                    <span class="hljs-attr">elevation:</span> <span class="hljs-number">450</span>
                    <span class="hljs-attr">lat:</span> <span class="hljs-number">59.94919968</span>
                    <span class="hljs-attr">lon:</span> <span class="hljs-number">-151.695999146</span>
                    <span class="hljs-attr">tz:</span> <span class="hljs-string">&quot;America/Anchorage&quot;</span>
</code></pre>
<p>You can upload this to a site like <a href="https://readme.com/">readme.com</a> (or use a <a href="https://whitehatlearningproducts.github.io/swe/api-example.yaml">url</a>) and generate a page of documentation like the ones we have looked at above.</p>
<p><figure><img src="https://user-images.githubusercontent.com/4499581/104598397-712b8180-566e-11eb-97b3-05f2c0d577b5.png" alt="a page of OpenAPI markup rendered as a webpage"><figcaption></figcaption></figure></p>
<h2>Assignment</h2>
<p>In an OpenAPI <code>airports-config.yaml</code> file create a complete set of documented RESTful endpoints for the <code>/airports</code> resource. The resource we can use is the Airports we used in the first 5 week bootcamp. You can look up the specification for <a href="https://swagger.io/resources/open-api/">openapi here</a>. We want routes to create, read (all airports and a single airport), update and delete;</p>
<p>You might find this <a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">list of HTTP status codes</a> useful when defining your endpoint's responses.</p>
<p>Once you have got your <code>airports-config.yaml</code> file completed you can even have a go at generating a server from that definition. Below are instructions using javascript and java.</p>
<p>|Javascript|Java|</p>
<pre><code class="language-javascript"><span class="hljs-comment">/**
* npm install -g swagger-node-codegen
* snc airports_config.yaml -o airports-node
* cd into the airports-node folder and start the server with npm start
*/</span>

npm start
</code></pre>
<pre><code class="language-java"><span class="hljs-comment">/*
  download swagger-codegen-cli-3.0.24.jar from https://repo1.maven.org/maven2/io/swagger/codegen/v3/swagger-codegen-cli/3.0.24/swagger-codegen-cli-3.0.24.jar

  in the same folder create a config.json file with the following as its contents:

  {
    &quot;basePackage&quot;: &quot;org.whitehat&quot;,
    &quot;configPackage&quot;: &quot;org.whitehat.app.config&quot;
  }

  now run the command below

  java -jar swagger-codegen-cli-3.0.24.jar generate \
    -i $PWD/airports-config.yaml \
    -l spring \
    -o airports-java \
    -c $PWD/config.json \
    -DhideGenerationTimestamp=true
*/</span>
</code></pre>
<p>Be ready to demo your generated server and share your <code>airports-config.yaml</code> file with your coach.</p>

        <script src="/curriculum/js/tabbed-code-blocks.js"></script>
        <script>
            function toggleNav() {
                const button = document.getElementById('navigation-toggle')
                const isAriaExp = button.getAttribute('aria-expanded')
                const newAriaExp = (isAriaExp == "false") ? "true" : "false"
                button.setAttribute('aria-expanded', newAriaExp)
                const nav = document.getElementById('navigation')
                nav.style.display = nav.offsetParent ? 'none' : 'block'
            }
        </script>
    </body>
</html>