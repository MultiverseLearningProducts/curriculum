<!DOCTYPE html>
<html lang="en-GB">

<head>
    <meta charset="utf-8">
    <title>
         Integrating Redux
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="shortcut icon" type="image/x-icon" href="/curriculum/favicon.ico" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/an-old-hope.min.css">
    <link rel="stylesheet" href="/curriculum/style.css" />
    <script src="/curriculum/js/highlight.min.js"></script>
    <script src="/curriculum/js/bash.min.js"></script>
    <script src="/curriculum/js/java.min.js"></script>
    <script src="/curriculum/js/javascript.min.js"></script>
    <script src="/curriculum/js/sql.min.js"></script>
</head>

<body>
    <button id="navigation-toggle" aria-expanded="false" aria-haspopup="true" onclick="toggleNav()"
        onkeydown="event => {event.keyCode === 13 ? toggleNav() : null}" tabindex="1">Table of contents</button>
    <nav id="navigation"><ul><details><summary>Bootcamp</summary><ul><details><summary>Unit 1 Object Oriented Programming</summary><ul><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.0-UML_Modelling.html">0.1.0 UML Modelling</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.1-JavaScript_Objects_And_Functions.html">0.1.1 JavaScript Objects And Functions</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.2-Test_Driven_Development.html">0.1.2 Test Driven Development</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.3-Objects_in_an_Airport_Domain.html">0.1.3 Objects in an Airport Domain</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.4-Static_functions_and_properties.html">0.1.4 Static functions and properties</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.5-Inheritance.html">0.1.5 Inheritance</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.7-OOP_Challenge.html">0.1.7 OOP Challenge</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-1-Object_Oriented_Programming/0.1.8-End_of_Unit_Quiz_OOP.html">0.1.8 End of Unit Quiz OOP</a></li></ul></details><details><summary>Unit 2 Asynchronous JavaScript</summary><ul><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-2-Asynchronous_JavaScript/0.2.1-Asynchronous_JavaScript.html">0.2.1 Asynchronous JavaScript</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-2-Asynchronous_JavaScript/0.2.2-Promises.html">0.2.2 Promises</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-2-Asynchronous_JavaScript/0.2.3-Asynchronous_Airport_Data_Load.html">0.2.3 Asynchronous Airport Data Load</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-2-Asynchronous_JavaScript/0.2.4-End_of_Unit_Quiz_Async.html">0.2.4 End of Unit Quiz Async</a></li></ul></details><details><summary>Unit 3 Relational Databases</summary><ul><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.10-Sequelize_part_2.html">0.3.10 Sequelize part 2</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.11-End_of_Unit_Quiz_Databases.html">0.3.11 End of Unit Quiz Databases</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.2-Introduction_to_Databases.html">0.3.2 Introduction to Databases</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.3-Basic_SQL_Commands.html">0.3.3 Basic SQL Commands</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.4-SQL_Joins.html">0.3.4 SQL Joins</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.5-Database_access_using_Node.html">0.3.5 Database access using Node</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.6-Populating_databases_from_JSON.html">0.3.6 Populating databases from JSON</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.7-Object_Relational_Mapping_part_1.html">0.3.7 Object Relational Mapping part 1</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.8-Object_Relational_Mapping_part_2.html">0.3.8 Object Relational Mapping part 2</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.9-Sequelize_part_1.html">0.3.9 Sequelize part 1</a></li></ul></details><details><summary>Unit 4 RESTful Servers</summary><ul><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/0.4.1-Web_Servers.html">0.4.1 Web Servers</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/0.4.2-Application_Servers.html">0.4.2 Application Servers</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/0.4.3-Postman.html">0.4.3 Postman</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/0.4.4-Route_Parameters.html">0.4.4 Route Parameters</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/0.4.5-CRUD_operations.html">0.4.5 CRUD operations</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/0.4.6-Server_side_Validation.html">0.4.6 Server side Validation</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-4-RESTful_Servers/0.4.7-End_of_Unit_Quiz_RESTful.html">0.4.7 End of Unit Quiz RESTful</a></li></ul></details><details><summary>Unit 5 Human Computer Interaction</summary><ul><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-5-Human_Computer_Interaction/0.5.1-Human_Computer_Interaction.html">0.5.1 Human Computer Interaction</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-5-Human_Computer_Interaction/0.5.2-Server_Side_Rendering.html">0.5.2 Server Side Rendering</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-5-Human_Computer_Interaction/0.5.3-The_Document_Object_Model.html">0.5.3 The Document Object Model</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-5-Human_Computer_Interaction/0.5.4-HTML_forms_and_lists.html">0.5.4 HTML forms and lists</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-5-Human_Computer_Interaction/0.5.5-End_of_Unit_Quiz_HCI.html">0.5.5 End of Unit Quiz HCI</a></li></ul></details><details><summary>Unit 6 End Of Bootcamp Group Project</summary><ul><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/0.6.1-Introduction.html">0.6.1 Introduction</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/0.6.2-Requirements.html">0.6.2 Requirements</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/0.6.3-Agile_Development.html">0.6.3 Agile Development</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/0.6.4-Design.html">0.6.4 Design</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/0.6.5-GitHub_Projects.html">0.6.5 GitHub Projects</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/0.6.6-Branching_and_Pull_Requests.html">0.6.6 Branching and Pull Requests</a></li><li><a class="nav-link" href="/curriculum/Bootcamp/Unit-6-End_Of_Bootcamp_Group_Project/0.6.7-Deployment_with_Heroku.html">0.6.7 Deployment with Heroku</a></li></ul></details></ul></details><details><summary>Module 1</summary><ul><details><summary>Unit 1 Agile user requirements</summary><ul><li><a class="nav-link" href="/curriculum/Module-1/Unit-1-Agile_user_requirements/1.1.1-Introduction_to_Agile.html">1.1.1 Introduction to Agile</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-1-Agile_user_requirements/1.1.2-Personas.html">1.1.2 Personas</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-1-Agile_user_requirements/1.1.3-User_Stories.html">1.1.3 User Stories</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-1-Agile_user_requirements/1.1.4-Requirements.html">1.1.4 Requirements</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-1-Agile_user_requirements/1.1.5-Next_Steps.html">1.1.5 Next Steps</a></li></ul></details><details><summary>Unit 2 Designing UI</summary><ul><li><a class="nav-link" href="/curriculum/Module-1/Unit-2-Designing_UI/1.2.1-Usability_heuristics.html">1.2.1 Usability heuristics</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-2-Designing_UI/1.2.2-Composition_and_components_in_design.html">1.2.2 Composition and components in design</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-2-Designing_UI/1.2.3-Prototyping_UI.html">1.2.3 Prototyping UI</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-2-Designing_UI/1.2.4-Next_Steps.html">1.2.4 Next Steps</a></li></ul></details><details><summary>Unit 3 Building UI with React</summary><ul><li><a class="nav-link" href="/curriculum/Module-1/Unit-3-Building_UI_with_React/1.3.0-Welcome_to_Unit_3.html">1.3.0 Welcome to Unit 3</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-3-Building_UI_with_React/1.3.1-Getting_started_with_React.html">1.3.1 Getting started with React</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-3-Building_UI_with_React/1.3.2-React_methods_and_computed_properties.html">1.3.2 React methods and computed properties</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-3-Building_UI_with_React/1.3.3-Events_and_adding_to_cart.html">1.3.3 Events and adding to cart</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-3-Building_UI_with_React/1.3.4-Introducing_routing_to_our_app.html">1.3.4 Introducing routing to our app</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-3-Building_UI_with_React/1.3.5-Fixing_the_add_to_cart_event.html">1.3.5 Fixing the add to cart event</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-3-Building_UI_with_React/1.3.6-Adding_the_product_details_page.html">1.3.6 Adding the product details page</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-3-Building_UI_with_React/1.3.7-Integrating_Redux_for_global_state_management.html">1.3.7 Integrating Redux for global state management</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-3-Building_UI_with_React/1.3.8-Consolidating_the_final_components.html">1.3.8 Consolidating the final components</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-3-Building_UI_with_React/1.3.9-Closing_thoughts_and_next_steps.html">1.3.9 Closing thoughts and next steps</a></li></ul></details><details><summary>Unit 3 Building UI with Vue.js</summary><ul><li><a class="nav-link" href="/curriculum/Module-1/Unit-3-Building_UI_with_Vue.js/1.3.0-Welcome_to_Unit_3.html">1.3.0 Welcome to Unit 3</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-3-Building_UI_with_Vue.js/1.3.1-Getting_started_with_the_Vue_CDN.html">1.3.1 Getting started with the Vue CDN</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-3-Building_UI_with_Vue.js/1.3.2-Vue_methods_and_computed_properties.html">1.3.2 Vue methods and computed properties</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-3-Building_UI_with_Vue.js/1.3.3-Events_and_adding_to_cart.html">1.3.3 Events and adding to cart</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-3-Building_UI_with_Vue.js/1.3.4-Introducing_routing_to_our_app.html">1.3.4 Introducing routing to our app</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-3-Building_UI_with_Vue.js/1.3.5-Fixing_the_add_to_cart_event.html">1.3.5 Fixing the add to cart event</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-3-Building_UI_with_Vue.js/1.3.6-Adding_the_product_details_page.html">1.3.6 Adding the product details page</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-3-Building_UI_with_Vue.js/1.3.7-Integrating_Vuex_for_global_state_management.html">1.3.7 Integrating Vuex for global state management</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-3-Building_UI_with_Vue.js/1.3.8-Consolidating_the_final_components.html">1.3.8 Consolidating the final components</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-3-Building_UI_with_Vue.js/1.3.9-Closing_thoughts_and_next_steps.html">1.3.9 Closing thoughts and next steps</a></li></ul></details><details><summary>Unit 4 Accessibility</summary><ul><li><a class="nav-link" href="/curriculum/Module-1/Unit-4-Accessibility/1.4.1-Inclusive_design.html">1.4.1 Inclusive design</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-4-Accessibility/1.4.2-Accessibility.html">1.4.2 Accessibility</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-4-Accessibility/1.4.3-Next_Steps.html">1.4.3 Next Steps</a></li></ul></details><details><summary>Unit 5 End to end testing</summary><ul><li><a class="nav-link" href="/curriculum/Module-1/Unit-5-End_to_end_testing/1.5.1-End_to_end_testing.html">1.5.1 End to end testing</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-5-End_to_end_testing/1.5.2-End_to_end_testing_with_Cypress.html">1.5.2 End to end testing with Cypress</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-5-End_to_end_testing/1.5.3-Adding_more_test_coverage.html">1.5.3 Adding more test coverage</a></li><li><a class="nav-link" href="/curriculum/Module-1/Unit-5-End_to_end_testing/1.5.4-Test_cases_and_equivalence_testing.html">1.5.4 Test cases and equivalence testing</a></li></ul></details></ul></details><details><summary>Module 2</summary><ul><details><summary>Unit 1 Securing APIs with Basic Auth</summary><ul><li><a class="nav-link" href="/curriculum/Module-2/Unit-1-Securing_APIs_with_Basic_Auth/2.1.1-RESTful_APIs_and_Frameworks.html">2.1.1 RESTful APIs and Frameworks</a></li><li><a class="nav-link" href="/curriculum/Module-2/Unit-1-Securing_APIs_with_Basic_Auth/2.1.2-Password_Hashing.html">2.1.2 Password Hashing</a></li><li><a class="nav-link" href="/curriculum/Module-2/Unit-1-Securing_APIs_with_Basic_Auth/2.1.3-Implementing_Basic_Auth.html">2.1.3 Implementing Basic Auth</a></li><li><a class="nav-link" href="/curriculum/Module-2/Unit-1-Securing_APIs_with_Basic_Auth/2.1.4-Limitations_of_Basic_Auth.html">2.1.4 Limitations of Basic Auth</a></li></ul></details><details><summary>Unit 2 Securing APIs with OAuth and OpenID Connect</summary><ul><li><a class="nav-link" href="/curriculum/Module-2/Unit-2-Securing_APIs_with_OAuth_and_OpenID_Connect/2.2.1-Introduction_to_OAuth.html">2.2.1 Introduction to OAuth</a></li><li><a class="nav-link" href="/curriculum/Module-2/Unit-2-Securing_APIs_with_OAuth_and_OpenID_Connect/2.2.2-Securing_APIs_with_OAuth.html">2.2.2 Securing APIs with OAuth</a></li><li><a class="nav-link" href="/curriculum/Module-2/Unit-2-Securing_APIs_with_OAuth_and_OpenID_Connect/2.2.3-OpenID_Connect.html">2.2.3 OpenID Connect</a></li><li><a class="nav-link" href="/curriculum/Module-2/Unit-2-Securing_APIs_with_OAuth_and_OpenID_Connect/2.2.4-Module_2_assessment.html">2.2.4 Module 2 assessment</a></li></ul></details></ul></details><details><summary>Module 3</summary><ul><details><summary>Unit 1 The SDLC</summary><ul><li><a class="nav-link" href="/curriculum/Module-3/Unit-1-The-SDLC/3.1.1-The_Software_Development_Life_Cycle.html">3.1.1 The Software Development Life Cycle</a></li><li><a class="nav-link" href="/curriculum/Module-3/Unit-1-The-SDLC/3.1.2-The_roles_and_responsibilities_in_the_SDLC_with_communication.html">3.1.2 The roles and responsibilities in the SDLC with communication</a></li><li><a class="nav-link" href="/curriculum/Module-3/Unit-1-The-SDLC/3.1.3-Communication_in_your_teams.html">3.1.3 Communication in your teams</a></li></ul></details><details><summary>Unit 2 The 7 Princibles of Testing</summary><ul><li><a class="nav-link" href="/curriculum/Module-3/Unit-2-The-7-Princibles-of-Testing/3.2.1-The_7_Princibles_of_Testing.html">3.2.1 The 7 Princibles of Testing</a></li></ul></details><details><summary>Unit 3 Deployment and Maintenance</summary><ul><li><a class="nav-link" href="/curriculum/Module-3/Unit-3-Deployment-and-Maintenance/3.3.1-Introduction_to_Unix.html">3.3.1 Introduction to Unix</a></li><li><a class="nav-link" href="/curriculum/Module-3/Unit-3-Deployment-and-Maintenance/3.3.2-Introduction_to_containerisation.html">3.3.2 Introduction to containerisation</a></li><li><a class="nav-link" href="/curriculum/Module-3/Unit-3-Deployment-and-Maintenance/3.3.3-Introduction_to_Cloud_Computing.html">3.3.3 Introduction to Cloud Computing</a></li><li><a class="nav-link" href="/curriculum/Module-3/Unit-3-Deployment-and-Maintenance/3.3.4-Monitoring_and_Maintenance.html">3.3.4 Monitoring and Maintenance</a></li></ul></details></ul></details><details><summary>Module 4</summary><ul><details><summary>Unit 1 Open Web Application Security Project</summary><ul><li><a class="nav-link" href="/curriculum/Module-4/Unit-1-Open_Web_Application_Security_Project/4.1.1-Introduction_to_the_OWASP_Top_Ten.html">4.1.1 Introduction to the OWASP Top Ten</a></li><li><a class="nav-link" href="/curriculum/Module-4/Unit-1-Open_Web_Application_Security_Project/4.1.2-Injection_Attacks.html">4.1.2 Injection Attacks</a></li><li><a class="nav-link" href="/curriculum/Module-4/Unit-1-Open_Web_Application_Security_Project/4.1.3-Broken_Authentication.html">4.1.3 Broken Authentication</a></li><li><a class="nav-link" href="/curriculum/Module-4/Unit-1-Open_Web_Application_Security_Project/4.1.3-Exposing_Sensitive_Data.html">4.1.3 Exposing Sensitive Data</a></li><li><a class="nav-link" href="/curriculum/Module-4/Unit-1-Open_Web_Application_Security_Project/4.1.4-Monitoring_for_attacks.html">4.1.4 Monitoring for attacks</a></li><li><a class="nav-link" href="/curriculum/Module-4/Unit-1-Open_Web_Application_Security_Project/4.1.5-The_role_of_a_Penetration_Tester.html">4.1.5 The role of a Penetration Tester</a></li><li><a class="nav-link" href="/curriculum/Module-4/Unit-1-Open_Web_Application_Security_Project/4.1.6-Next_Steps.html">4.1.6 Next Steps</a></li></ul></details></ul></details></ul></nav>
    <h1>Integrating Redux</h1>
<p>Now we have introduced the Product Details page, we need a way to access that Product's information so we can display it on the frontend. You've done that. The problem is, passing the whole <strong>data.products</strong> array into a component that only needs one product is not a scalable approach.</p>
<p>Instead, we need a central place to manage the data state and to give the Product Details component the ability to query the state based on the dynamic ID we pass in the URL.</p>
<h2>Learning Objectives</h2>
<ul>
<li>Re-imagine our app using Redux</li>
<li>Query product information by ProductID</li>
<li>Display Product information on the Product Details page</li>
</ul>
<h2>Re-imagining our app using Redux</h2>
<p>Let's first visualise how the Redux store will fit in to our project:</p>
<p><figure><img src="https://redux.js.org/assets/images/ReduxDataFlowDiagram-49fa8c3968371d9ef6f2a1486bd40a26.gif" alt="animated example of actions being dispatched in Redux"><figcaption></figcaption></figure></p>
<ol>
<li>The UI triggers an event</li>
<li>The event handler dispatches an 'action'</li>
<li>The store receives the action and filters it down through all the resolvers looking for a match</li>
<li>A resolver updates the store</li>
<li>Redux triggers a re-render of all the components that have used a selector to select those <em>reactive</em> variables from within the store with the newly updated value</li>
</ol>
<p>Our <strong>cart</strong> is a good candidate for the store because it is an example of global state. The data of all the <strong>data.products</strong> is also something that can live in the store as that will save us having to pass it around when we want to read from it.</p>
<h2>Get on board the refactor tractor 🚜</h2>
<p>Here are the steps we need to take our app to the next level.</p>
<ol>
<li>Install redux</li>
<li>Create the redux store</li>
<li>Establish the initial state of the store</li>
<li>Read values from the store</li>
<li>Create actions to update the store</li>
<li>Dispatch those actions from our components</li>
<li>Check we have maintain all the functionality from before</li>
</ol>
<h3>Install redux</h3>
<pre><code><span class="hljs-built_in">npm</span> install @reduxjs/toolkit react-redux 
</code></pre>
<p>We are adding 2 libraries.</p>
<h3>Create the redux store</h3>
<p>This needs to be at the highest level of the application so we are going to go one step above our <strong>App</strong> component into the <code>index.js</code> file. In here we will create the redux store and make it avaiable to every component in our app to access.</p>
<pre><code class="language-javascript"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react&#x27;</span>;
<span class="hljs-keyword">import</span> ReactDOM <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-dom&#x27;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;./index.css&#x27;</span>;
<span class="hljs-keyword">import</span> App <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./App&#x27;</span>;
<span class="hljs-keyword">import</span> reportWebVitals <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./reportWebVitals&#x27;</span>;
<span class="hljs-keyword">import</span> { configureStore, createSlice } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@reduxjs/toolkit&#x27;</span>
<span class="hljs-keyword">import</span> { Provider } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-redux&#x27;</span>
<span class="hljs-keyword">import</span> data <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./products.json&#x27;</span>

<span class="hljs-keyword">const</span> initialState = createSlice({
  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;plants-direct&#x27;</span>,
  <span class="hljs-attr">initialState</span>: {
    <span class="hljs-attr">cart</span>: [],
    <span class="hljs-attr">products</span>: data.products
  },
  <span class="hljs-attr">reducers</span>: {}
})

<span class="hljs-keyword">const</span> store = configureStore(initialState)

ReactDOM.render(
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">React.StrictMode</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">Provider</span> <span class="hljs-attr">store</span>=<span class="hljs-string">{store}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">App</span> /&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">Provider</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">React.StrictMode</span>&gt;</span></span>,
  <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&#x27;root&#x27;</span>)
);

<span class="hljs-comment">// If you want to start measuring performance in your app, pass a function</span>
<span class="hljs-comment">// to log results (for example: reportWebVitals(console.log))</span>
<span class="hljs-comment">// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals</span>
reportWebVitals();
</code></pre>
<p>From the top of the file, we are importing some tools, <code>{ configureStore, createSlice }</code> and a <strong>Provider</strong> Component from our newly added modules. Next we create a slice of a redux store, this has a name, state and reducers. We then create a redux store object by calling <strong>configureStore</strong> and then pass this into the <strong>Provider</strong> component.</p>
<h3>Establish the initial state of the store</h3>
<p>Our store has the initial state of the cart (an empty array), and the products.</p>
<h3>Read values from the store</h3>
<p>To read from the store use the <strong>useSelector</strong> function. Update the <strong>Home</strong> component to map over the products from the store not from <strong>props</strong>.</p>
<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { Product } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./Product&#x27;</span>
<span class="hljs-keyword">import</span> { useSelector } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-redux&#x27;</span>

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Home</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> products = useSelector(<span class="hljs-function"><span class="hljs-params">state</span> =&gt;</span> state.products)
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>
      {products.map(product =&gt; <span class="hljs-tag">&lt;<span class="hljs-name">Product</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{product.productId}</span> <span class="hljs-attr">product</span>=<span class="hljs-string">{product}</span> /&gt;</span>)}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Home;
</code></pre>
<p><strong>useSelector</strong> returns a <em>reactive</em> variable that is selected from the store's state via a function. We pass <strong>useSelector</strong> a function that must pick out the values we want to read from and be <em>reactive</em>.</p>
<p>Check this works OK.</p>
<p>In the <strong>ProductDetails</strong> component you can do the same. Create a selector function that picks out a product from the products in the store i.e. <strong>useSelector(state =&gt; state.products.find...)</strong></p>
<p>You can now remove the data import from the <strong>App</strong> component, and remove the way we passed data down though the <strong>Home</strong> component via props etc.</p>
<pre><code class="language-javascript">    &lt;Route path=<span class="hljs-string">&quot;/&quot;</span>&gt;
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Home</span> <span class="hljs-attr">addToCart</span>=<span class="hljs-string">{addToCart}</span> /&gt;</span></span>
    &lt;/Route&gt;
</code></pre>
<h3>Create actions to update the store</h3>
<p>We can create actions in a the store's reducer. These actions can update the state in a mutable way. Behind the scenes your mutations are dealt with in an immutable way (but that is for another session!). Your actions will be functions that receive the store's state and if you pass parameters in your actions, they will be available on an object as <strong>action.payload</strong>.</p>
<p>Here is my refactored <strong>addToCart</strong> function. I'm making sure I change <em>both</em> the cart and the product in the products array as I want to cause a re-render of everything that is reading these two values.</p>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> initialState = createSlice({
  <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;plants-direct&#x27;</span>,
  <span class="hljs-attr">initialState</span>: {
    <span class="hljs-attr">cart</span>: [],
    <span class="hljs-attr">products</span>: data.products
  },
  <span class="hljs-attr">reducers</span>: {
    <span class="hljs-attr">addToCart</span>: <span class="hljs-function">(<span class="hljs-params">state, action</span>) =&gt;</span> {
      <span class="hljs-keyword">const</span> index = state.products.findIndex(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p.productId === action.payload.productId)
      <span class="hljs-keyword">const</span> inCart = state.cart.findIndex(<span class="hljs-function"><span class="hljs-params">p</span> =&gt;</span> p.productId === action.payload.productId)

      <span class="hljs-keyword">if</span> (inCart &gt; -<span class="hljs-number">1</span>) {
        state.products[index].addedToCart = <span class="hljs-literal">false</span>
        state.cart.splice(index, <span class="hljs-number">1</span>)
      } <span class="hljs-keyword">else</span> {
        state.products[index].addedToCart = <span class="hljs-literal">true</span>
        state.cart.push(action.payload)
      }
    }
  }
})

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> { addToCart } = initialState.actions
</code></pre>
<p>🉐 Notice on the last line above I'm exposing the <strong>addToCart</strong> function so I can call it from elsewhere in the app.</p>
<h3>Dispatch those actions from our components</h3>
<p>In the UI when I click on the 'Add to cart' button I want to <em>dispatch</em> that action. I need 2 things to dispatch an action.</p>
<ol>
<li><strong>useDispatch</strong> from 'react-redux'</li>
<li>the action to dispatch from my own redux store</li>
</ol>
<p>In your <strong>Product</strong> component import the above 2 items. Then create an instance of <em>dispatch</em> then call <em>dispatch()</em> with your action called with the right parameter. See the example below.</p>
<pre><code class="language-javascript"><span class="hljs-keyword">import</span> { Link } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-router-dom&#x27;</span>
<span class="hljs-keyword">import</span> { addToCart } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./index&#x27;</span>
<span class="hljs-keyword">import</span> { useDispatch } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;react-redux&#x27;</span>

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> Product = <span class="hljs-function">(<span class="hljs-params">props</span>) =&gt;</span> {
    <span class="hljs-keyword">const</span> {
        productId,
        name,
        images,
        addedToCart
    } = props.product

    <span class="hljs-keyword">const</span> dispatch = useDispatch()

    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">article</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;product&quot;</span>&gt;</span>
            {/* rest of your component code */}
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;promo-blocks__actions&quot;</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">{</span>`/<span class="hljs-attr">products</span>/${<span class="hljs-attr">productId</span>}`}&gt;</span>Full Details<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span>    
                <span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> dispatch(addToCart(props.product))}&gt;{addedToCart ? &#x27;Remove from&#x27; : &#x27;Add to&#x27;} cart<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>            
        <span class="hljs-tag">&lt;/<span class="hljs-name">article</span>&gt;</span></span>
    )
}
</code></pre>
<h3>Check we have maintain all the functionality from before</h3>
<p>You should now be able to remove all references to <strong>addToCart</strong> from props, we don't need to pass it around any more.</p>
<h2>Assignment</h2>
<ul>
<li>Can you dispatch the <strong>addToCart</strong> action from the <strong>ProductDetails</strong> component?</li>
</ul>
<p>You should now see the Product Details and be able to add/remove the product to/from the cart! In addition, the state should hold when you return to the home page. Add the product to the cart, return home, and you should still see the item in the cart. You should also see that the product's 'Add to cart' button has changed to 'Remove from cart'.</p>
<h2>Additional resources</h2>
<p><a href="https://redux.js.org/tutorials/quick-start">Redux quick start</a></p>

    <nav id="footer-nav"></nav>
    <script src="/curriculum/js/tabbed-code-blocks.js"></script>
    <script>
        function toggleNav() {
            const button = document.getElementById('navigation-toggle')
            const isAriaExp = button.getAttribute('aria-expanded')
            const newAriaExp = (isAriaExp == "false") ? "true" : "false"
            button.setAttribute('aria-expanded', newAriaExp)
            const nav = document.getElementById('navigation')
            nav.style.display = nav.offsetParent ? 'none' : 'block'
        }
        ; (function footerNav() {
            const links = document.getElementsByClassName('nav-link')
            const hrefs = Array.from(links).map(a => a.getAttribute('href'))
            const index = hrefs.findIndex(href => {
                const page = href.split("/").pop()
                const current = window.location.href.split("/").pop()
                return page === current
            })
            const prevIndex = index - 1
            const nextIndex = index + 1
            if (prevIndex > -1) {
                const prev = document.createElement('a') 
                prev.appendChild(document.createTextNode("◀︎ Prev"))
                prev.title = "Previous session notes"
                prev.href = hrefs[prevIndex]
                document.getElementById('footer-nav').prepend(prev)
            }
            if (nextIndex < hrefs.length) {
                const next = document.createElement('a') 
                next.appendChild(document.createTextNode("Next ►"))
                next.title = "Next session notes"
                next.href = hrefs[nextIndex]
                document.getElementById('footer-nav').append(next)
            }
        })()

    </script>
</body>

</html>