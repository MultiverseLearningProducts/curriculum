<!DOCTYPE html>
<html lang="en-GB">
    <head>
        <meta charset="utf-8">
        <title> The Anatomy of the HTTP request</title>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <link rel="shortcut icon" type="image/x-icon" href="/curriculum/favicon.ico"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/an-old-hope.min.css">
        <link rel="stylesheet" href="/curriculum/style.css"/>
        <script src="/curriculum/js/highlight.min.js"></script>
        <script src="/curriculum/js/bash.min.js"></script>
        <script src="/curriculum/js/java.min.js"></script>
        <script src="/curriculum/js/javascript.min.js"></script>
        <script src="/curriculum/js/sql.min.js"></script>
    </head>
    <body>
        <button 
            id="navigation-toggle"
            aria-expanded="false"
            aria-haspopup="true"
            onclick="toggleNav()"
            onkeydown="event => {event.keyCode === 13 ? toggleNav() : null}"
            tabindex="1">Table of contents</button>
        <nav id="navigation"><ul><details><summary>Bootcamp</summary><ul><details><summary>Unit 1 Object Oriented Programming</summary><ul><li><a href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.1-JavaScript_Objects_And_Functions.html">0.1.1 JavaScript Objects And Functions</a></li><li><a href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.2-Test_Driven_Development.html">0.1.2 Test Driven Development</a></li><li><a href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.3-Objects_in_an_Airport_Domain.html">0.1.3 Objects in an Airport Domain</a></li><li><a href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.4-Static_functions_and_properties.html">0.1.4 Static functions and properties</a></li><li><a href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.5-Inheritance.html">0.1.5 Inheritance</a></li><li><a href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.6-UML_Modelling.html">0.1.6 UML Modelling</a></li><li><a href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.7-OOP_Challenge.html">0.1.7 OOP Challenge</a></li><li><a href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.8-End_of_Unit_Quiz_OOP.html">0.1.8 End of Unit Quiz OOP</a></li></ul></details><details><summary>Unit 2 Asynchronous JavaScript</summary><ul><li><a href="/curriculum\Bootcamp\Unit-2-Asynchronous_JavaScript\0.2.1-Asynchronous_JavaScript.html">0.2.1 Asynchronous JavaScript</a></li><li><a href="/curriculum\Bootcamp\Unit-2-Asynchronous_JavaScript\0.2.2-Promises.html">0.2.2 Promises</a></li><li><a href="/curriculum\Bootcamp\Unit-2-Asynchronous_JavaScript\0.2.3-Asynchronous_Airport_Data_Load.html">0.2.3 Asynchronous Airport Data Load</a></li><li><a href="/curriculum\Bootcamp\Unit-2-Asynchronous_JavaScript\0.2.4-End_of_Unit_Quiz_Async.html">0.2.4 End of Unit Quiz Async</a></li></ul></details><details><summary>Unit 3 Relational Databases</summary><ul><li><a href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.1-Logical_Data_Model.html">0.3.1 Logical Data Model</a></li><li><a href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.10-Sequelize_part_2.html">0.3.10 Sequelize part 2</a></li><li><a href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.11-End_of_Unit_Quiz_Databases.html">0.3.11 End of Unit Quiz Databases</a></li><li><a href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.2-Introduction_to_Databases.html">0.3.2 Introduction to Databases</a></li><li><a href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.3-Basic_SQL_Commands.html">0.3.3 Basic SQL Commands</a></li><li><a href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.4-SQL_Joins.html">0.3.4 SQL Joins</a></li><li><a href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.5-Database_access_using_Node.html">0.3.5 Database access using Node</a></li><li><a href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.6-Populating_databases_from_JSON.html">0.3.6 Populating databases from JSON</a></li><li><a href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.7-Object_Relational_Mapping_part_1.html">0.3.7 Object Relational Mapping part 1</a></li><li><a href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.8-Object_Relational_Mapping_part_2.html">0.3.8 Object Relational Mapping part 2</a></li><li><a href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.9-Sequelize_part_1.html">0.3.9 Sequelize part 1</a></li></ul></details><details><summary>Unit 4 RESTful Servers</summary><ul><li><a href="/curriculum\Bootcamp\Unit-4-RESTful_Servers\0.4.1-Web_Servers.html">0.4.1 Web Servers</a></li><li><a href="/curriculum\Bootcamp\Unit-4-RESTful_Servers\0.4.2-Application_Servers.html">0.4.2 Application Servers</a></li><li><a href="/curriculum\Bootcamp\Unit-4-RESTful_Servers\0.4.3-Postman.html">0.4.3 Postman</a></li><li><a href="/curriculum\Bootcamp\Unit-4-RESTful_Servers\0.4.4-Route_Parameters.html">0.4.4 Route Parameters</a></li><li><a href="/curriculum\Bootcamp\Unit-4-RESTful_Servers\0.4.5-CRUD_operations.html">0.4.5 CRUD operations</a></li><li><a href="/curriculum\Bootcamp\Unit-4-RESTful_Servers\0.4.6-Server_side_Validation.html">0.4.6 Server side Validation</a></li><li><a href="/curriculum\Bootcamp\Unit-4-RESTful_Servers\0.4.7-End_of_Unit_Quiz_RESTful.html">0.4.7 End of Unit Quiz RESTful</a></li></ul></details><details><summary>Unit 5 Human Computer Interaction</summary><ul><li><a href="/curriculum\Bootcamp\Unit-5-Human_Computer_Interaction\0.5.1-Human_Computer_Interaction.html">0.5.1 Human Computer Interaction</a></li><li><a href="/curriculum\Bootcamp\Unit-5-Human_Computer_Interaction\0.5.2-Server_Side_Rendering.html">0.5.2 Server Side Rendering</a></li><li><a href="/curriculum\Bootcamp\Unit-5-Human_Computer_Interaction\0.5.3-The_Document_Object_Model.html">0.5.3 The Document Object Model</a></li><li><a href="/curriculum\Bootcamp\Unit-5-Human_Computer_Interaction\0.5.4-HTML_forms_and_lists.html">0.5.4 HTML forms and lists</a></li><li><a href="/curriculum\Bootcamp\Unit-5-Human_Computer_Interaction\0.5.5-End_of_Unit_Quiz_HCI.html">0.5.5 End of Unit Quiz HCI</a></li></ul></details><details><summary>Unit 6 End Of Bootcamp Group Project</summary><ul><li><a href="/curriculum\Bootcamp\Unit-6-End_Of_Bootcamp_Group_Project\0.6.1-Introduction.html">0.6.1 Introduction</a></li><li><a href="/curriculum\Bootcamp\Unit-6-End_Of_Bootcamp_Group_Project\0.6.2-Requirements.html">0.6.2 Requirements</a></li><li><a href="/curriculum\Bootcamp\Unit-6-End_Of_Bootcamp_Group_Project\0.6.3-Agile_Development.html">0.6.3 Agile Development</a></li><li><a href="/curriculum\Bootcamp\Unit-6-End_Of_Bootcamp_Group_Project\0.6.4-Design.html">0.6.4 Design</a></li><li><a href="/curriculum\Bootcamp\Unit-6-End_Of_Bootcamp_Group_Project\0.6.5-GitHub_Projects.html">0.6.5 GitHub Projects</a></li><li><a href="/curriculum\Bootcamp\Unit-6-End_Of_Bootcamp_Group_Project\0.6.6-Branching_and_Pull_Requests.html">0.6.6 Branching and Pull Requests</a></li><li><a href="/curriculum\Bootcamp\Unit-6-End_Of_Bootcamp_Group_Project\0.6.7-Deployment_with_Heroku.html">0.6.7 Deployment with Heroku</a></li></ul></details></ul></details><details><summary>Module 1</summary><ul><details><summary>Unit 1 Agile user requirements</summary><ul><li><a href="/curriculum\Module-1\Unit-1-Agile_user_requirements\1.1.1-Introduction_to_Agile.html">1.1.1 Introduction to Agile</a></li><li><a href="/curriculum\Module-1\Unit-1-Agile_user_requirements\1.1.2-Personas.html">1.1.2 Personas</a></li><li><a href="/curriculum\Module-1\Unit-1-Agile_user_requirements\1.1.3-User_Stories.html">1.1.3 User Stories</a></li><li><a href="/curriculum\Module-1\Unit-1-Agile_user_requirements\1.1.4-Requirements.html">1.1.4 Requirements</a></li><li><a href="/curriculum\Module-1\Unit-1-Agile_user_requirements\1.1.5-Next_Steps.html">1.1.5 Next Steps</a></li></ul></details><details><summary>Unit 2 Designing UI</summary><ul><li><a href="/curriculum\Module-1\Unit-2-Designing_UI\1.2.1-Usability_heuristics.html">1.2.1 Usability heuristics</a></li><li><a href="/curriculum\Module-1\Unit-2-Designing_UI\1.2.2-Composition_and_components_in_design.html">1.2.2 Composition and components in design</a></li><li><a href="/curriculum\Module-1\Unit-2-Designing_UI\1.2.3-Prototyping_UI.html">1.2.3 Prototyping UI</a></li><li><a href="/curriculum\Module-1\Unit-2-Designing_UI\1.2.4-Next_Steps.html">1.2.4 Next Steps</a></li></ul></details><details><summary>Unit 3 Building UI with a framework</summary><ul><li><a href="/curriculum\Module-1\Unit-3-Building_UI_with_a_framework\1.3-Welcome_to_Unit_3.html">1.3 Welcome to Unit 3</a></li><li><a href="/curriculum\Module-1\Unit-3-Building_UI_with_a_framework\1.3.1-Part_1_Getting_started_with_the_Vue_CDN.html">1.3.1 Part 1 Getting started with the Vue CDN</a></li><li><a href="/curriculum\Module-1\Unit-3-Building_UI_with_a_framework\1.3.2-Part_2_Vue_methods_and_computed_properties.html">1.3.2 Part 2 Vue methods and computed properties</a></li><li><a href="/curriculum\Module-1\Unit-3-Building_UI_with_a_framework\1.3.3-Part_3_Events_and_Adding_to_cart.html">1.3.3 Part 3 Events and Adding to cart</a></li><li><a href="/curriculum\Module-1\Unit-3-Building_UI_with_a_framework\1.3.4-Part_4_Introducing_routing_to_our_app.html">1.3.4 Part 4 Introducing routing to our app</a></li><li><a href="/curriculum\Module-1\Unit-3-Building_UI_with_a_framework\1.3.5-Part_5_Fixing_the_add_to_cart_event.html">1.3.5 Part 5 Fixing the add to cart event</a></li><li><a href="/curriculum\Module-1\Unit-3-Building_UI_with_a_framework\1.3.6-Part_6_Adding_the_product_details_page.html">1.3.6 Part 6 Adding the product details page</a></li><li><a href="/curriculum\Module-1\Unit-3-Building_UI_with_a_framework\1.3.7-Part_7_Integrating_Vuex_for_global_state_management.html">1.3.7 Part 7 Integrating Vuex for global state management</a></li><li><a href="/curriculum\Module-1\Unit-3-Building_UI_with_a_framework\1.3.8-Part_8_Consolidating_the_final_components.html">1.3.8 Part 8 Consolidating the final components</a></li></ul></details><details><summary>Unit 4 Accessibility</summary><ul><li><a href="/curriculum\Module-1\Unit-4-Accessibility\1.4.1-Inclusive_design.html">1.4.1 Inclusive design</a></li><li><a href="/curriculum\Module-1\Unit-4-Accessibility\1.4.2-Accessibility.html">1.4.2 Accessibility</a></li><li><a href="/curriculum\Module-1\Unit-4-Accessibility\1.4.3-Next_Steps.html">1.4.3 Next Steps</a></li></ul></details><details><summary>Unit 5 End to end testing</summary><ul><li><a href="/curriculum\Module-1\Unit-5-End_to_end_testing\1.5.1-End_to_end_testing.html">1.5.1 End to end testing</a></li><li><a href="/curriculum\Module-1\Unit-5-End_to_end_testing\1.5.2-Test_cases_and_equivalence_testing.html">1.5.2 Test cases and equivalence testing</a></li></ul></details></ul></details><details><summary>Module 2</summary><ul><details><summary>Unit 1 Securing RESTful APIs</summary><ul><li><a href="/curriculum\Module-2\Unit-1-Securing_RESTful_APIs\2.1.1-Designing_RESTful_APIs.html">2.1.1 Designing RESTful APIs</a></li><li><a href="/curriculum\Module-2\Unit-1-Securing_RESTful_APIs\2.1.2-What_makes_for_REST.html">2.1.2 What makes for REST</a></li><li><a href="/curriculum\Module-2\Unit-1-Securing_RESTful_APIs\2.1.3-Basic_Auth.html">2.1.3 Basic Auth</a></li><li><a href="/curriculum\Module-2\Unit-1-Securing_RESTful_APIs\2.1.4-Next_steps.html">2.1.4 Next steps</a></li></ul></details><details><summary>Unit 2 OAuth with OpenID Connect</summary><ul><li><a href="/curriculum\Module-2\Unit-2-OAuth_with_OpenID_Connect\2.2.1-Securing_with_OAuth.html">2.2.1 Securing with OAuth</a></li><li><a href="/curriculum\Module-2\Unit-2-OAuth_with_OpenID_Connect\2.2.2-Session_and_token_management.html">2.2.2 Session and token management</a></li><li><a href="/curriculum\Module-2\Unit-2-OAuth_with_OpenID_Connect\2.2.3-OpenID_Connect.html">2.2.3 OpenID Connect</a></li><li><a href="/curriculum\Module-2\Unit-2-OAuth_with_OpenID_Connect\2.2.4-API_Assignment.html">2.2.4 API Assignment</a></li></ul></details></ul></details><details><summary>Module 3</summary><ul><details><summary>Unit 1 The SDLC</summary><ul><li><a href="/curriculum\Module-3\Unit-1-The-SDLC\3.1.1-The_Software_Development_Life_Cycle.html">3.1.1 The Software Development Life Cycle</a></li><li><a href="/curriculum\Module-3\Unit-1-The-SDLC\3.1.2-The_roles_and_responsibilities_in_the_SDLC_with_communication.html">3.1.2 The roles and responsibilities in the SDLC with communication</a></li><li><a href="/curriculum\Module-3\Unit-1-The-SDLC\3.1.3-Communication_in_your_teams.html">3.1.3 Communication in your teams</a></li></ul></details><details><summary>Unit 2 The 7 Princibles of Testing</summary><ul><li><a href="/curriculum\Module-3\Unit-2-The-7-Princibles-of-Testing\3.2.1-The_7_Princibles_of_Testing.html">3.2.1 The 7 Princibles of Testing</a></li><li><a href="/curriculum\Module-3\Unit-2-The-7-Princibles-of-Testing\3.2.2-Continuous_Deployment.html">3.2.2 Continuous Deployment</a></li></ul></details><details><summary>Unit 3 Deployment and Maintenance</summary><ul><li><a href="/curriculum\Module-3\Unit-3-Deployment-and-Maintenance\3.3.1-Containerisation_with_docker.html">3.3.1 Containerisation with docker</a></li><li><a href="/curriculum\Module-3\Unit-3-Deployment-and-Maintenance\3.3.2-Introduction_to_Cloud_Computing.html">3.3.2 Introduction to Cloud Computing</a></li><li><a href="/curriculum\Module-3\Unit-3-Deployment-and-Maintenance\3.3.3-Monitoring_and_Maintenance.html">3.3.3 Monitoring and Maintenance</a></li></ul></details></ul></details><details><summary>Module 4</summary><ul><details><summary>Unit 1 Open Web Application Security Project</summary><ul><li><a href="/curriculum\Module-4\Unit-1-Open_Web_Application_Security_Project\4.1.1-Introduction_to_the_OWASP_Top_Ten.html">4.1.1 Introduction to the OWASP Top Ten</a></li><li><a href="/curriculum\Module-4\Unit-1-Open_Web_Application_Security_Project\4.1.2-Injection_Attacks.html">4.1.2 Injection Attacks</a></li><li><a href="/curriculum\Module-4\Unit-1-Open_Web_Application_Security_Project\4.1.3-Broken_Authentication.html">4.1.3 Broken Authentication</a></li><li><a href="/curriculum\Module-4\Unit-1-Open_Web_Application_Security_Project\4.1.3-Exposing_Sensitive_Data.html">4.1.3 Exposing Sensitive Data</a></li><li><a href="/curriculum\Module-4\Unit-1-Open_Web_Application_Security_Project\4.1.4-Monitoring_for_attacks.html">4.1.4 Monitoring for attacks</a></li><li><a href="/curriculum\Module-4\Unit-1-Open_Web_Application_Security_Project\4.1.5-The_role_of_a_Penetration_Tester.html">4.1.5 The role of a Penetration Tester</a></li><li><a href="/curriculum\Module-4\Unit-1-Open_Web_Application_Security_Project\4.1.6-Next_Steps.html">4.1.6 Next Steps</a></li></ul></details></ul></details></ul></nav>
        <h1>The Anatomy of the HTTP request</h1>
<h2>Overview</h2>
<p>At the end of this module you will be building a RESTful API that has both authentication and authorisation. We are going to build up to this final challenge in a gradual way. Our journey will begin today with the building block of RESTful apis - the Hyper Text Transfer Protocol (HTTP).</p>
<p>We are going to use <a href="https://www.postman.com/">Postman</a> to call some RESTful APIs and look in detail at the requests we send and responses we receive. Then we will look at performing these same requests using the browser's native <code>fetch</code> api.</p>
<hr>
<h2>Learning Objectives</h2>
<ul>
<li>Understand the different parts of the Hypertext Transfer Protocol (HTTP)</li>
<li>Understand the difference between HTTP and HTTPS</li>
<li>Understand the different HTTP verbs and which one is appropriate for modelling CRUD operations</li>
<li>Understand the most common HTTP response codes and how these indicate success or failure in RESTful operations</li>
<li>Become familiar with using Postman to call RESTful APIs</li>
</ul>
<h2>Pre-requisites</h2>
<ul>
<li>Install <a href="https://www.postman.com/">Postman</a></li>
</ul>
<h2>Lesson</h2>
<p><iframe src="https://docs.google.com/presentation/d/e/2PACX-1vSNpD9AFc2BFf28IAJhRKmcZeDXaleGpTEfKg7BsL4Y15rGJDbvwnQWbjcGWZ66xAF7IjurnF6DJCgG/embed" width="100%" height="444px" allowfullscreen frameborder=0></iframe></p>
<p>HTTP stands for the 'hyper text transfer protocol'. It is a protocol or 'way of doing things' which means if you meet a standard set of requirements you can implement HTTP in any language. Lets have a look at what goes into an HTTP request:</p>
<h3>Method (Verb)</h3>
<p>The method part of HTTP helps to communicate what this request is trying to do. The most commonly used verbs are GET &amp; POST.</p>
<table>
<thead>
<tr><th style="text-align:left">Method</th><th style="text-align:left">Function</th></tr>
</thead>
<tbody>
<tr><td style="text-align:left">GET</td><td style="text-align:left">to retrieve data</td></tr>
<tr><td style="text-align:left">POST</td><td style="text-align:left">to create data</td></tr>
<tr><td style="text-align:left">PUT</td><td style="text-align:left">to replace data</td></tr>
<tr><td style="text-align:left">PATCH</td><td style="text-align:left">to update data</td></tr>
<tr><td style="text-align:left">DELETE</td><td style="text-align:left">to remove data</td></tr>
</tbody>
</table>
<p>❓ Can you see how to select these in postman?</p>
<h3>Protocol</h3>
<p>This is the part at the very beginning of the request. <code>http://</code> this tells the browser we are making an http request. Protocols you might come across are:</p>
<ul>
<li><code>http://</code> - hyper text transfer protocol</li>
<li><code>https://</code> - secure hyper text transfer protocol (encrypted)</li>
<li><code>file://</code> - when you open a local file in your browser</li>
<li><code>ws://</code> - open a websocket</li>
<li><code>ftp://</code> - when you connect to a remote file server ftp stands for file transfer protocol</li>
<li><code>ipfs://</code> - the inter-planetary file system find out more about this at <a href="https://ipfs.io/">https://ipfs.io/</a></li>
</ul>
<h3>Host</h3>
<p>This is the address or place on the internet we are trying to reach. The host address (sometimes referred to as the domain address) of the HTTP request forms the main part of the address.</p>
<h3>Path</h3>
<p>This comes after the host address. This is the part of the address that is subject to the RESTful pattern. If we want to get all the albums from spotify then we would use the following address.</p>
<pre><code class="language-sh">https://api.spotify.com/v1/albums
</code></pre>
<ul>
<li><code>/v1/albums</code> - is the path</li>
<li><code>api.spotify.com</code> - is the host.</li>
</ul>
<h3>Parameters</h3>
<p>There are often variables that contribute toward a RESTful address. These are called parameters if they are included in the path. In the example above if we include the id number at the end of the path, we will be returned the album with that id. The id can be different and will relate to the resource that we want to access. In the example below we can compose an address using the album id <code>12345</code>, but if we wanted a different album we can change this.</p>
<pre><code class="language-sh">https://api.spotify.com/v1/albums/12345
</code></pre>
<p>❓ What is the difference between the path and parameters?</p>
<h3>Query parameters</h3>
<p>Query parameters can be added to the end of an address. Adding a <code>?</code> at the end of an address indicates that the following string is a list of key value pairs. In the example below after the '?' you should see a 'key' <code>artist</code> an equals <code>=</code> and then the 'value' <code>Frank%20Zappa</code> that makes a key=value pair. Look for the ampersand <code>&amp;</code> that separates the key value pairs. Query parameters must be encoded so there are no special characters or spaces. This encoding is called URIEncoding the best API in the browser to use for this is <code>window.encodeURIComponent</code>.</p>
<pre><code class="language-javascript"><span class="hljs-string">&quot;?artist=Frank Zappa&amp;album=Hot Rats&amp;track=Peaches Èn Ragalia&quot;</span> <span class="hljs-comment">// not URI encoded</span>
<span class="hljs-built_in">window</span>.encodeURIComponent(<span class="hljs-string">&quot;Peaches Èn Ragalia&quot;</span>) <span class="hljs-comment">// returns Peaches%20%C3%88n%20Ragalia</span>
<span class="hljs-string">&quot;?artist=Frank%20Zappa&amp;album=Hot%20Rats&amp;track=Peaches%20%C3%88n%20Ragalia&quot;</span> <span class="hljs-comment">// safe query string</span>
</code></pre>
<p>All this extra information will be included in the HTTP request. Query strings have a maximum size limit (specific to the browser) and therefore aren’t good for transmitting a large amount of information</p>
<p>❓ What are the 2 ways we can pass data in an HTTP request?</p>
<p>❓ What is the difference between a parameter and a query parameter?</p>
<h3>Body</h3>
<p>All HTTP requests can have a body. The body can contain different flavors of encoded data. In the table below you can see the following data encoded in different flavors:</p>
<pre><code class="language-javascript">{
    <span class="hljs-attr">artist</span>: <span class="hljs-string">&quot;Frank Zappa&quot;</span>,
    <span class="hljs-attr">album</span>: <span class="hljs-string">&quot;Hot Rats&quot;</span>,
    <span class="hljs-attr">track</span>: <span class="hljs-string">&quot;Peaches Èn Ragalia&quot;</span>
}
</code></pre>
<table>
<thead>
<tr><th style="text-align:left">flavor</th><th style="text-align:left">encoding</th></tr>
</thead>
<tbody>
<tr><td style="text-align:left">form-data</td><td style="text-align:left"><code>artist=Frank+Zappa&amp;album=Hot+Rats&amp;track=Peaches+%C3%88n+Ragalia</code></td></tr>
<tr><td style="text-align:left">x-www-form-urlencoded</td><td style="text-align:left"><code>artist=Frank%20Zappa&amp;album=Hot%20Rats&amp;track=Peaches%20%C3%88n%20Ragalia</code></td></tr>
<tr><td style="text-align:left">JSON string</td><td style="text-align:left"><code>&quot;{&quot;artist&quot;:&quot;Frank Zappa&quot;,&quot;album&quot;:&quot;Hot Rats&quot;,&quot;track&quot;:&quot;Peaches Èn Ragalia&quot;}&quot;</code></td></tr>
<tr><td style="text-align:left">XML</td><td style="text-align:left"><code>&quot;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;root&gt;&lt;artist&gt;Frank Zappa&lt;/artist&gt;&lt;album&gt;Hot Rats&lt;/album&gt;&lt;track&gt;Peaches Èn Ragalia&lt;/track&gt;&lt;/root&gt;&quot;</code></td></tr>
</tbody>
</table>
<p>There are more kinds of encoding for example binary which is for files but this is enough to be getting on with.</p>
<h3>Header</h3>
<p>The header is a very important part of the HTTP request. In the header you can pass all manor of meta information about the request. We will be putting authentication credentials in the header later on. For now we can focus on the <code>Content-Type</code>. Considering there are different ways we can encode the body content, we need to have a matching header that tells the receiver how to decode our body content. Without the body and Content-Type matching the server may error with a 406 &quot;Not Acceptable&quot; status code (we will look at status codes later).</p>
<p>Here is a list of all the different <code>Content-Type</code>s that are supported: <a href="https://www.iana.org/assignments/media-types/media-types.xhtml">https://www.iana.org/</a></p>
<p>❓ In postman can you see where to set a header?</p>
<p>❓ Can you match the correct content types to the table of encodings above?</p>
<h3>Response</h3>
<p>The response object is similar to the request object. The main difference is a response will have a status code property. It is the responsibility of the developers building and maintaining a service to set the correct status code for a response before sending it back to the client.</p>
<table>
<thead>
<tr><th style="text-align:left">Range</th><th style="text-align:left">Status</th></tr>
</thead>
<tbody>
<tr><td style="text-align:left">100 - 103</td><td style="text-align:left">Informational response</td></tr>
<tr><td style="text-align:left">200 - 226</td><td style="text-align:left">Success</td></tr>
<tr><td style="text-align:left">300 - 308</td><td style="text-align:left">Redirection</td></tr>
<tr><td style="text-align:left">400 - 451</td><td style="text-align:left">Client Errors</td></tr>
<tr><td style="text-align:left">500 - 598</td><td style="text-align:left">Server Errors</td></tr>
</tbody>
</table>
<p>Read through the <a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">HTTP Status codes</a> so you know how to handle HTTP responses like a boss.</p>
<h2>Assignment</h2>
<p>Below is a URL. Can you make an HTTP request to that URL using <a href="https://www.postman.com/">postman</a>? Read the instructions that you get back from the server as each response is a different challenge piece that will lead to a final puzzle on https://applied.multiverse.io.</p>
<ol>
<li>Make a GET request to https://http-challenge.multiverse-coaches.io</li>
<li>Follow the instructions you receive from the response</li>
</ol>
<h1>REST and the openAPI spec</h1>
<h2>Overview</h2>
<p>Today we are going to focus on creating and using RESTful APIs. Yesterday we looked at the anatomy of an HTTP request and response. Today we will build on that knowledge and look at the most popular way to organise accessing resources using HTTP.</p>
<hr>
<h2>Learning Objectives</h2>
<ul>
<li>Connect the correct HTTP verbs to RESTful operations</li>
<li>Implement the OpenAPI specification</li>
</ul>
<h2>Pre-requisites</h2>
<ul>
<li>Knowledge of HTTP requests see <a href="https://multiverselearningproducts.github.io/curriculum/Module-2/Unit-1-The_Anatomy_of_the_HTTP_request/2.1.1-Identifying_the_different_parts_of_HTTP.html">2.1.1</a> and <a href="https://multiverselearningproducts.github.io/curriculum/Module-2/Unit-1-The_Anatomy_of_the_HTTP_request/2.1.2-Programmatic_HTTP_requests.html">2.1.2</a></li>
<li><a href="https://raw.githubusercontent.com/WhiteHatLearningProducts/airports/master/airportsData.json">airports.json</a> (airport data)</li>
</ul>
<h2>What is RESTful</h2>
<p>REST is a shortened form of &quot;<u>RE</u>presentative <u>S</u>tate <u>T</u>ransfer&quot;.</p>
<blockquote>
<p>REST is an architectural style for providing standards between computer systems on the web, making it easier for systems to communicate with each other.</p>
</blockquote>
<p>Before REST was first proposed in a <a href="https://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm">dissertation by Roy Thomas Fielding</a> servers implemented their own endpoints named in ways that different development teams saw fit. For example one application might have an endpoint called <code>/getUsers</code> another might call it <code>/allUsers</code> there was no agreed path name for fetching all users from an endpoint.</p>
<p>REST introduced a standard way to address resources on a server which made it much easier for other services to discover and use those resources.</p>
<blockquote>
<p>This is achieved by placing constraints on connector semantics where other styles have focused on component semantics. <small><i>Roy Thomas Fielding</i></small></p>
</blockquote>
<p>Today REST is widely implemented across the internet and we are going to learn about how to read and create our own RESTful web services.</p>
<p>There are 2 aspects to RESTful architectures.</p>
<ol>
<li>Using the right VERBS in your request</li>
<li>Using the right path for your resources</li>
</ol>
<h3>VERBS/METHODS</h3>
<p>Built into the HTTP spec are the http 'methods' or 'verbs'. <code>GET</code> <code>POST</code> <code>PATCH</code> <code>PUT</code> <code>DELETE</code> <em>(there are more these are the main ones)</em> one fundamental concept in REST is that these verbs should be used for particular operations. For example we might have a resource <code>/albums</code>; to read all the albums we would make an http request and use the <code>GET</code> method. If we wanted to add a new album we would make an http request to the <u>same</u> address <code>/albums</code> but use the <code>POST</code> method and include data in the body of the request. The method indicates the kind of operation that will be performed for that resource; reading with <code>GET</code> or creating with <code>POST</code>. We CAN make a <code>GET</code> request with a body and create a new <code>/albums</code> resource BUT that would not be RESTful.</p>
<h3>Resources</h3>
<p>A 'resource' some thing we want to access or interact with is also a fundamental concept in REST. Usually this is our service or data. For example on Spotify albums are a resource; so are artists and playlists. There is a standard set of paths used to interact with any resource:</p>
<table>
<thead>
<tr><th>HTTP Method</th><th>URL</th><th>Status code</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>GET</td><td><code>/albums</code></td><td>200</td><td>return all the albums (resources are always plural)</td></tr>
<tr><td>POST</td><td><code>/albums</code></td><td>201</td><td>create a new album</td></tr>
<tr><td>GET</td><td><code>/albums/{id}</code></td><td>200</td><td>return the album with the id specified in the URL</td></tr>
<tr><td>PUT</td><td><code>/albums/{id}</code></td><td>[200,204]</td><td>Replace the album with a new one, but keep the id</td></tr>
<tr><td>PATCH</td><td><code>/albums/{id}</code></td><td>[200,202,204]</td><td>Update 1 or more of the album's properties</td></tr>
<tr><td>DELETE</td><td><code>/albums/{id}</code></td><td>[200,202,204]</td><td>delete the album with the id specified in the URL</td></tr>
</tbody>
</table>
<p>Nested resources simple extend the same pattern.</p>
<table>
<thead>
<tr><th>HTTP Method</th><th>URL</th><th>Status code</th><th>Description</th></tr>
</thead>
<tbody>
<tr><td>GET</td><td><code>/albums/{id}/tracks</code></td><td>200</td><td>return the tracks for the album with the id specified in the URL</td></tr>
<tr><td>POST</td><td><code>/albums/{id}/tracks</code></td><td>201</td><td>create a new track for the album with the id specified in the URL</td></tr>
<tr><td>GET</td><td><code>/albums/{album_id}/tracks/{track_id}</code></td><td>200</td><td>return the track with the id specified in the URL from the album with the id specified in the URL</td></tr>
</tbody>
</table>
<p>Can you see the pattern?</p>
<p>❓ How might you update a track for a given album?</p>
<p>❓ Can you match the CRUD operations to http methods?</p>
<p>You might wonder why can't I just reference a track with the URL below?</p>
<table>
<thead>
<tr><th style="text-align:left">URL</th><th style="text-align:center">VERB</th><th style="text-align:left">Resource</th></tr>
</thead>
<tbody>
<tr><td style="text-align:left"><code>/tracks/{track_id}</code></td><td style="text-align:center">GET</td><td style="text-align:left">return the track with the id specified in the URL</td></tr>
</tbody>
</table>
<p>You can address a single track resource. However we are not capturing the relationship between this resource and the album resource that it belongs to. Often you will need to redirect back to a route that requires you to identify which album the track belongs to. The nested RESTful pattern helps you to do this cleanly in your controllers. REST is just a convention or as Roy Thomas Fielding put it 'connector semantics'.</p>
<h3>Documentation</h3>
<p>You will often find yourself consuming 3rd party APIs. Consider these 2 RESTful fundamentals; verbs and paths. We can expect to see these 2 things in most RESTful APIs. How quickly and easily it is to integrate with 3rd party APIs is largely down to the quality of their documentation. Often documentation is generated from the API code itself. This is a popular way to document APIs. Have a look at the examples of online generated API documentation below:</p>
<ul>
<li><a href="https://docs.github.com/en/free-pro-team@latest/rest/reference/repos">Github</a></li>
<li><a href="https://www.dropbox.com/developers/documentation/http/documentation#sharing-list_folders">Dropbox</a></li>
<li><a href="https://www.twilio.com/docs/usage/bulkexport/job#fetch-a-job-resource">Twilio</a></li>
<li><a href="https://developer.twitter.com/en/docs/twitter-api/tweets/lookup/api-reference/get-tweets">Twitter</a></li>
<li><a href="https://developer.spotify.com/documentation/web-api/reference-beta/#endpoint-get-multiple-albums">Spotify</a></li>
<li><a href="https://app.swaggerhub.com/apis-docs/tg4solutions/the-sneaker-database/1.0.0">The Sneaker Database</a></li>
</ul>
<h2>Assignment</h2>
<p>❓ What are the common elements you can identify in each of the API documentation sites above?</p>
<p>❓ There are quite a few albums on Spotify and we can't actually <code>GET</code> all of them. What is the mechanism Spotify have used to limit the albums you can request?</p>
<p>❓ Why do you think auto generated documentation is a popular choice for dev teams who create and maintain public facing APIs?</p>
<h3>Assignment extension tasks</h3>
<p>How are the APIs above versioned? What is rate limiting and why might it be important?</p>
<hr>
<h1>The OpenAPI spec</h1>
<h2>Overview</h2>
<p>OpenAPI was originally part of the Swagger framework. Swagger became very popular and the developer community embraced the specification, it has  become a recognised standard used across the industry. OpenAPI became a separate project in 2016, overseen by the OpenAPI Initiative, an open-source collaboration project of the Linux Foundation.</p>
<h2>Learning Objectives</h2>
<ul>
<li>Implement the OpenAPI specification</li>
</ul>
<h2>Pre-requisites</h2>
<ul>
<li>You should know what the HTTP verbs are see <a href="https://multiverselearningproducts.github.io/curriculum/Module-2/Unit-2-What_is_REST/2.2.1-REST_and_the_openAPI_spec.html">2.2.1</a></li>
</ul>
<h2>Lesson</h2>
<p>Lets use <a href="https://www.openapis.org/">OpenAPI</a>/<a href="https://swagger.io/">Swagger</a> to define our API in a standard structure. There are lots of benefits from becoming familiar with this standard.</p>
<ul>
<li>You will become confident and familiar will all the things you need to consider when you design your own API endpoints.</li>
<li>Other developers will be able to integrate with your API easily.</li>
<li>Other tools can read the information about your API from the OpenAPI standard structure and generate web based documentation for you!</li>
</ul>
<p>Below is a starter example of an OpenAPI <code>airports-config.yaml</code> file. Note that YAML editors are often very picky about having correct spacing and indentation!</p>
<pre><code class="language-yaml"><span class="hljs-attr">openapi:</span> <span class="hljs-number">3.0</span><span class="hljs-number">.0</span>
<span class="hljs-attr">info:</span>
  <span class="hljs-attr">title:</span> <span class="hljs-string">Airports</span> <span class="hljs-string">API</span>
  <span class="hljs-attr">description:</span> <span class="hljs-string">Get</span> <span class="hljs-string">all</span> <span class="hljs-string">your</span> <span class="hljs-string">airport</span> <span class="hljs-string">data</span> <span class="hljs-string">here</span> <span class="hljs-string">https://raw.githubusercontent.com/WhiteHatLearningProducts/airports/master/airportsData.json</span> 
  <span class="hljs-attr">version:</span> <span class="hljs-number">1.0</span><span class="hljs-number">.0</span>
<span class="hljs-attr">servers:</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">url:</span> <span class="hljs-string">http://localhost:3000</span>
    <span class="hljs-attr">description:</span> <span class="hljs-string">if</span> <span class="hljs-string">you</span> <span class="hljs-string">are</span> <span class="hljs-string">using</span> <span class="hljs-string">NodeJS</span> <span class="hljs-string">your</span> <span class="hljs-string">dev</span> <span class="hljs-string">port</span> <span class="hljs-string">might</span> <span class="hljs-string">be</span> <span class="hljs-number">3000</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">url:</span> <span class="hljs-string">http://localhost:8080</span>
    <span class="hljs-attr">description:</span> <span class="hljs-string">if</span> <span class="hljs-string">you</span> <span class="hljs-string">are</span> <span class="hljs-string">using</span> <span class="hljs-string">Spring</span> <span class="hljs-string">your</span> <span class="hljs-string">dev</span> <span class="hljs-string">port</span> <span class="hljs-string">will</span> <span class="hljs-string">be</span> <span class="hljs-number">8080</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">url:</span> <span class="hljs-string">https://airports-api.whitehatcoaches.org.uk</span>
    <span class="hljs-attr">description:</span> <span class="hljs-string">this</span> <span class="hljs-string">is</span> <span class="hljs-string">the</span> <span class="hljs-string">production</span> <span class="hljs-string">baseURL</span>
<span class="hljs-attr">paths:</span>
  <span class="hljs-string">/airports:</span>
    <span class="hljs-attr">get:</span>
      <span class="hljs-attr">summary:</span> <span class="hljs-string">Returns</span> <span class="hljs-string">a</span> <span class="hljs-string">list</span> <span class="hljs-string">of</span> <span class="hljs-string">all</span> <span class="hljs-string">the</span> <span class="hljs-string">airports</span>
      <span class="hljs-attr">description:</span> <span class="hljs-string">|
        blar blar 28,000 airports etc
</span>
        <span class="hljs-string">*</span> <span class="hljs-string">you</span> <span class="hljs-string">can</span> <span class="hljs-string">also</span> <span class="hljs-string">use</span>
        <span class="hljs-string">*</span> <span class="hljs-string">markdown</span> <span class="hljs-string">in</span> <span class="hljs-string">this</span> <span class="hljs-string">section</span>

        <span class="hljs-type">![airport](https://twistedsifter.com/wp</span><span class="hljs-string">-content/uploads/2014/11/mexico-city-international-airport-drone-video.jpg)</span>

        <span class="hljs-string">Including</span> <span class="hljs-string">images!</span>
      <span class="hljs-attr">responses:</span>
        <span class="hljs-attr">200:</span>
          <span class="hljs-attr">description:</span> <span class="hljs-string">an</span> <span class="hljs-string">array</span> <span class="hljs-string">of</span> <span class="hljs-string">JSON</span> <span class="hljs-string">objects</span> <span class="hljs-string">that</span> <span class="hljs-string">represent</span> <span class="hljs-string">each</span> <span class="hljs-string">airport</span>
          <span class="hljs-attr">content:</span>
            <span class="hljs-attr">application/json:</span>
              <span class="hljs-attr">schema:</span>
                <span class="hljs-attr">type:</span> <span class="hljs-string">array</span>
                <span class="hljs-attr">items:</span>
                  <span class="hljs-attr">type:</span> <span class="hljs-string">object</span>
                  <span class="hljs-attr">properties:</span>
                    <span class="hljs-attr">icao:</span>
                      <span class="hljs-attr">type:</span> <span class="hljs-string">string</span>
                    <span class="hljs-attr">iata:</span>
                      <span class="hljs-attr">type:</span> <span class="hljs-string">string</span>
                    <span class="hljs-attr">name:</span>
                      <span class="hljs-attr">type:</span> <span class="hljs-string">string</span>
                    <span class="hljs-attr">city:</span>
                      <span class="hljs-attr">type:</span> <span class="hljs-string">string</span>
                    <span class="hljs-attr">state:</span>
                      <span class="hljs-attr">type:</span> <span class="hljs-string">string</span>
                    <span class="hljs-attr">country:</span>
                      <span class="hljs-attr">type:</span> <span class="hljs-string">string</span>
                    <span class="hljs-attr">elevation:</span>
                      <span class="hljs-attr">type:</span> <span class="hljs-string">integer</span>
                    <span class="hljs-attr">lat:</span>
                      <span class="hljs-attr">type:</span> <span class="hljs-string">number</span>
                      <span class="hljs-attr">format:</span> <span class="hljs-string">double</span>
                    <span class="hljs-attr">lon:</span>
                      <span class="hljs-attr">type:</span> <span class="hljs-string">number</span>
                      <span class="hljs-attr">format:</span> <span class="hljs-string">double</span>
                    <span class="hljs-attr">tz:</span>
                      <span class="hljs-attr">type:</span> <span class="hljs-string">string</span>
                  <span class="hljs-attr">example:</span>
                    <span class="hljs-attr">icao:</span> <span class="hljs-string">&quot;00AK&quot;</span>
                    <span class="hljs-attr">iata:</span> <span class="hljs-string">&quot;&quot;</span>
                    <span class="hljs-attr">name:</span> <span class="hljs-string">&quot;Lowell Field&quot;</span>
                    <span class="hljs-attr">city:</span> <span class="hljs-string">&quot;Anchor Point&quot;</span>
                    <span class="hljs-attr">state:</span> <span class="hljs-string">&quot;Alaska&quot;</span>
                    <span class="hljs-attr">country:</span> <span class="hljs-string">&quot;US&quot;</span>
                    <span class="hljs-attr">elevation:</span> <span class="hljs-number">450</span>
                    <span class="hljs-attr">lat:</span> <span class="hljs-number">59.94919968</span>
                    <span class="hljs-attr">lon:</span> <span class="hljs-number">-151.695999146</span>
                    <span class="hljs-attr">tz:</span> <span class="hljs-string">&quot;America/Anchorage&quot;</span>
</code></pre>
<p>You can upload this to a site like <a href="https://swagger.io/tools/swaggerhub">SwaggerHub</a>, <a href="https://readme.com/">readme.com</a> (or use a <a href="https://multiverselearningproducts.github.io/swe/api-example.yaml">url</a>) and generate a page of documentation like the ones we have looked at above.</p>
<p><figure><img src="https://user-images.githubusercontent.com/4499581/104598397-712b8180-566e-11eb-97b3-05f2c0d577b5.png" alt="a page of OpenAPI markup rendered as a webpage"><figcaption></figcaption></figure></p>
<h2>Assignment</h2>
<p>In an OpenAPI <code>airports-config.yaml</code> file create a complete set of documented RESTful endpoints for the <code>/airports</code> resource. The resource we can use is the Airports we used in the first 5 week bootcamp. You can look up the specification for <a href="https://swagger.io/resources/open-api/">openapi here</a>. We want routes to create, read (all airports and a single airport), update and delete;</p>
<p>You might find this <a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">list of HTTP status codes</a> useful when defining your endpoint's responses.</p>
<p>Once you have got your <code>airports-config.yaml</code> file completed you can even have a go at generating a server from that definition. <a href="https://swagger.io/tools/swaggerhub">SwaggerHub</a> provides an <code>Export-&gt;Server Stub</code> option which generates a stub implementation in a language of your choice. Alternatively you can use the instructions below to generate this manually using javascript or java.</p>
<p>|Javascript|Java|</p>
<pre><code class="language-javascript"><span class="hljs-comment">/**
* npm install -g swagger-node-codegen
* snc airports_config.yaml -o airports-node
* cd into the airports-node folder and start the server with npm start
*/</span>

npm start
</code></pre>
<pre><code class="language-java"><span class="hljs-comment">/*
  download swagger-codegen-cli-3.0.24.jar from https://repo1.maven.org/maven2/io/swagger/codegen/v3/swagger-codegen-cli/3.0.24/swagger-codegen-cli-3.0.24.jar

  in the same folder create a config.json file with the following as its contents:

  {
    &quot;basePackage&quot;: &quot;org.multiverse&quot;,
    &quot;configPackage&quot;: &quot;org.multiverse.app.config&quot;
  }

  now run the command below

  java -jar swagger-codegen-cli-3.0.24.jar generate \
    -i $PWD/airports-config.yaml \
    -l spring \
    -o airports-java \
    -c $PWD/config.json \
    -DhideGenerationTimestamp=true
*/</span>
</code></pre>
<p>Be ready to demo your generated server and share your <code>airports-config.yaml</code> file with your coach.</p>
<hr>
<h1>Build your own openAPI RESTful service</h1>
<h2>Learning Objectives</h2>
<ul>
<li>Produce an API server with integrated documentation</li>
<li>Implement CRUD operations on a single resource using RESTful endpoints</li>
</ul>
<h2>Pre-requisites</h2>
<ul>
<li>You will need a valid <code>airports-config.yaml</code> openAPI definition file see <a href="https://multiverselearningproducts.github.io/curriculum/Module-2/Unit-2-What_is_REST/2.2.2-The_OpenAPI_spec.html">2.2.2</a>.</li>
</ul>
<h2>Lesson</h2>
<p>Auto generated code is all very well, but you also need to know how to build your own RESTful service. In this session we are going to build our service from the ground up and practice defining RESTful routes for ourselves. You will be integrating OpenAPI documentation using swagger. There are a few steps below to get you started. If you would like to build your server in another language like PHP or C# you are very welcome to do so. You might need to look online for instructions to perform the following steps for the framework you are using. i.e. for PHP you can use <a href="https://symfony.com/">Symfony</a>.</p>
<h3>Dependencies</h3>
<p>First of all find and install the dependencies your server is going to need to create auto generated documentation.</p>
<p>|Javascript|Java|</p>
<pre><code class="language-javascript">{
  <span class="hljs-string">&quot;name&quot;</span>: <span class="hljs-string">&quot;airports&quot;</span>,
  <span class="hljs-string">&quot;version&quot;</span>: <span class="hljs-string">&quot;1.0.0&quot;</span>,
  <span class="hljs-string">&quot;description&quot;</span>: <span class="hljs-string">&quot;Use this package.json to start your assignment&quot;</span>,
  <span class="hljs-string">&quot;main&quot;</span>: <span class="hljs-string">&quot;index.js&quot;</span>,
  <span class="hljs-string">&quot;scripts&quot;</span>: {
    <span class="hljs-string">&quot;start&quot;</span>: <span class="hljs-string">&quot;node server.js&quot;</span>
  },
  <span class="hljs-string">&quot;author&quot;</span>: <span class="hljs-string">&quot;your Github username can go here&quot;</span>,
  <span class="hljs-string">&quot;license&quot;</span>: <span class="hljs-string">&quot;ISC&quot;</span>,
  <span class="hljs-string">&quot;dependencies&quot;</span>: {
    <span class="hljs-string">&quot;express&quot;</span>: <span class="hljs-string">&quot;^4.17.1&quot;</span>,
    <span class="hljs-string">&quot;swagger-jsdoc&quot;</span>: <span class="hljs-string">&quot;^6.0.1&quot;</span>,
    <span class="hljs-string">&quot;swagger-ui-express&quot;</span>: <span class="hljs-string">&quot;^4.1.6&quot;</span>,
    <span class="hljs-string">&quot;js-yaml&quot;</span>: <span class="hljs-string">&quot;^4.0.0&quot;</span>
  }
}
</code></pre>
<pre><code class="language-java">/*
  Goto https://start.spring.io and generate a project with the group &#x27;org.whitehat&#x27; and package name &#x27;org.whitehat.airports&#x27; that includes &#x27;Spring Boot Web&#x27; as a dependency. Once you have downloaded and unzipped your project, add the following dependencies to your `pom.xml` file (in the `&lt;dependencies&gt;` list).  
*/
        &lt;dependency&gt;
            &lt;groupId&gt;org.springdoc&lt;/groupId&gt;
            &lt;artifactId&gt;springdoc-openapi-ui&lt;/artifactId&gt;
            &lt;version&gt;1.5.2&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;com.googlecode.json-simple&lt;/groupId&gt;
            &lt;artifactId&gt;json-simple&lt;/artifactId&gt;
            &lt;version&gt;1.1.1&lt;/version&gt;
        &lt;/dependency&gt;

        &lt;dependency&gt;
            &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;
            &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;
            &lt;version&gt;2.11.1&lt;/version&gt;
        &lt;/dependency&gt;
</code></pre>
<h3>Configuration</h3>
<p>The next step is to configure your server to create API documentation from your code. Previously we used the OpenAPI yaml file to describe our routes, but that method means we would have to keep updating the config yaml file if we made changes to the endpoint. Instead now we are going to use swagger to generate docs NOT from a yaml file - but from the actual code itself. You can remove the <code>paths</code> property from your yaml file.</p>
<p>|Javascript|Java|</p>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>)
<span class="hljs-keyword">const</span> app = express()
<span class="hljs-keyword">const</span> swaggerUi = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;swagger-ui-express&#x27;</span>)
<span class="hljs-keyword">const</span> airports = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;./airports.json&#x27;</span>)
<span class="hljs-keyword">const</span> YAML = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;js-yaml&#x27;</span>)
<span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;fs&#x27;</span>)
<span class="hljs-keyword">const</span> docs = YAML.load(fs.readFileSync(<span class="hljs-string">&#x27;./airports-config.yaml&#x27;</span>).toString())
<span class="hljs-keyword">const</span> swaggerDocs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;swagger-jsdoc&#x27;</span>)({
    <span class="hljs-attr">swaggerDefinition</span>: docs,
    <span class="hljs-attr">apis</span>: [<span class="hljs-string">&#x27;./server.js&#x27;</span>]
})

app.use(<span class="hljs-string">&#x27;/api-docs&#x27;</span>, swaggerUi.serve, swaggerUi.setup(swaggerDocs, {<span class="hljs-attr">explorer</span>: <span class="hljs-literal">true</span>}))

app.listen(<span class="hljs-number">3000</span>, <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&quot;Airport API ready. Documents at http://localhost:3000/api-docs&quot;</span>))
</code></pre>
<pre><code class="language-java"><span class="hljs-comment">// in a file named AirportsApplication.java</span>
<span class="hljs-keyword">package</span> org.whitehat.airports;

<span class="hljs-keyword">import</span> org.springframework.beans.factory.annotation.Value;
<span class="hljs-keyword">import</span> org.springframework.boot.SpringApplication;
<span class="hljs-keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;
<span class="hljs-keyword">import</span> org.springframework.context.annotation.Bean;

<span class="hljs-keyword">import</span> io.swagger.v3.oas.models.OpenAPI;
<span class="hljs-keyword">import</span> io.swagger.v3.oas.models.info.Info;
<span class="hljs-keyword">import</span> io.swagger.v3.oas.models.servers.Server;

<span class="hljs-meta">@SpringBootApplication</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AirportsApplication</span> </span>{

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>{
        SpringApplication.run(AirportsApplication.class, args);
    }

    <span class="hljs-meta">@Bean</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> OpenAPI <span class="hljs-title">customOpenAPI</span><span class="hljs-params">(<span class="hljs-meta">@Value(&quot;${springdoc.version}&quot;)</span> String appVersion)</span> </span>{

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> OpenAPI()
            .info(<span class="hljs-keyword">new</span> Info()
                .title(<span class="hljs-string">&quot;Airports&quot;</span>)
                .version(appVersion)
                .description(<span class="hljs-string">&quot;28,000 airports&quot;</span>)
            )
            .addServersItem(<span class="hljs-keyword">new</span> Server().url(<span class="hljs-string">&quot;http://localhost:8080/&quot;</span>))
            .addServersItem(<span class="hljs-keyword">new</span> Server().url(<span class="hljs-string">&quot;https://api.whitehatcoaches.org.uk/&quot;</span>));
    }
}


<span class="hljs-comment">/****** ADDITIONAL CONFIG ******
in /src/main/resources/application.properties
  springdoc.swagger-ui.path=/api-docs
  springdoc.version=1.0.0
*/</span>

<span class="hljs-comment">// Access the API at `http://localhost:8080/api-docs`</span>
</code></pre>
<h3>Auto Document Paths</h3>
<p>Now we can start to annotate our routes to support Swagger auto documenting our paths. Note that Swagger will read the Spring annotations to determine paths.</p>
<p>|Javascript|Java|</p>
<pre><code class="language-javascript"><span class="hljs-comment">// server.js</span>
<span class="hljs-comment">/**
 * <span class="hljs-doctag">@swagger</span>
 * /airports:
 *   get:
 *     summary: returns an array of airports
 *     responses:
 *       200:
 *         description: all the airports
 *         content:
 *           application/json:
 *             schema:
 *               type: array
 *               items:
 *                 properties:
 *                   icao:
 *                     type: string
 *                   iata:
 *                     type: string
 *                   name:
 *                     type: string
 *                   city:
 *                     type: string
 *                   state:
 *                     type: string
 *                   country:
 *                     type: string
 *                   elevation:
 *                     type: integer
 *                   lat:
 *                     type: float
 *                   lon:
 *                     type: float
 *                   tz:
 *                     type: string
 *                 example:
 *                   icao: &quot;00AK&quot;
 *                   iata: &quot;&quot;
 *                   name: &quot;Lowell Field&quot;
 *                   city: &quot;Anchor Point&quot;
 *                   state: &quot;Alaska&quot;
 *                   country: &quot;US&quot;
 *                   elevation: 450
 *                   lat: 59.94919968
 *                   lon: -151.695999146
 *                   tz: &quot;America/Anchorage&quot;                 
 */</span>
app.get(<span class="hljs-string">&#x27;/airports&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    res.send(airports)
})
</code></pre>
<pre><code class="language-java"><span class="hljs-keyword">package</span> org.whitehat.airports;

<span class="hljs-keyword">import</span> java.io.IOException;
<span class="hljs-keyword">import</span> java.io.InputStream;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">import</span> com.fasterxml.jackson.core.type.TypeReference;
<span class="hljs-keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;

<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.GetMapping;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;
<span class="hljs-keyword">import</span> org.springframework.web.bind.annotation.RestController;

<span class="hljs-meta">@RestController</span>
<span class="hljs-meta">@RequestMapping(&quot;/airports&quot;)</span>
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AirportsController</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> List&lt;Airport&gt; airports;

    <span class="hljs-keyword">static</span> {
        <span class="hljs-comment">// next line is using the Try-With-Resource syntax to ensure that the</span>
        <span class="hljs-comment">// input stream gets closed (very important else get memory leaks!)</span>
        <span class="hljs-keyword">try</span> (InputStream is = AirportsController.class.getResourceAsStream(<span class="hljs-string">&quot;/static/airports.json&quot;</span>);){
            ObjectMapper mapper = <span class="hljs-keyword">new</span> ObjectMapper();

            airports = mapper.readValue(is, <span class="hljs-keyword">new</span> TypeReference&lt;List&lt;Airport&gt;&gt;() {
            });
        } <span class="hljs-keyword">catch</span>(IOException e) {
            e.printStackTrace();
        }

    }
    
    <span class="hljs-meta">@GetMapping(&quot;/&quot;)</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Airport&gt; <span class="hljs-title">getAirports</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> AirportsController.airports;
    }

    <span class="hljs-comment">// You can build out the rest of the endpoints</span>
    <span class="hljs-comment">// just a heads-up http://localhost:8080/airports/ remember the trailing slash.</span>
    <span class="hljs-comment">// Because Java is strongly typed swagger will to most of the work to document your endpoint - you can add extra information (go see the docs https://springdoc.org/)</span>
}
</code></pre>
<p>in <em>javascript</em> You can use schemas to save yourself repeating the definition of an <code>Airport</code>. If you create a class definition for an Airport you can annotate it then reference it in your route annotations. i.e. in an <code>Airport.js</code> file you can define your airport:</p>
<pre><code class="language-javascript"><span class="hljs-comment">/**
 * <span class="hljs-doctag">@swagger</span>
 *   components:
 *     schemas:
 *       Airport:
 *         type: object
 *         properties:
 *           icao:
 *             type: string
 *           iata:
 *             type: string
 *           name:
 *             type: string
 *           city:
 *             type: string
 *           state:
 *             type: string
 *           country:
 *             type: string
 *           elevation:
 *             type: integer
 *           lat:
 *             type: float
 *           lon:
 *             type: float
 *           tz:
 *             type: string
 *         example:
 *           icao: &quot;00AK&quot;
 *           iata: &quot;&quot;
 *           name: &quot;Lowell Field&quot;
 *           city: &quot;Anchor Point&quot;
 *           state: &quot;Alaska&quot;
 *           country: &quot;US&quot;
 *           elevation: 450
 *           lat: 59.94919968
 *           lon: -151.695999146
 *           tz: &quot;America/Anchorage&quot;
 */</span>

<span class="hljs-built_in">module</span>.exports = <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Airport</span> </span>{
    icao = <span class="hljs-string">&quot;&quot;</span>
    iata = <span class="hljs-string">&quot;&quot;</span>
    name = <span class="hljs-string">&quot;&quot;</span>
    city = <span class="hljs-string">&quot;&quot;</span>
    state = <span class="hljs-string">&quot;&quot;</span>
    country = <span class="hljs-string">&quot;&quot;</span>
    elevation = <span class="hljs-number">0</span>
    lat = <span class="hljs-number">0.0</span>
    lon = -<span class="hljs-number">0.0</span>
    tz = <span class="hljs-string">&quot;&quot;</span>

    <span class="hljs-title">constructor</span> (<span class="hljs-params">data</span>) {
        <span class="hljs-built_in">Object</span>.assign(<span class="hljs-built_in">this</span>, data)
    }
}
</code></pre>
<p>Then this can be referenced in your route definitions like this (you also have to reference the file in the <code>swagger-jsdoc</code> config):</p>
<pre><code class="language-javascript"><span class="hljs-keyword">const</span> swaggerDocs = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;swagger-jsdoc&#x27;</span>)({
    <span class="hljs-attr">swaggerDefinition</span>: docs,
    <span class="hljs-attr">apis</span>: [<span class="hljs-string">&#x27;./server.js&#x27;</span>, <span class="hljs-string">&#x27;./Airport.js&#x27;</span>] <span class="hljs-comment">// &lt;- reference the file your schema is in here</span>
})
<span class="hljs-comment">/**
 * <span class="hljs-doctag">@swagger</span>
 * /airports:
 *   get:
 *     summary: returns an array of airports
 *     responses:
 *       200:
 *         description: all the airports
 *         content:
 *           application/json:
 *             schema:
 *               $ref: &#x27;#/components/schemas/Airport&#x27;                 
 */</span>
app.get(<span class="hljs-string">&#x27;/airports&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> {
    res.send(airports)
})
</code></pre>
<h3>Pagination</h3>
<p>We have 28,000 airport records. Thats a lot. This would be much easier to consume in smaller chunks. Often large resources will be managed like this in &quot;pages&quot; of results. So lets say we have a page size of 25 that would mean we have to return only the first 25 airports (0 - 24 array indexes) that response would represent page 1. Page 2 would consist of the next 25 airports (25 - 49 array indexes). You will often see this handled as query parameters.</p>
<p><code>http://localhost:3000/airports?page=2&amp;pageSize=25</code></p>
<p>❓ What pagination errors might you now need to handle?</p>
<p>❓ What different HTTP codes might an endpoint like this return?</p>
<h2>Assignment</h2>
<p>Based on your <code>airports-config.yaml</code> OpenAPI definition file, can you build out a RESTful server with the same spec, only now the documented endpoints will be generated from the code itself. Implement pagination for the GET <code>/airports</code> route enabling users to define a page number (required) and an optional <code>pageSize</code> query parameter (this should default to 25).</p>

        <script src="/curriculum/js/tabbed-code-blocks.js"></script>
        <script>
            function toggleNav() {
                const button = document.getElementById('navigation-toggle')
                const isAriaExp = button.getAttribute('aria-expanded')
                const newAriaExp = (isAriaExp == "false") ? "true" : "false"
                button.setAttribute('aria-expanded', newAriaExp)
                const nav = document.getElementById('navigation')
                nav.style.display = nav.offsetParent ? 'none' : 'block'
            }
        </script>
    </body>
</html>