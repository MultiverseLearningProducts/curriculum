# Rendering Dynamic Content

## Learning Objectives
* Dyanmically create HTML content from an array of data 

## Pre-requisites
* Lesson [Sequelize - part 2](/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.9-Sequelize_part_1.html)

## Lesson
Our Restaurant application will display a <em>list</em> of restaurants. [Handlebars](https://handlebarsjs.com/) enables us to iterate over an array of data and repeatedly add the same parsed HTML block to our web page. This is how dynamic lists of content are rendered. The example below can be seen all over the Internet and is a good example of a <em>card</em> component.

![web page with a set of 8 squares each holding an image of a restaurant](https://user-images.githubusercontent.com/1316724/114185019-22c01300-993d-11eb-8dab-f102fc97e494.png)

> Can you recognise the template versus the dynamic content in the example above?

Let's look at how to retrieve our dynamic data. The example below uses Sequelize to fetch all the restaurants from the database and store them as an array in a variable called `restaurants`.

```javascript
app.get('/', async (request, response) => {
    const restaurants = await Restaurant.findAll({
        include: [
            {
                model: Menu, as: 'menus',
                include: [{model:MenuItem, as: 'items'}]
            }
        ],
        nest: true
    })
    response.render('home', {restaurants})
})
```

The first argument to `response.render` is the name of the view template we want to render the restaurant data into. In this example, it refers to a file named `home.handlebars`.
The second argument to `response.render` is the dynamic array of restaurants returned from the Sequelize query. This will be passed to the view template as a variable named `restaurants`.

In our view template we write our HTML content and insert Handlebars placeholders where we need to access content from the `restaurants` array. This is very much like 'mail merge' in Word.

To repeat a block of code for every item in an array we use the built in Handlebars template helper `{{#each}}`. The code below illustrates iterating over the list of restaurants to display the name and number of menus in each restaurant. 

```html
<h1>Restaurants</h1>
<section>
    {{#each restaurants}}
        <article>
            <header></header>
            <main>{{this.name}}</main>
            <footer>{{this.menus.length}} menus</footer>
        </article>
    {{/each}}
</section>
```
> In the code above, where does the repeating block of HTML begin and end? Load the page in your browser, when you inspect the HTML in the `Layouts` section of Chrome Developer Tools, what do you expect to see?

## Assignment
  1. If you have not completed Lesson [Sequelize - part 2](/curriculum/Bootcamp/Unit-3-Relational_Databases/0.3.9-Sequelize_part_2.html) then please obtain the sample solution code for this lesson. Copy the `.js` files into your project directory and install any required dependencies.
  1. Run `node populateDB.js` to load the restaurant JSON file and insert matching rows into the Restaurant, Menu and MenuItems tables.
  1. Use what you have learnt in this lesson to render all the restaurants onto a web page.
  1. Commit your code into Github and share the link with your coach for review.

### Assignment extension tasks
Display all the items associated with each menu.

## Additional resources
   * [Passing Variables To Node Webpages With Handlebars (3 minutes)](https://www.youtube.com/watch?v=TV7T_vKMid4)
   * [using the `each` Handlebars helper keyword (13 mins)](https://www.youtube.com/watch?v=JbrqxPcuYVc)  
