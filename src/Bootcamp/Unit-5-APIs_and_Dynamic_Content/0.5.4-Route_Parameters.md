# Route Parameters

## Learning Objectives
* Present the menu data from the list of restaurants in a separate page
* Create a new route to support access to this page

## Pre-requisites
TODO

## Lesson
We want to read what is on the menu for our lovely looking restaurants. In this lesson we are going to create a web page for each individual restaurant.

### Dynamic links

To be able to click on a restaurant card and then view that restaurant's web page we need to create a dynamic link. We are going to do this by wrapping our restaurant card in an 'anchor' tag. We then make the `href` point to a particular address on our server as follows:

```html
<h1>Restaurants</h1>
<section>
    {{#each restaurants}}
        <a href="/restaurants/{{this.id}}">
            <article>
                <header style="background-image: url({{this.image}});">
                <main>{{this.name}}</main>
                <footer>{{this.menus.length}} menus</footer>
            </article>
        </a>
    {{/each}}
</section>
```
As you hover over each card can you see the URL it links to in the bottom left-hand corner of your Chrome Browser? Clicking this link will cause a 404 error, as that page or resource does not exist yet.

```sh
Cannot GET /restaurants/2
```

### New Route

To deal with this new request we need to add a new route on our server. Not just any route, the last part of our route is going to be different depending on which restaurant we are clicking on. In the URL segment of the route we indicate a route parameter `/:id` as shown below:

```javascript
app.get('/restaurants/:id', async (request, response) => {
    console.log("get restaurant with ID:", request.params.id)
    response.send()
})
```
We can read the value of the route parameter using `request.params.id`. What do you think we are going to do with this id?

### New template

Let's create the new template for this view. In the `views` folder, add a file called `restaurant.handlebars`. Add some HTML so you know you have wired the route up to the template ok and test the route. 

Now we know our route and template are setup, we need to return the menu data. What arguments do you think we will pass to `response.render()`?

```javascript
app.get('/restaurants/:id', async (request, response) => {
    const restaurant = await Restaurant.findByPk(req.params.id)
    const menus = await restaurant.getMenus({
        include: [{model: MenuItem, as: 'items'}],
        nest: true
    })
    response.render('restaurant', {restaurant, menus})
})
```

### 2 levels of iteration

Our view of a restaurant requires us to iterate over the array of menus and within each menu to iterate over that menu's array of items. WOW! We can use the following HTML to display the menu and menu items. Note that the `<dl>` element is a 'description list', you can read more about it [here](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/dl). 

```html
<h1>{{restaurant.name}}</h1>
<section>
    {{#each menus}}
        <article>
            <h2>{{this.title}}</h2>
            <dl>
                {{#each this.items}}
                    <div>
                        <dt>{{this.name}}</dt>
                        <dd>Â£{{this.price}}</dd>
                    </div>
                {{/each}}
            </dl>
        </article>
    {{/each}}
</section>
```

To get the item name and price to line up nicely like below we can use Flexbox.

```css
dl div{
    display: flex;
    justify-content: space-between;
    padding: 1rem;
}
```

We should end up with a web page looking similar to this:

![example of a restaurant web page displaying its menus and menu items](https://user-images.githubusercontent.com/4499581/95021384-9caed100-0668-11eb-9fbc-9d93ea06a54b.jpg)

## Assignment
  1. Create the route and template to render a single restaurant as described above.
  1. Add a [hero image](https://www.w3schools.com/howto/howto_css_hero_image.asp) for the page
  ![example of a hero image](https://user-images.githubusercontent.com/4499581/95021581-adac1200-0669-11eb-84da-cfdf9befc65c.jpg)
  1. Commit your code into Github and share the link with your coach for review.

### Assignment extension tasks
TODO



