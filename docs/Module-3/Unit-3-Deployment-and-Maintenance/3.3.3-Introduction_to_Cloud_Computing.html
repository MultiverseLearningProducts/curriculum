<!DOCTYPE html>
<html lang="en-GB">

<head>
    <meta charset="utf-8">
    <title>
         An Introduction to Cloud Computing
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="shortcut icon" type="image/x-icon" href="/curriculum/favicon.ico" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.6.0/styles/an-old-hope.min.css">
    <link rel="stylesheet" href="/curriculum/style.css" />
    <script src="/curriculum/js/highlight.min.js"></script>
    <script src="/curriculum/js/bash.min.js"></script>
    <script src="/curriculum/js/java.min.js"></script>
    <script src="/curriculum/js/javascript.min.js"></script>
    <script src="/curriculum/js/sql.min.js"></script>
</head>

<body>
    <button id="navigation-toggle" aria-expanded="false" aria-haspopup="true" onclick="toggleNav()"
        onkeydown="event => {event.keyCode === 13 ? toggleNav() : null}" tabindex="1">Table of contents</button>
    <nav id="navigation"><ul><details><summary>Bootcamp</summary><ul><details><summary>Unit 1 Object Oriented Programming</summary><ul><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.0-UML_Modelling.html">0.1.0 UML Modelling</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.1-JavaScript_Objects_And_Functions.html">0.1.1 JavaScript Objects And Functions</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.2-Test_Driven_Development.html">0.1.2 Test Driven Development</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.3-Objects_in_an_Airport_Domain.html">0.1.3 Objects in an Airport Domain</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.4-Static_functions_and_properties.html">0.1.4 Static functions and properties</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.5-Inheritance.html">0.1.5 Inheritance</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.7-OOP_Challenge.html">0.1.7 OOP Challenge</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-1-Object_Oriented_Programming\0.1.8-End_of_Unit_Quiz_OOP.html">0.1.8 End of Unit Quiz OOP</a></li></ul></details><details><summary>Unit 2 Asynchronous JavaScript</summary><ul><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-2-Asynchronous_JavaScript\0.2.1-Asynchronous_JavaScript.html">0.2.1 Asynchronous JavaScript</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-2-Asynchronous_JavaScript\0.2.2-Promises.html">0.2.2 Promises</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-2-Asynchronous_JavaScript\0.2.3-Asynchronous_Airport_Data_Load.html">0.2.3 Asynchronous Airport Data Load</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-2-Asynchronous_JavaScript\0.2.4-End_of_Unit_Quiz_Async.html">0.2.4 End of Unit Quiz Async</a></li></ul></details><details><summary>Unit 3 Relational Databases</summary><ul><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.2-Introduction_to_Databases.html">0.3.2 Introduction to Databases</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.3-Basic_SQL_Commands.html">0.3.3 Basic SQL Commands</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.4-SQL_Joins.html">0.3.4 SQL Joins</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.5-Database_access_using_Node.html">0.3.5 Database access using Node</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.6-Populating_databases_from_JSON.html">0.3.6 Populating databases from JSON</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.7-Object_Relational_Mapping_part_1.html">0.3.7 Object Relational Mapping part 1</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.8-Object_Relational_Mapping_part_2.html">0.3.8 Object Relational Mapping part 2</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.9a-Sequelize_part_1.html">0.3.9a Sequelize part 1</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.9b-Sequelize_part_2.html">0.3.9b Sequelize part 2</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-3-Relational_Databases\0.3.9c-End_of_Unit_Quiz_Databases.html">0.3.9c End of Unit Quiz Databases</a></li></ul></details><details><summary>Unit 4 RESTful Servers</summary><ul><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-4-RESTful_Servers\0.4.1-Web_Servers.html">0.4.1 Web Servers</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-4-RESTful_Servers\0.4.2-Application_Servers.html">0.4.2 Application Servers</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-4-RESTful_Servers\0.4.3-Postman.html">0.4.3 Postman</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-4-RESTful_Servers\0.4.4-Route_Parameters.html">0.4.4 Route Parameters</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-4-RESTful_Servers\0.4.5-CRUD_operations.html">0.4.5 CRUD operations</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-4-RESTful_Servers\0.4.6-Server_side_Validation.html">0.4.6 Server side Validation</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-4-RESTful_Servers\0.4.7-End_of_Unit_Quiz_RESTful.html">0.4.7 End of Unit Quiz RESTful</a></li></ul></details><details><summary>Unit 5 Human Computer Interaction</summary><ul><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-5-Human_Computer_Interaction\0.5.1-Human_Computer_Interaction.html">0.5.1 Human Computer Interaction</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-5-Human_Computer_Interaction\0.5.2-Server_Side_Rendering.html">0.5.2 Server Side Rendering</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-5-Human_Computer_Interaction\0.5.3-The_Document_Object_Model.html">0.5.3 The Document Object Model</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-5-Human_Computer_Interaction\0.5.4-HTML_forms_and_lists.html">0.5.4 HTML forms and lists</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-5-Human_Computer_Interaction\0.5.5-End_of_Unit_Quiz_HCI.html">0.5.5 End of Unit Quiz HCI</a></li></ul></details><details><summary>Unit 6 End Of Bootcamp Group Project</summary><ul><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-6-End_Of_Bootcamp_Group_Project\0.6.1-Introduction.html">0.6.1 Introduction</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-6-End_Of_Bootcamp_Group_Project\0.6.2-Requirements.html">0.6.2 Requirements</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-6-End_Of_Bootcamp_Group_Project\0.6.3-Agile_Development.html">0.6.3 Agile Development</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-6-End_Of_Bootcamp_Group_Project\0.6.4-Design.html">0.6.4 Design</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-6-End_Of_Bootcamp_Group_Project\0.6.5-GitHub_Projects.html">0.6.5 GitHub Projects</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-6-End_Of_Bootcamp_Group_Project\0.6.6-Branching_and_Pull_Requests.html">0.6.6 Branching and Pull Requests</a></li><li><a class="nav-link" href="/curriculum\Bootcamp\Unit-6-End_Of_Bootcamp_Group_Project\0.6.7-Deployment_with_Heroku.html">0.6.7 Deployment with Heroku</a></li></ul></details></ul></details><details><summary>Module 1</summary><ul><details><summary>Unit 1 Agile user requirements</summary><ul><li><a class="nav-link" href="/curriculum\Module-1\Unit-1-Agile_user_requirements\1.1.1-Introduction_to_Agile.html">1.1.1 Introduction to Agile</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-1-Agile_user_requirements\1.1.2-Personas.html">1.1.2 Personas</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-1-Agile_user_requirements\1.1.3-Requirements.html">1.1.3 Requirements</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-1-Agile_user_requirements\1.1.4-User_Stories.html">1.1.4 User Stories</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-1-Agile_user_requirements\1.1.5-Next_Steps.html">1.1.5 Next Steps</a></li></ul></details><details><summary>Unit 2 Designing UI</summary><ul><li><a class="nav-link" href="/curriculum\Module-1\Unit-2-Designing_UI\1.2.1-Usability_heuristics.html">1.2.1 Usability heuristics</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-2-Designing_UI\1.2.2-Composition_and_components_in_design.html">1.2.2 Composition and components in design</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-2-Designing_UI\1.2.3-Prototyping_UI.html">1.2.3 Prototyping UI</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-2-Designing_UI\1.2.4-Next_Steps.html">1.2.4 Next Steps</a></li></ul></details><details><summary>Unit 3 Building UI with React</summary><ul><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_React\1.3.0-Welcome_to_Unit_3.html">1.3.0 Welcome to Unit 3</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_React\1.3.1-Getting_started_with_React.html">1.3.1 Getting started with React</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_React\1.3.2-React_methods_and_computed_properties.html">1.3.2 React methods and computed properties</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_React\1.3.3-Events_and_adding_to_cart.html">1.3.3 Events and adding to cart</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_React\1.3.4-Introducing_routing_to_our_app.html">1.3.4 Introducing routing to our app</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_React\1.3.5-Fixing_the_add_to_cart_event.html">1.3.5 Fixing the add to cart event</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_React\1.3.6-Adding_the_product_details_page.html">1.3.6 Adding the product details page</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_React\1.3.7-Integrating_Redux_for_global_state_management.html">1.3.7 Integrating Redux for global state management</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_React\1.3.8-Consolidating_the_final_components.html">1.3.8 Consolidating the final components</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_React\1.3.9-Closing_thoughts_and_next_steps.html">1.3.9 Closing thoughts and next steps</a></li></ul></details><details><summary>Unit 3 Building UI with Vue.js</summary><ul><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_Vue.js\1.3.0-Welcome_to_Unit_3.html">1.3.0 Welcome to Unit 3</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_Vue.js\1.3.1-Getting_started_with_the_Vue_CDN.html">1.3.1 Getting started with the Vue CDN</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_Vue.js\1.3.2-Vue_methods_and_computed_properties.html">1.3.2 Vue methods and computed properties</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_Vue.js\1.3.3-Events_and_adding_to_cart.html">1.3.3 Events and adding to cart</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_Vue.js\1.3.4-Introducing_routing_to_our_app.html">1.3.4 Introducing routing to our app</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_Vue.js\1.3.5-Fixing_the_add_to_cart_event.html">1.3.5 Fixing the add to cart event</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_Vue.js\1.3.6-Adding_the_product_details_page.html">1.3.6 Adding the product details page</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_Vue.js\1.3.7-Integrating_Vuex_for_global_state_management.html">1.3.7 Integrating Vuex for global state management</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_Vue.js\1.3.8-Consolidating_the_final_components.html">1.3.8 Consolidating the final components</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-3-Building_UI_with_Vue.js\1.3.9-Closing_thoughts_and_next_steps.html">1.3.9 Closing thoughts and next steps</a></li></ul></details><details><summary>Unit 4 Accessibility</summary><ul><li><a class="nav-link" href="/curriculum\Module-1\Unit-4-Accessibility\1.4.1-Inclusive_design.html">1.4.1 Inclusive design</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-4-Accessibility\1.4.2-Accessibility.html">1.4.2 Accessibility</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-4-Accessibility\1.4.3-Next_Steps.html">1.4.3 Next Steps</a></li></ul></details><details><summary>Unit 5 End to end testing</summary><ul><li><a class="nav-link" href="/curriculum\Module-1\Unit-5-End_to_end_testing\1.5.1-End_to_end_testing.html">1.5.1 End to end testing</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-5-End_to_end_testing\1.5.2-End_to_end_testing_with_Cypress.html">1.5.2 End to end testing with Cypress</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-5-End_to_end_testing\1.5.3-Adding_more_test_coverage.html">1.5.3 Adding more test coverage</a></li><li><a class="nav-link" href="/curriculum\Module-1\Unit-5-End_to_end_testing\1.5.4-Test_cases_and_equivalence_testing.html">1.5.4 Test cases and equivalence testing</a></li></ul></details></ul></details><details><summary>Module 2</summary><ul><details><summary>Unit 1 Securing APIs with Basic Auth</summary><ul><li><a class="nav-link" href="/curriculum\Module-2\Unit-1-Securing_APIs_with_Basic_Auth\2.1.1-RESTful_APIs_and_Frameworks.html">2.1.1 RESTful APIs and Frameworks</a></li><li><a class="nav-link" href="/curriculum\Module-2\Unit-1-Securing_APIs_with_Basic_Auth\2.1.2-Password_Hashing.html">2.1.2 Password Hashing</a></li><li><a class="nav-link" href="/curriculum\Module-2\Unit-1-Securing_APIs_with_Basic_Auth\2.1.3-Implementing_Basic_Auth.html">2.1.3 Implementing Basic Auth</a></li><li><a class="nav-link" href="/curriculum\Module-2\Unit-1-Securing_APIs_with_Basic_Auth\2.1.4-Limitations_of_Basic_Auth.html">2.1.4 Limitations of Basic Auth</a></li></ul></details><details><summary>Unit 2 Securing APIs with OAuth and OpenID Connect</summary><ul><li><a class="nav-link" href="/curriculum\Module-2\Unit-2-Securing_APIs_with_OAuth_and_OpenID_Connect\2.2.1-Introduction_to_OAuth.html">2.2.1 Introduction to OAuth</a></li><li><a class="nav-link" href="/curriculum\Module-2\Unit-2-Securing_APIs_with_OAuth_and_OpenID_Connect\2.2.2-Securing_APIs_with_OAuth.html">2.2.2 Securing APIs with OAuth</a></li><li><a class="nav-link" href="/curriculum\Module-2\Unit-2-Securing_APIs_with_OAuth_and_OpenID_Connect\2.2.3-OpenID_Connect.html">2.2.3 OpenID Connect</a></li><li><a class="nav-link" href="/curriculum\Module-2\Unit-2-Securing_APIs_with_OAuth_and_OpenID_Connect\2.2.4-Module_2_assessment.html">2.2.4 Module 2 assessment</a></li></ul></details></ul></details><details><summary>Module 3</summary><ul><details><summary>Unit 1 The SDLC</summary><ul><li><a class="nav-link" href="/curriculum\Module-3\Unit-1-The-SDLC\3.1.0-Introduction_to_module_3.html">3.1.0 Introduction to module 3</a></li><li><a class="nav-link" href="/curriculum\Module-3\Unit-1-The-SDLC\3.1.1-The_Software_Development_Life_Cycle.html">3.1.1 The Software Development Life Cycle</a></li><li><a class="nav-link" href="/curriculum\Module-3\Unit-1-The-SDLC\3.1.2-The_roles_and_responsibilities_in_the_SDLC_with_communication.html">3.1.2 The roles and responsibilities in the SDLC with communication</a></li><li><a class="nav-link" href="/curriculum\Module-3\Unit-1-The-SDLC\3.1.3-Communication_in_your_teams.html">3.1.3 Communication in your teams</a></li></ul></details><details><summary>Unit 2 The 7 Princibles of Testing</summary><ul><li><a class="nav-link" href="/curriculum\Module-3\Unit-2-The-7-Princibles-of-Testing\3.2.1-The_7_Princibles_of_Testing.html">3.2.1 The 7 Princibles of Testing</a></li><li><a class="nav-link" href="/curriculum\Module-3\Unit-2-The-7-Princibles-of-Testing\3.2.2-Continuous_Deployment.html">3.2.2 Continuous Deployment</a></li></ul></details><details><summary>Unit 3 Deployment and Maintenance</summary><ul><li><a class="nav-link" href="/curriculum\Module-3\Unit-3-Deployment-and-Maintenance\3.3.1-Introduction_to_Unix.html">3.3.1 Introduction to Unix</a></li><li><a class="nav-link" href="/curriculum\Module-3\Unit-3-Deployment-and-Maintenance\3.3.2-Introduction_to_containerisation.html">3.3.2 Introduction to containerisation</a></li><li><a class="nav-link" href="/curriculum\Module-3\Unit-3-Deployment-and-Maintenance\3.3.3-Introduction_to_Cloud_Computing.html">3.3.3 Introduction to Cloud Computing</a></li><li><a class="nav-link" href="/curriculum\Module-3\Unit-3-Deployment-and-Maintenance\3.3.4-Monitoring_and_Maintenance.html">3.3.4 Monitoring and Maintenance</a></li></ul></details></ul></details><details><summary>Module 4</summary><ul><details><summary>Unit 1 Open Web Application Security Project</summary><ul><li><a class="nav-link" href="/curriculum\Module-4\Unit-1-Open_Web_Application_Security_Project\4.1.1-OWASP.html">4.1.1 OWASP</a></li><li><a class="nav-link" href="/curriculum\Module-4\Unit-1-Open_Web_Application_Security_Project\4.1.2-Juice_Shop.html">4.1.2 Juice Shop</a></li></ul></details><details><summary>Unit 2 OWASP Top 10</summary><ul><li><a class="nav-link" href="/curriculum\Module-4\Unit-2-OWASP_Top_10\4.2.1-Broken_Access_Control.html">4.2.1 Broken Access Control</a></li><li><a class="nav-link" href="/curriculum\Module-4\Unit-2-OWASP_Top_10\4.2.2-Cryptographic_Failure.html">4.2.2 Cryptographic Failure</a></li><li><a class="nav-link" href="/curriculum\Module-4\Unit-2-OWASP_Top_10\4.2.3-Injection.html">4.2.3 Injection</a></li><li><a class="nav-link" href="/curriculum\Module-4\Unit-2-OWASP_Top_10\4.2.4-Insecure_Design.html">4.2.4 Insecure Design</a></li><li><a class="nav-link" href="/curriculum\Module-4\Unit-2-OWASP_Top_10\4.2.5-Security_Misconfiguration.html">4.2.5 Security Misconfiguration</a></li><li><a class="nav-link" href="/curriculum\Module-4\Unit-2-OWASP_Top_10\4.2.6-Vulnerable_Components.html">4.2.6 Vulnerable Components</a></li><li><a class="nav-link" href="/curriculum\Module-4\Unit-2-OWASP_Top_10\4.2.7-Identification_and_Authentication_Failures.html">4.2.7 Identification and Authentication Failures</a></li><li><a class="nav-link" href="/curriculum\Module-4\Unit-2-OWASP_Top_10\4.2.8-Software_and_Data_Integrity_Failures.html">4.2.8 Software and Data Integrity Failures</a></li><li><a class="nav-link" href="/curriculum\Module-4\Unit-2-OWASP_Top_10\4.2.9-Security_Logging_and_Monitoring_Failures.html">4.2.9 Security Logging and Monitoring Failures</a></li><li><a class="nav-link" href="/curriculum\Module-4\Unit-2-OWASP_Top_10\4.2.I0-Server_Side_Request_Forgery.html">4.2.I0 Server Side Request Forgery</a></li></ul></details></ul></details></ul></nav>
    <h1>An Introduction to Cloud Computing</h1>
<p>You will hear people talking about 'the cloud'. The cloud is a major component of modern computing, yet the term is very vague and ephemeral, literally like the clouds. As a software engineer you need to know something of what the cloud is. Most of the software and services you work on will run there and the way you write code and build apps needs to take that final environment into consideration. In fact there are 12 factors that need considering when working on scalable services that will run in cloud environments. Our job is to understand why those 12 factors are important.</p>
<p>We are going to look at 4 topics that we think will give you a basic understanding of what the cloud is and how to think about and design the software that will run on in. We are going to look at:</p>
<ul>
<li>Virtualization</li>
<li>Clustering</li>
<li>Networking</li>
<li>Scaling</li>
</ul>
<h2>Hypervisors for Virtualization</h2>
<p>The first thing to understand is virtualization. The idea is that on your computer your can create and use another computer that exists only in software. A virtual machine.</p>
<h3>Virtual Machines</h3>
<p>The place to start getting familiar with this idea is to install and use VirtualBox. We are going to provision and create a virtual raspberry pi in VirtualBox.</p>
<ul>
<li>Download and install <a href="https://www.virtualbox.org/wiki/Downloads">VirtualBox</a> for your host system i.e. Windows</li>
<li>Download the <a href="https://www.raspberrypi.com/software/raspberry-pi-desktop/">Raspberry Pi Desktop</a>.iso image</li>
<li>In VirtualBox create a new VM (Virtual Machine) and name it, select type <strong>Linux</strong>, version <strong>Debian(64-bit)</strong></li>
<li>Choose 'create' and accept all the default options</li>
<li>In the settings of the new VM goto <strong>storage</strong> in the section for the optical disc select the .iso image for the raspberry pi you just downloaded</li>
<li>When you start the machine it will boot from this - select <strong>install</strong> from the list</li>
<li>When it comes to select the GRUB loader choose <code>/dev/sda (ata-VBOX_HARDDISK...)</code></li>
<li>Finally you'll see you now can run a little computer inside your big computer!</li>
</ul>
<p>This VM will behave like a distinct computer, for example it has it's own ip address on your network and you can install and run additional software on it.</p>
<h3>Bare Metal Hypervisors</h3>
<p>If we take the trick of VirtualBox and apply it in a more extreme way we might wonder why we need a base operating system at all? A 'Bare Metal' hypervisor is installed in the place of an operating system i.e. Windows or Linux. The hypervisor is a thin layer of software that is installed on disc and exposes the motherboard's components to the abstraction of virtualization. All you get when you turn the computer on and plug in a monitor is an ip address on the screen. You have to use another computer to connect to the running hypervisor, and then you can start to make virtual machines on the 'bare metal' using a configuration client (like <a href="https://techzone.vmware.com/manually-creating-optimized-windows-images-vmware-horizon-vms#_306465">VMware's vSphere</a> client).</p>
<p><figure><img src="https://user-images.githubusercontent.com/4499581/138301496-481c708c-2314-48e9-b86b-2acf3d65b1b1.jpg" alt="4 VMs"><figcaption></figcaption></figure></p>
<p>Before virtualization you usually had one server dedicated to one service i.e. one server would run the company email. You would install something like Windows Server or a Linux distro and then install all the software for the email server. If you needed to update the server, or reboot, then the email service would go down for a period. With virtualization you can do much more with your hardware. You can run multiple operating systems and services on one piece of hardware, turn off or reboot one virtual machine without effecting the others.</p>
<blockquote>
<p>That means you own 1 physical server, but you can run 4 virtual machines on that 1 piece of hardware.</p>
</blockquote>
<p>The moment of separating the operating system from the hardware is a fundamental building block of cloud computing. Why do you think that might be?</p>
<h2>Clustering</h2>
<p>If we want to group a number of computers together and get them to work as a team we need to start clustering them. In clusters computers are usually referred to as nodes. You can expect to find 2 different types of nodes in a cluster:</p>
<ul>
<li>Manager nodes</li>
<li>Worker nodes</li>
</ul>
<p>The manager nodes do the work of managing the cluster, labeling and keeping track of worker nodes and services. There might be a number of manager nodes so one can be swapped out if need be and everything will keep running. Same with worker nodes. In a cluster you want to be able to power down any node without impacting the services, and be able to then provision and join a replacement node into the cluster if you want to.</p>
<p>If you can replace nodes why can't you add them too? You can. This is called horizontal scaling. You start with a cluster of 3 nodes and as demand for your services increases you can match that demand by adding more nodes. For example in the autumn/fall Walmart has a spike in website traffic around '<a href="https://en.wikipedia.org/wiki/Black_Friday_(shopping)">black friday</a>' so they anticipate the extra demand by scaling horizontally adding extra nodes to absorb the spike in traffic. After the holiday season Walmart don't need all those extra nodes as demand reduces, so to save the costs of keeping all that availability they can scale back and remove the extra nodes. You often here infrastructure set up like this described as 'elastic' or horizontally scalable.</p>
<p>We did something like this when we added agents to our GOCD server. We added agents (nodes) to leverage the computing power of all our devices collected together.</p>
<h3>Load Balancing</h3>
<p>Clustered nodes can be virtual machines, or physical computers connected together. They are usually geographically co-located, but they don't have to be. The main performance benefit that a cluster provides is high availability. High availability is achieved through 'load balancing'.<br>
<figure><img src="https://avinetworks.com/wp-content/uploads/2018/10/multi-cloud-application-services-load-balancing-simple-diagram.svg" alt="load balancing"><figcaption></figcaption></figure><br>
The entry point into the cluster's network will know how busy each node is in the cluster. Traffic will be directed to the nodes with the most capacity. That means if a node starts to get really busy, the network routing will direct traffic to other nodes, giving the busy node time to complete it's work. This way the demand is spread evenly across all the nodes. Can you see how Walmart can cope with extra traffic now by adding extra nodes?</p>
<h3>0 Downtime</h3>
<p>The other benefit of a cluster is redundancy. By doubling each service if one instance of a service fails or crashes there is another running instance that can keep the service going. When you need to update a service you can roll it out through the cluster one node at a time. That way the service never goes down. Even when you are upgrading! You are even able to physically migrate the service from one piece of hardware to another one node at a time without your service ever going down.</p>
<h2>Set up your own cluster</h2>
<p>Below are 4 options for setting up your own cluster.</p>
<ol>
<li>In the Cloud (expensive)</li>
<li>In Docker Labs (easy but limited)</li>
<li>In VirtualBox (best option)</li>
<li>On a Raspberry Pi Cluster (most awesome option)</li>
</ol>
<h4>1. In the Cloud</h4>
<p>There are different ways you can create a cluster for yourself. You can pay for VMs on <a href="https://aws.amazon.com/">AWS</a>, <a href="https://www.digitalocean.com/">DigitalOcean</a>, <a href="https://azure.microsoft.com/en-gb/free/">Azure</a> or <a href="https://www.scaleway.com/en/">Scaleway</a> (Scaleway for ARM based servers). Whatever service you use you'll need to<br>
do the following:</p>
<ul>
<li>create 3 nodes</li>
<li>enable ssh (usually you have to add your public ssh key <strong>BEFORE</strong> you create your node)</li>
<li>install a flavour of Linux like Ubuntu, Debian or Busybox (Alpine)</li>
<li>find the ip addresses of each node and make a note of them <code>ifconfig</code></li>
<li>name each node by updating <code>/etc/hosts</code> and <code>/etc/hostname</code> i.e. <code>192.168.56.101 manager01</code></li>
</ul>
<h4>2. In Docker Labs</h4>
<ul>
<li><a href="https://labs.play-with-docker.com/">https://labs.play-with-docker.com/</a></li>
<li>Login with your Docker account (create one if you need to)</li>
<li>Start a session (you have 4 hours of compute time)</li>
<li>Add instances (they will already have ip addresses and names)</li>
</ul>
<h4>3. In VirtualBox</h4>
<ul>
<li>Install ruby</li>
<li>Install <a href="https://www.vagrantup.com/downloads">Vagrant</a></li>
<li>Run <code>vagrant plugin install vagrant-hostmanager</code></li>
<li>create a <code>Vagrantfile</code> and add the following</li>
</ul>
<pre><code class="language-ruby"><span class="hljs-comment"># -*- mode: ruby -*-</span>
<span class="hljs-comment"># vi: set ft=ruby :</span>

<span class="hljs-variable">$install_docker_script</span> = <span class="hljs-string">&lt;&lt;SCRIPT
echo &quot;Installing dependencies ...&quot;
sudo apt-get update
echo Installing Docker...
curl -sSL https://get.docker.com/ | sh
sudo usermod -aG docker vagrant
SCRIPT</span>

BOX_NAME = <span class="hljs-string">&quot;ubuntu/xenial64&quot;</span>
MEMORY = <span class="hljs-string">&quot;512&quot;</span>
MANAGERS = <span class="hljs-number">2</span>
MANAGER_IP = <span class="hljs-string">&quot;172.20.20.1&quot;</span>
WORKERS = <span class="hljs-number">2</span>
WORKER_IP = <span class="hljs-string">&quot;172.20.20.10&quot;</span>
CPUS = <span class="hljs-number">2</span>
VAGRANTFILE_API_VERSION = <span class="hljs-string">&quot;2&quot;</span>

Vagrant.configure(VAGRANTFILE_API_VERSION) <span class="hljs-keyword">do</span> <span class="hljs-params">|config|</span>
    <span class="hljs-comment">#Common setup</span>
    config.vm.box = BOX_NAME
    config.vm.synced_folder <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;/vagrant&quot;</span>
    config.vm.provision <span class="hljs-string">&quot;shell&quot;</span>,<span class="hljs-symbol">inline:</span> <span class="hljs-variable">$install_docker_script</span>, <span class="hljs-symbol">privileged:</span> <span class="hljs-literal">true</span>
    config.vm.provider <span class="hljs-string">&quot;virtualbox&quot;</span> <span class="hljs-keyword">do</span> <span class="hljs-params">|vb|</span>
      vb.memory = MEMORY
      vb.cpus = CPUS
    <span class="hljs-keyword">end</span>
    config.hostmanager.enabled = <span class="hljs-literal">true</span>
    config.hostmanager.manage_guest = <span class="hljs-literal">true</span>
    config.hostmanager.ignore_private_ip = <span class="hljs-literal">false</span>
    config.hostmanager.include_offline = <span class="hljs-literal">true</span>
    <span class="hljs-comment">#Setup Manager Nodes</span>
    (<span class="hljs-number">1</span>..MANAGERS).each <span class="hljs-keyword">do</span> <span class="hljs-params">|i|</span>
        config.vm.define <span class="hljs-string">&quot;manager0<span class="hljs-subst">#{i}</span>&quot;</span> <span class="hljs-keyword">do</span> <span class="hljs-params">|manager|</span>
          manager.vm.network <span class="hljs-symbol">:private_network</span>, <span class="hljs-symbol">ip:</span> <span class="hljs-string">&quot;<span class="hljs-subst">#{MANAGER_IP}</span><span class="hljs-subst">#{i}</span>&quot;</span>
          manager.vm.hostname = <span class="hljs-string">&quot;manager0<span class="hljs-subst">#{i}</span>&quot;</span>
          
          <span class="hljs-keyword">if</span> i == <span class="hljs-number">1</span>
            <span class="hljs-comment">#Only configure port to host for Manager01</span>
            config.vm.network <span class="hljs-symbol">:forwarded_port</span>, <span class="hljs-symbol">guest:</span> <span class="hljs-number">80</span>, <span class="hljs-symbol">host:</span> <span class="hljs-number">80</span>
            config.vm.network <span class="hljs-symbol">:forwarded_port</span>, <span class="hljs-symbol">guest:</span> <span class="hljs-number">5432</span>, <span class="hljs-symbol">host:</span> <span class="hljs-number">5432</span>
            config.vm.network <span class="hljs-symbol">:forwarded_port</span>, <span class="hljs-symbol">guest:</span> <span class="hljs-number">2368</span>, <span class="hljs-symbol">host:</span> <span class="hljs-number">2368</span>
            manager.vm.network <span class="hljs-symbol">:forwarded_port</span>, <span class="hljs-symbol">guest:</span> <span class="hljs-number">8080</span>, <span class="hljs-symbol">host:</span> <span class="hljs-number">8080</span>
            manager.vm.network <span class="hljs-symbol">:forwarded_port</span>, <span class="hljs-symbol">guest:</span> <span class="hljs-number">5000</span>, <span class="hljs-symbol">host:</span> <span class="hljs-number">5000</span>
            manager.vm.network <span class="hljs-symbol">:forwarded_port</span>, <span class="hljs-symbol">guest:</span> <span class="hljs-number">9000</span>, <span class="hljs-symbol">host:</span> <span class="hljs-number">9000</span>
            manager.hostmanager.aliases = <span class="hljs-string">%w(172.20.20.11 manager01)</span>
          <span class="hljs-keyword">else</span>
            manager.hostmanager.aliases = <span class="hljs-string">%w(172.20.20.12 manager02)</span>
          <span class="hljs-keyword">end</span>
        <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>
    <span class="hljs-comment">#Setup Woker Nodes</span>
    (<span class="hljs-number">1</span>..WORKERS).each <span class="hljs-keyword">do</span> <span class="hljs-params">|i|</span>
        config.vm.define <span class="hljs-string">&quot;worker0<span class="hljs-subst">#{i}</span>&quot;</span> <span class="hljs-keyword">do</span> <span class="hljs-params">|worker|</span>
            worker.vm.network <span class="hljs-symbol">:private_network</span>, <span class="hljs-symbol">ip:</span> <span class="hljs-string">&quot;<span class="hljs-subst">#{WORKER_IP}</span><span class="hljs-subst">#{i}</span>&quot;</span>
            worker.vm.hostname = <span class="hljs-string">&quot;worker0<span class="hljs-subst">#{i}</span>&quot;</span>
            <span class="hljs-keyword">if</span> i == <span class="hljs-number">1</span>
              worker.hostmanager.aliases = <span class="hljs-string">%w(172.20.20.101 worker01)</span>
            <span class="hljs-keyword">else</span>
              worker.hostmanager.aliases = <span class="hljs-string">%w(172.20.20.102 worker02)</span>
            <span class="hljs-keyword">end</span>
        <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<ul>
<li><code>vagrant up</code> will provision and start your cluster</li>
<li>Access each node with the command <code>vagrant ssh NODE_NAME</code> i.e <code>vagrant ssh manager01</code></li>
<li><code>vagrant ssh manager01</code> init swarm <code>docker swarm init --listen-addr 172.20.20.11:2377 --advertise-addr 172.20.20.11:2377</code></li>
<li><code>vagrant ssh worker01</code> join workers with the token the above command created</li>
<li>join the second manager node with this token <code>docker swarm join-token manager</code></li>
<li><em>TIP</em> I had to increase the RAM for manager01 from 512MB to 1024MB</li>
</ul>
<h4>4. On a Raspberry Pi Cluster</h4>
<p><figure><img src="https://blog.hypriot.com/images/picocluster-kits/picocluster-3node-pi-tower.jpg" alt="Raspberry pi cluster"><figcaption></figcaption></figure></p>
<ul>
<li>Order 3 Raspberry Pi, 3 ethernet cables, 3 power cables, a 4port switch</li>
<li>create images on the SD cards (use Rasberry Pi Imager software)</li>
<li>enable ssh by creating an empty ssh file (<code>touch ssh</code> in <code>/boot</code> folder on SD card)</li>
<li>Assemble pies, power, networking and plug into your home router</li>
<li>find ip addresses of your raspberry pies on your network (<a href="https://apps.apple.com/us/app/lanscan/id472226235?mt=12">Lanscan</a>)</li>
<li>ssh into each pi and create hostnames like <code>pinode01</code> (<code>sudo nano /etc/hosts</code> &amp; <code>sudo nano /etc/hostname</code>)</li>
<li>sudo apt-get update &amp;&amp; sudo apt-get upgrade</li>
<li>install docker on each node <code>sudo curl -sSL https://get.docker.com | sh</code></li>
<li>modify the user by adding pi to the docker group <code>sudo usermod -aG docker pi</code></li>
<li>check all is well with <code>docker version</code></li>
</ul>
<h2>Initialise the Cluster</h2>
<p>Once you have your set of nodes ready select a 'manager' node and run the following docker command to initialise that node as the manager.</p>
<pre><code class="language-sh">sudo docker swarm init --advertise-addr NODE1_IP_ADDRESS
</code></pre>
<p>Swap <code>NODE1_IP_ADDRESS</code> with the ip address of your manager node. You'll get a command to then run on your worker nodes (see below) so copy and paste this so your other worker nodes join the 'swarm' (Docker's name for a cluster). Your join token will look something like the one below.</p>
<pre><code class="language-sh">docker swarm join --token SWMTKN-1-0b8xy6w_____SOME_TOKEN_HASH_____eyuy26luxxj9fdh9vz x.x.x.x:2377
</code></pre>
<p>If you want to join an additional manager node to your cluster use this command on your primary manager node to generate a manager join token.</p>
<pre><code class="language-sh">docker swarm join-token manager
</code></pre>
<h3>Visualize the Cluster</h3>
<p>You've just created a cluster! To begin to appreciate what you have just done we are going to download and install a tool to help us monitor and manager our cluster. There is an open source project called <a href="https://www.portainer.io/">Portainer</a> that can help us with this. On the <strong>manager node</strong> run the following command to download the 'stack' file.</p>
<pre><code class="language-sh">curl -L https://downloads.portainer.io/portainer-agent-stack.yml -o portainer-agent-stack.yml
</code></pre>
<p>If you <code>cat portainer-agent-stack.yml</code> you will see this is a docker compose file. However there are some extensions that make this a 'stack' file. Can you see the section labeled <code>deploy:</code> because we are going to run this docker compose file in a swarm (cluster) we have some extra config; like how many replicas of this service we will run, the particular type of node to run on, etc.</p>
<p>When you are ready deploy this stack into your cluster with the following command.</p>
<pre><code class="language-sh">docker stack deploy -c portainer-agent-stack.yml portainer
</code></pre>
<p><em>If you are using <a href="https://labs.play-with-docker.com/">https://labs.play-with-docker.com/</a> you'll see some ports will open at the top of your screen, click on the <strong>9443</strong> port - you might need to add <code>https://</code> to the beginning of the URL to get it to load, its doing some fancy things with ssh tunnels and SSL is not going to work so ignore the warnings - your good - you know you are doing something a little funky.</em></p>
<p><em>If you have a cluster of VMs visit <code>https://NODE1_IP_ADDRESS:9000</code> where <code>NODE1_IP_ADDRESS</code> is the ip address of your manager node.</em></p>
<ul>
<li>Make the admin account on portainer</li>
<li>Navigate to 'Go to cluster visualizer'</li>
</ul>
<h3>Deploy Ghost blog into the cluster</h3>
<p>Now we have a cluster we can start to use it to run our apps and services. Because we are using Docker Swarm we can use Docker compose files to define our services. Because we are using Docker Swarm those Docker compose files are called 'stacks'. We want our Ghost blog to run on a number of nodes and for those nodes to be communicating on the same virtual network. So we are going to start by making a network for our Ghost Blog service to run on.</p>
<pre><code class="language-sh">docker network create --driver overlay ghost_network
</code></pre>
<p>Create a <code>ghost.yml</code> file on your primary manager node. Add the following 'stack' into the file and save it.</p>
<pre><code class="language-yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">&#x27;3.7&#x27;</span>

<span class="hljs-attr">services:</span>
  <span class="hljs-attr">blog:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">ghost:4-alpine</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">db</span>
    <span class="hljs-attr">ports:</span>
        <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;2368:2368&quot;</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">database__client:</span> <span class="hljs-string">mysql</span>
      <span class="hljs-attr">database__connection__host:</span> <span class="hljs-string">db</span>
      <span class="hljs-attr">database__connection__user:</span> <span class="hljs-string">ghostusr</span>
      <span class="hljs-attr">database__connection__password:</span> <span class="hljs-string">ghostme</span>
      <span class="hljs-attr">database__connection__database:</span> <span class="hljs-string">ghostdata</span>
    <span class="hljs-attr">deploy:</span>
      <span class="hljs-attr">replicas:</span> <span class="hljs-number">1</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">ghost_network</span>
  <span class="hljs-attr">db:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">mysql:5.7</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;3306:3306&quot;</span><span class="hljs-string">dock</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">MYSQL_ROOT_PASSWORD:</span> <span class="hljs-string">example</span>
      <span class="hljs-attr">MYSQL_USER:</span> <span class="hljs-string">ghostusr</span>
      <span class="hljs-attr">MYSQL_PASSWORD:</span> <span class="hljs-string">ghostme</span>
      <span class="hljs-attr">MYSQL_DATABASE:</span> <span class="hljs-string">ghostdata</span>
    <span class="hljs-attr">deploy:</span>
      <span class="hljs-attr">replicas:</span> <span class="hljs-number">1</span>
      <span class="hljs-attr">placement:</span>
        <span class="hljs-attr">constraints:</span>
          <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;node.role==manager&quot;</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">ghost_network</span>
<span class="hljs-attr">networks:</span>
    <span class="hljs-attr">ghost_network:</span>
        <span class="hljs-attr">external:</span> <span class="hljs-literal">true</span>
</code></pre>
<h3>Set up the Database</h3>
<p>You should see the database spins up ok but if the ghost blog does not start properly. You will have to provision the database. You can use Portainer to help with this. Find the database container. Access the shell in the container and enter the database with <code>mysql -u root</code>.</p>
<p>If you need to create the <code>ghostusr</code> and database. Run the following sequence of SQL commands and exit the container.</p>
<pre><code class="language-sql"><span class="hljs-keyword">DROP</span> <span class="hljs-keyword">USER</span> <span class="hljs-string">&#x27;ghostusr&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span>;
FLUSH PRIVILEGES;
<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">USER</span> <span class="hljs-string">&#x27;ghostusr&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span> IDENTIFIED <span class="hljs-keyword">BY</span> <span class="hljs-string">&#x27;ghostme&#x27;</span>;
<span class="hljs-keyword">CREATE</span> DATABASE ghostdata;
<span class="hljs-keyword">GRANT</span> <span class="hljs-keyword">ALL</span> PRIVILEGES <span class="hljs-keyword">ON</span> ghostdata.<span class="hljs-operator">*</span> <span class="hljs-keyword">TO</span> <span class="hljs-string">&#x27;ghostusr&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span>;
FLUSH PRIVILEGES;
</code></pre>
<p>Once this is set on the database without doing anything else the ghost blog container should start up ok. Visit <code>localhost</code> or <code>NODE_IP_ADDRESS</code>. Have a click around. Our blog site gets really popular! Now we want to horizontally scale out site. Instead of having just 1 instance of our blog running we can increase it to 3, we should then see 1 instance on each node in our cluster.</p>
<p>Update the <code>ghost.yml</code> file to include the following section in the services -&gt; blog definition:</p>
<pre><code class="language-yml"><span class="hljs-attr">services:</span>
  <span class="hljs-attr">blog:</span>
    <span class="hljs-comment"># other stuff here</span>
    <span class="hljs-attr">deploy:</span>
      <span class="hljs-attr">replicas:</span> <span class="hljs-number">3</span>
  <span class="hljs-attr">db:</span>
    <span class="hljs-attr">deploy:</span>
      <span class="hljs-attr">replicas:</span> <span class="hljs-number">2</span>
</code></pre>
<p>Try it.</p>
<p>If only it were that simple. Visit <code>localhost:2368/about/edit</code> and you will be prompted to create an account or create a post. Those are written to the database. Mysql uses the file system to 'store' data. If we scale the database over 2 nodes what will happen to our data?</p>
<p>2 nodes, 2 discreet file systems there is no way the data will stay in sync. We might create a post and save it in one database on one node, but when we go to update it and we are on the other node, it won't find our post in it's database. It will break. It will be buggy and glitchy.</p>
<h3>The problems of clustering</h3>
<p>Now we have created our own cloud environment. We can deploy and scale our applications across multiple nodes! You now know you can't just replicate multiple instances of a service across nodes and have it just work. Any app that writes or reads from disc might not scale well. For example, wordpress writes your configuration into the file system, and also a database. You've seen the glitchy behavior in the ghost blog example. This is because the underlying file system is on separate computers. I might write some config to the file system on one computer, but my next request for another page in the cluster bounces me to a different computer - and I've lost my state.</p>
<h3>Abstracting the file system into 'volumes'</h3>
<p>For our cluster to work and for us to be able to scale apps we need to also abstract the file system we are using and have it replicated on each node. For this we'll use <a href="https://www.gluster.org/">GlusterFS</a>. What we are going to do on each node is create the same folder i.e. <code>/home/vagrant/vols</code>. Next we are going to install GlusterFS and create a 'volume' which will represent this folder in an abstraction. We can treat the 'volume' as if it were a single folder on a single computer. That way we can just include it in our docker stack file as a mounted volume. The containers think they are writing to disc. Gluster is intercepting the reads and writes and managing to sync the same arrangement and content of files and folders to all the nodes in the cluster.</p>
<h2>GlusterFS</h2>
<h4>Install Setup</h4>
<ul>
<li><a href="https://thenewstack.io/tutorial-create-a-docker-swarm-with-persistent-storage-using-glusterfs/">instructions</a></li>
<li>[each node] <code>sudo add-apt-repository ppa:gluster/glusterfs-3.10 &amp;&amp; sudo apt-get update</code> - add glusterfs-server to the apt-get repository</li>
<li>[each node] <code>sudo apt-get install glusterfs-server -y</code> - install GlusterFS</li>
<li>[each node] <code>sudo systemctl start glusterfs-server &amp;&amp; sudo systemctl enable glusterfs-server</code> - Configure the service to run when the machine boots</li>
<li>[each node] <code>mkdir -p ~/vols/content &amp;&amp; mkdir ~/vols/mysql</code></li>
</ul>
<h4>Create the volume</h4>
<ul>
<li>[On the manager node] <code>sudo gluster peer probe worker01</code> repeat for all the other nodes.</li>
<li>[On the manager node] <code>sudo gluster volume create vols replica 4 manager01:/home/vagrant/vols manager02:/home/vagrant/vols worker01:/home/vagrant/vols worker02:/home/vagrant/vols force</code></li>
<li>[On the manager node] <code>sudo gluster volume start vols</code></li>
</ul>
<h4>Mount the volume</h4>
<ul>
<li>[each node] <code>sudo mount.glusterfs localhost:/vols /mnt</code></li>
<li>[each node] add <code>localhost:/vols /mnt glusterfs defaults,_netdev,backupvolfile-server=localhost 0 0</code> to <code>/etc/fstab</code></li>
</ul>
<p>Want to see what you just did? SSH into a node and create a file in <code>/mnt/content/hello.py</code>. Now go look in another node in the same spot. Now we have an area of the file system that will be synced across all our nodes. Lets put the database there. Update your <code>ghost.yml</code> to include <code>volumes:</code> as below.</p>
<pre><code class="language-yml"><span class="hljs-attr">services:</span>
  <span class="hljs-attr">blog:</span>
    <span class="hljs-comment"># other stuff here</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;/mnt/content:/var/lib/ghost/content&quot;</span>
  <span class="hljs-attr">db:</span>
    <span class="hljs-comment"># other stuff here</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;/mnt/mysql:/var/lib/mysql&quot;</span>
</code></pre>
<h4>Mysql Logs!</h4>
<p>Problems mysql wants to write logs. From the file system point of view it looks like 2 different mysql processes are trying to write to the same file ü§¶‚Äç‚ôÄÔ∏è. When process 1 writes to the log file it 'locks' the file. When process 2 tries to write to the log file, it can't it is locked out ü§¨. For now scale back the database to 1 replica. If you are interested and want to scale your mysql instances you need to ready about <a href="https://dev.mysql.com/doc/refman/5.7/en/replication.html">replication</a> in the docs. We need to think about logging too!</p>
<p>Below is a final <code>ghost.yaml</code> file that you should be able to deploy and use in your swarm.</p>
<pre><code class="language-yaml"><span class="hljs-attr">version:</span> <span class="hljs-string">&#x27;3.7&#x27;</span>

<span class="hljs-attr">services:</span>
  <span class="hljs-attr">blog:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">ghost:4-alpine</span>
    <span class="hljs-attr">depends_on:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">db</span>
    <span class="hljs-attr">ports:</span> 
        <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;2368:2368&quot;</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">database__client:</span> <span class="hljs-string">mysql</span>
      <span class="hljs-attr">database__connection__host:</span> <span class="hljs-string">db</span>
      <span class="hljs-attr">database__connection__user:</span> <span class="hljs-string">ghostusr</span>
      <span class="hljs-attr">database__connection__password:</span> <span class="hljs-string">ghostme</span>
      <span class="hljs-attr">database__connection__database:</span> <span class="hljs-string">ghostdata</span>
    <span class="hljs-attr">deploy:</span>
      <span class="hljs-attr">replicas:</span> <span class="hljs-number">3</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">ghost_network</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;/mnt/content:/var/lib/ghost/content&quot;</span>
  <span class="hljs-attr">db:</span>
    <span class="hljs-attr">image:</span> <span class="hljs-string">mysql:5.7</span>
    <span class="hljs-attr">ports:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;3306:3306&quot;</span>
    <span class="hljs-attr">environment:</span>
      <span class="hljs-attr">MYSQL_ROOT_PASSWORD:</span> <span class="hljs-string">example</span>
      <span class="hljs-attr">MYSQL_USER:</span> <span class="hljs-string">ghostusr</span>
      <span class="hljs-attr">MYSQL_PASSWORD:</span> <span class="hljs-string">ghostme</span>
      <span class="hljs-attr">MYSQL_DATABASE:</span> <span class="hljs-string">ghostdata</span>
    <span class="hljs-attr">deploy:</span>
      <span class="hljs-attr">replicas:</span> <span class="hljs-number">1</span>
      <span class="hljs-attr">placement:</span>
        <span class="hljs-attr">constraints:</span>
          <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;node.role==manager&quot;</span>
    <span class="hljs-attr">networks:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">ghost_network</span>
    <span class="hljs-attr">volumes:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-string">&quot;/mnt/mysql:/var/lib/mysql&quot;</span>
<span class="hljs-attr">networks:</span>
    <span class="hljs-attr">ghost_network:</span>
        <span class="hljs-attr">external:</span> <span class="hljs-literal">true</span>
</code></pre>
<h2>12 Factor apps</h2>
<p>The point of introducing you to cloud computing like this is so you get to see some of the powers and problems of cloud computing. Developers targeting deployment in clustered environments like this have developed a set of guidelines to make the elastic scaling of apps easier to manage. We think you should know about these <a href="https://12factor.net/">12 factors</a> they will influence your design choices and the way you structure your features and solutions in your final workplace project.</p>
<ol>
<li><strong>Codebase</strong> One codebase tracked in revision control, many deploys</li>
<li><strong>Dependencies</strong> Explicitly declare and isolate dependencies</li>
<li><strong>Config</strong> Store config in the environment</li>
<li><strong>Backing services</strong> Treat backing services as attached resources</li>
<li><strong>Build, release, run</strong> Strictly separate build and run stages</li>
<li><strong>Processes</strong> Execute the app as one or more stateless processes</li>
<li><strong>Port binding</strong> Export services via port binding</li>
<li><strong>Concurrency</strong> Scale out via the process model</li>
<li><strong>Disposability</strong> Maximize robustness with fast startup and graceful shutdown</li>
<li><strong>Dev/prod parity</strong> Keep development, staging, and production as similar as possible</li>
<li><strong>Logs</strong> Treat logs as event streams</li>
<li><strong>Admin processes</strong> Run admin/management tasks as one-off processes</li>
</ol>
<h2>Assignment</h2>
<p>What do these 12 factors mean to you? We'd like you to contrast the 12 factors with what you do in your workplace. You can make a video, a blog post or presentation that describes the 12 factors and how your teams follow or don't follow them.</p>

    <nav id="footer-nav"></nav>
    <script src="/curriculum/js/tabbed-code-blocks.js"></script>
    <script>
        function toggleNav() {
            const button = document.getElementById('navigation-toggle')
            const isAriaExp = button.getAttribute('aria-expanded')
            const newAriaExp = (isAriaExp == "false") ? "true" : "false"
            button.setAttribute('aria-expanded', newAriaExp)
            const nav = document.getElementById('navigation')
            nav.style.display = nav.offsetParent ? 'none' : 'block'
        }
        function footerNav() {
            const links = document.getElementsByClassName('nav-link')
            const hrefs = Array.from(links).map(a => a.getAttribute('href'))
            const [current] = window.location.href.match(/[0-9\.]+[a-zA-Z0-9_\\-]+\.html/) || [0]
            const index = hrefs.findIndex(href => {
                const page = href.split(/\\|\//).pop()
                return page === current
            })
            const prevIndex = index - 1
            const nextIndex = index + 1
            if (prevIndex > -1) {
                const prev = document.createElement('a') 
                prev.appendChild(document.createTextNode("‚óÄÔ∏é Prev"))
                prev.title = "Previous session notes"
                prev.href = hrefs[prevIndex]
                document.getElementById('footer-nav').prepend(prev)
            }
            if (nextIndex < hrefs.length) {
                const next = document.createElement('a') 
                next.appendChild(document.createTextNode("Next ‚ñ∫"))
                next.title = "Next session notes"
                next.href = hrefs[nextIndex]
                document.getElementById('footer-nav').append(next)
            }
            window.removeEventListener('DOMContentLoaded', footerNav)
        }
        window.addEventListener('DOMContentLoaded', footerNav)
    </script>
</body>

</html>